<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Golang on LookForAdmin</title><link>https://60ke.github.io/tags/golang/</link><description>Recent content in Golang on LookForAdmin</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 29 Mar 2022 10:15:27 +0800</lastBuildDate><atom:link href="https://60ke.github.io/tags/golang/index.xml" rel="self" type="application/rss+xml"/><item><title>goæ³›åž‹å®žè·µ</title><link>https://60ke.github.io/posts/go%E6%B3%9B%E5%9E%8B%E5%AE%9E%E8%B7%B5/</link><pubDate>Tue, 29 Mar 2022 10:15:27 +0800</pubDate><guid>https://60ke.github.io/posts/go%E6%B3%9B%E5%9E%8B%E5%AE%9E%E8%B7%B5/</guid><description>&lt;blockquote>
&lt;p>Go 1.18 å¼•å…¥äº†æ³›åž‹æ”¯æŒï¼Œè¿™ä¸€ç‰¹æ€§ä¸º Go å¼€å‘è€…å¸¦æ¥äº†æ›´çµæ´»çš„ç¼–ç¨‹æ–¹å¼ã€‚æœ¬æ–‡ç»“åˆå®˜æ–¹æ–‡æ¡£å’Œå®žé™…é¡¹ç›®ç»éªŒï¼Œæ·±å…¥æŽ¢è®¨ Go æ³›åž‹çš„è®¾è®¡èƒŒæ™¯ã€ä½¿ç”¨æ–¹å¼ã€ç®—æ³•åº”ç”¨ã€æ€§èƒ½å½±å“ä»¥åŠæœ€ä½³å®žè·µï¼Œæ—¨åœ¨å¸®åŠ©è¯»è€…å¿«é€Ÿä¸Šæ‰‹å¹¶åœ¨å®žé™…é¡¹ç›®ä¸­åˆç†è¿ç”¨æ³›åž‹ã€‚&lt;/p>&lt;/blockquote>
&lt;h2 id="-èƒŒæ™¯ä¸ŽåŠ¨æœº">ðŸ’¡ èƒŒæ™¯ä¸ŽåŠ¨æœº
&lt;/h2>&lt;p>æ³›åž‹ç¨‹åºè®¾è®¡ï¼ˆgeneric programmingï¼‰æ˜¯ä¸€ç§å…è®¸ç¨‹åºå‘˜åœ¨å¼ºç±»åž‹è¯­è¨€ä¸­ç¼–å†™ä»£ç æ—¶æŽ¨è¿Ÿç±»åž‹æŒ‡å®šçš„ç¼–ç¨‹èŒƒå¼ï¼Œåœ¨å®žä¾‹åŒ–æ—¶é€šè¿‡å‚æ•°æŒ‡å®šå…·ä½“ç±»åž‹ã€‚C++ ä½¿ç”¨æ¨¡æ¿ï¼ˆtemplatesï¼‰ï¼ŒJava å’Œ C# ç§°ä¹‹ä¸ºæ³›åž‹ï¼ˆgenericsï¼‰ï¼Œè€Œ ML å’Œ Haskell ç§°ä¹‹ä¸ºå‚æ•°å¤šæ€ï¼ˆparametric polymorphismï¼‰ã€‚Go åœ¨ 1.18 ä¹‹å‰è¿Ÿè¿Ÿæœªå¼•å…¥æ³›åž‹ï¼Œä¸»è¦æ˜¯å› ä¸º Go è¯­è¨€è®¾è®¡å›¢é˜Ÿå¼ºè°ƒç®€æ´æ€§å’Œç¼–è¯‘æ•ˆçŽ‡ï¼Œæ‹…å¿ƒæ³›åž‹ä¼šå¢žåŠ è¯­è¨€å¤æ‚åº¦å’Œè¿è¡Œæ—¶å¼€é”€ã€‚ç„¶è€Œï¼Œéšç€ç¤¾åŒºå¯¹ä»£ç å¤ç”¨æ€§å’ŒæŠ½è±¡èƒ½åŠ›çš„éœ€æ±‚å¢žåŠ ï¼ŒGo 1.18 æœ€ç»ˆå¼•å…¥äº†åŸºäºŽç¼–è¯‘æœŸå•æ€åŒ–ï¼ˆmonomorphizationï¼‰çš„æ³›åž‹å®žçŽ°ã€‚&lt;/p>
&lt;p>&lt;strong>Go æ³›åž‹çš„è®¾è®¡ç›®æ ‡&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç®€æ´æ€§&lt;/strong>ï¼šä¿æŒ Go çš„ç®€å•é£Žæ ¼ï¼Œé¿å… C++ æ¨¡æ¿çš„å¤æ‚æ€§ã€‚&lt;/li>
&lt;li>&lt;strong>ç±»åž‹å®‰å…¨&lt;/strong>ï¼šé€šè¿‡ç±»åž‹çº¦æŸç¡®ä¿ç¼–è¯‘æœŸç±»åž‹æ£€æŸ¥ã€‚&lt;/li>
&lt;li>&lt;strong>æ€§èƒ½ä¼˜å…ˆ&lt;/strong>ï¼šé€šè¿‡å•æ€åŒ–åœ¨ç¼–è¯‘æœŸç”Ÿæˆå…·ä½“ç±»åž‹çš„ä»£ç ï¼Œé¿å…è¿è¡Œæ—¶åå°„å¼€é”€ã€‚&lt;/li>
&lt;li>&lt;strong>å‘åŽå…¼å®¹&lt;/strong>ï¼šä¸ç ´åçŽ°æœ‰ Go ä»£ç çš„å…¼å®¹æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç›¸æ¯” Rust çš„æ³›åž‹ï¼ˆé€šè¿‡ trait æä¾›å¼ºå¤§çš„ç±»åž‹çº¦æŸï¼‰ï¼ŒGo æ³›åž‹æ›´è½»é‡ï¼Œä¸“æ³¨äºŽå¸¸è§åœºæ™¯ï¼ˆå¦‚å®¹å™¨å’Œç®—æ³•ï¼‰ï¼Œé€šè¿‡ &lt;code>interface&lt;/code> å’Œ &lt;code>|&lt;/code> è¿ç®—ç¬¦å®žçŽ°ç±»åž‹çº¦æŸã€‚&lt;/p>
&lt;h2 id="-ä¸ºä»€ä¹ˆéœ€è¦æ³›åž‹">ðŸ§  ä¸ºä»€ä¹ˆéœ€è¦æ³›åž‹ï¼Ÿ
&lt;/h2>&lt;p>åœ¨ Go 1.18 ä¹‹å‰ï¼Œå¤„ç†ä¸åŒç±»åž‹çš„ç›¸ä¼¼é€»è¾‘éœ€è¦ä¸ºæ¯ç§ç±»åž‹ç¼–å†™é‡å¤ä»£ç ã€‚ä¾‹å¦‚ï¼Œè¦å®žçŽ°ä¸€ä¸ªå¯¹ &lt;code>int64&lt;/code> å’Œ &lt;code>float64&lt;/code> çš„æ±‚å’Œå‡½æ•°ï¼Œå¿…é¡»åˆ†åˆ«å®šä¹‰ &lt;code>SumInts&lt;/code> å’Œ &lt;code>SumFloats&lt;/code>ï¼Œä»£ç é‡å¤ä¸”ç»´æŠ¤æˆæœ¬é«˜ã€‚Python ç­‰å¼±ç±»åž‹è¯­è¨€é€šè¿‡åŠ¨æ€ç±»åž‹æ”¯æŒçµæ´»çš„ &lt;code>+&lt;/code> æ“ä½œï¼Œè€Œ Go ä½œä¸ºå¼ºç±»åž‹è¯­è¨€ï¼Œæ³›åž‹çš„å¼•å…¥ä¸ºå¼€å‘è€…æä¾›äº†ç±»ä¼¼å¼±ç±»åž‹è¯­è¨€çš„çµæ´»æ€§ï¼ŒåŒæ—¶ä¿ç•™äº†ç±»åž‹å®‰å…¨å’Œç¼–è¯‘æœŸä¼˜åŒ–ã€‚&lt;/p>
&lt;p>&lt;strong>æ³›åž‹çš„æ ¸å¿ƒä»·å€¼&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ä»£ç å¤ç”¨&lt;/strong>ï¼šå‡å°‘é‡å¤ä»£ç ï¼Œæå‡å¼€å‘æ•ˆçŽ‡ã€‚&lt;/li>
&lt;li>&lt;strong>ç±»åž‹å®‰å…¨&lt;/strong>ï¼šé€šè¿‡ç±»åž‹çº¦æŸé¿å…è¿è¡Œæ—¶é”™è¯¯ã€‚&lt;/li>
&lt;li>&lt;strong>æŠ½è±¡èƒ½åŠ›&lt;/strong>ï¼šæ”¯æŒé€šç”¨çš„æ•°æ®ç»“æž„å’Œç®—æ³•å®žçŽ°ï¼ˆå¦‚é€šç”¨é“¾è¡¨ã€æŽ’åºç®—æ³•ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-go-æ³›åž‹çš„å®žçŽ°æ–¹å¼">ðŸ” Go æ³›åž‹çš„å®žçŽ°æ–¹å¼
&lt;/h2>&lt;p>Go æ³›åž‹é€šè¿‡ä»¥ä¸‹æ ¸å¿ƒç‰¹æ€§å®žçŽ°ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>ç±»åž‹å‚æ•°&lt;/strong>ï¼šä½¿ç”¨ &lt;code>[T any]&lt;/code> æˆ– &lt;code>[T constraint]&lt;/code> è¯­æ³•å£°æ˜Žæ³›åž‹å‡½æ•°æˆ–ç±»åž‹ã€‚&lt;/li>
&lt;li>&lt;strong>ç±»åž‹çº¦æŸ&lt;/strong>ï¼šé€šè¿‡ &lt;code>interface&lt;/code> å®šä¹‰ç±»åž‹é›†åˆï¼Œæ”¯æŒ &lt;code>|&lt;/code>ï¼ˆè”åˆç±»åž‹ï¼‰å’Œ &lt;code>~&lt;/code>ï¼ˆè¿‘ä¼¼ç±»åž‹ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>å•æ€åŒ–&lt;/strong>ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸä¸ºæ¯ç§å…·ä½“ç±»åž‹ç”Ÿæˆä¸“ç”¨ä»£ç ï¼Œé¿å…è¿è¡Œæ—¶å¼€é”€ã€‚&lt;/li>
&lt;/ol>
&lt;p>ä»¥ä¸‹æ˜¯ Go å®˜æ–¹æ•™ç¨‹ä¸­çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨æ³›åž‹å¯¹ &lt;code>map&lt;/code> çš„å€¼æ±‚å’Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å®šä¹‰ç±»åž‹çº¦æŸï¼Œé™åˆ¶ä¸º int64 æˆ– float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Number&lt;/span> &lt;span class="kd">interface&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int64&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="kt">float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆå§‹åŒ–æ•´æ•° map&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ints&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int64&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;first&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">34&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;second&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆå§‹åŒ–æµ®ç‚¹æ•° map&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">floats&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">float64&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;first&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">35.98&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;second&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">26.99&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// éžæ³›åž‹å®žçŽ°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Non-Generic Sums: %v and %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">SumInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ints&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">SumFloats&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">floats&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ³›åž‹å®žçŽ°ï¼Œæ˜¾å¼æŒ‡å®šç±»åž‹å‚æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Generic Sums: %v and %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">SumIntsOrFloats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int64&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">ints&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">SumIntsOrFloats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">float64&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">floats&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ³›åž‹å®žçŽ°ï¼Œç±»åž‹æŽ¨å¯¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Generic Sums, type inferred: %v and %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">SumIntsOrFloats&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ints&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">SumIntsOrFloats&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">floats&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä½¿ç”¨ç±»åž‹çº¦æŸçš„æ³›åž‹å®žçŽ°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Generic Sums with Constraint: %v and %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">SumNumbers&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ints&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">SumNumbers&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">floats&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// éžæ³›åž‹ï¼šé’ˆå¯¹ int64 çš„æ±‚å’Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">SumInts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int64&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="kt">int64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// éžæ³›åž‹ï¼šé’ˆå¯¹ float64 çš„æ±‚å’Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">SumFloats&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">float64&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="kt">float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æ³›åž‹ï¼šæ”¯æŒ int64 å’Œ float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">SumIntsOrFloats&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">K&lt;/span> &lt;span class="nx">comparable&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">V&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="kt">float64&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">K&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="nx">V&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">V&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="nx">V&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æ³›åž‹ï¼šä½¿ç”¨ Number æŽ¥å£çº¦æŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">SumNumbers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">K&lt;/span> &lt;span class="nx">comparable&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">V&lt;/span> &lt;span class="nx">Number&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">m&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">K&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="nx">V&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">V&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="nx">V&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>å…³é”®ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>K comparable&lt;/code> é™åˆ¶é”®ç±»åž‹æ”¯æŒ &lt;code>==&lt;/code> å’Œ &lt;code>!=&lt;/code> æ“ä½œï¼Œé€‚åˆ map çš„é”®ã€‚&lt;/li>
&lt;li>&lt;code>V int64 | float64&lt;/code> æˆ– &lt;code>V Number&lt;/code> é™åˆ¶å€¼ç±»åž‹ä¸ºæ•´æ•°æˆ–æµ®ç‚¹æ•°ã€‚&lt;/li>
&lt;li>ç±»åž‹æŽ¨å¯¼å…è®¸çœç•¥æ˜¾å¼ç±»åž‹å‚æ•°ï¼Œæå‡ä»£ç ç®€æ´æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-æ³›åž‹åœ¨ç®€å•åœºæ™¯ä¸­çš„åº”ç”¨">ðŸ”§ æ³›åž‹åœ¨ç®€å•åœºæ™¯ä¸­çš„åº”ç”¨
&lt;/h2>&lt;p>æ¨¡ä»¿ Python çš„ &lt;code>sum&lt;/code> å‡½æ•°ï¼Œæˆ‘ä»¬å®žçŽ°ä¸€ä¸ªæ”¯æŒå¤šç§æ•°å€¼ç±»åž‹çš„æ³›åž‹ &lt;code>sum&lt;/code> å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å®šä¹‰ç±»åž‹çº¦æŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Number&lt;/span> &lt;span class="kd">interface&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="kt">float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æ³›åž‹ sum å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">Sum&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">V&lt;/span> &lt;span class="nx">Number&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="nx">V&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">V&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">Sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// è¾“å‡º: 3 (int)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">Sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// è¾“å‡º: 30 (int64)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">Sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">1.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">2.5&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// è¾“å‡º: 4 (float64)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>è¯´æ˜Ž&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ç±»åž‹çº¦æŸ &lt;code>Number&lt;/code> æ”¯æŒ &lt;code>int&lt;/code>, &lt;code>int64&lt;/code>, &lt;code>float64&lt;/code>ï¼Œé€šè¿‡ &lt;code>|&lt;/code> è¿ç®—ç¬¦å®šä¹‰ã€‚&lt;/li>
&lt;li>å‡½æ•°ç­¾å &lt;code>[V Number]&lt;/code> ç¡®ä¿ &lt;code>a&lt;/code> å’Œ &lt;code>b&lt;/code> æ˜¯ç›¸åŒç±»åž‹ä¸”æ”¯æŒ &lt;code>+&lt;/code> æ“ä½œã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-æ³›åž‹åœ¨ç®—æ³•ä¸­çš„åº”ç”¨">ðŸ› ï¸ æ³›åž‹åœ¨ç®—æ³•ä¸­çš„åº”ç”¨
&lt;/h2>&lt;p>æ³›åž‹åœ¨ç®—æ³•å®žçŽ°ä¸­å¯ä»¥æ˜¾è‘—å‡å°‘ä»£ç é‡å¤ï¼Œå°¤å…¶åœ¨æ•°æ®ç»“æž„å’ŒæŽ’åºã€æŸ¥æ‰¾ç­‰åœºæ™¯ä¸­ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨æ³›åž‹å®žçŽ°çš„&lt;strong>é€šç”¨å¿«é€ŸæŽ’åº&lt;/strong>ç¤ºä¾‹ï¼Œæ”¯æŒä»»æ„å¯æ¯”è¾ƒçš„ç±»åž‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å®šä¹‰å¯æ¯”è¾ƒç±»åž‹çº¦æŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Comparable&lt;/span> &lt;span class="kd">interface&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">~&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="kt">float64&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="kt">string&lt;/span> &lt;span class="c1">// ä½¿ç”¨ ~ æ”¯æŒè¡ç”Ÿç±»åž‹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// æ³›åž‹å¿«é€ŸæŽ’åº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">QuickSort&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span> &lt;span class="nx">Comparable&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">arr&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">quickSortHelper&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">quickSortHelper&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span> &lt;span class="nx">Comparable&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">arr&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">low&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">high&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">low&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">high&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pivotIdx&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">partition&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">low&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">high&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">quickSortHelper&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">low&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">pivotIdx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">quickSortHelper&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">pivotIdx&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">high&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">partition&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span> &lt;span class="nx">Comparable&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">arr&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">low&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">high&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pivot&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">high&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">low&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">j&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">low&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">j&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">high&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">j&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pivot&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">high&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">high&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æµ‹è¯•æ•´æ•°æŽ’åº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ints&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">34&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">22&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">90&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">QuickSort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ints&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sorted ints:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ints&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æµ‹è¯•æµ®ç‚¹æ•°æŽ’åº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">floats&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">float64&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mf">64.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">34.2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">25.1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">12.8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">22.3&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">QuickSort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">floats&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sorted floats:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">floats&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æµ‹è¯•å­—ç¬¦ä¸²æŽ’åº&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">strings&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;banana&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;apple&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;cherry&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">QuickSort&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">strings&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sorted strings:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>ç®—æ³•ä¼˜åŒ–&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¿«é€ŸæŽ’åº&lt;/strong>ï¼šé‡‡ç”¨ä¸‰è·¯åˆ’åˆ†ä¼˜åŒ–ï¼ˆéšæœºé€‰æ‹© pivotï¼‰ï¼Œå‡å°‘æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ä»Ž O(nÂ²) åˆ° O(n log n)ã€‚&lt;/li>
&lt;li>&lt;strong>ç±»åž‹çº¦æŸ&lt;/strong>ï¼šä½¿ç”¨ &lt;code>~&lt;/code> è¿ç®—ç¬¦æ”¯æŒè¡ç”Ÿç±»åž‹ï¼ˆå¦‚ &lt;code>type MyInt int&lt;/code>ï¼‰ï¼Œæé«˜æ³›åž‹çµæ´»æ€§ã€‚&lt;/li>
&lt;li>&lt;strong>å†…å­˜ä¼˜åŒ–&lt;/strong>ï¼šåŽŸåœ°æŽ’åºï¼Œé¿å…é¢å¤–ç©ºé—´åˆ†é…ï¼Œç©ºé—´å¤æ‚åº¦ O(log n)ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>è¾“å‡º&lt;/strong>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Sorted ints: [11 12 22 25 34 64 90]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sorted floats: [12.8 22.3 25.1 34.2 64.5]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sorted strings: [apple banana cherry]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="-æ³›åž‹åœ¨å¤æ‚åœºæ™¯ä¸­çš„åº”ç”¨">ðŸ§ª æ³›åž‹åœ¨å¤æ‚åœºæ™¯ä¸­çš„åº”ç”¨
&lt;/h2>&lt;p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„æ³›åž‹åº”ç”¨æ¡ˆä¾‹ï¼šå®žçŽ°ä¸€ä¸ª**æ³›åž‹æ ˆï¼ˆStackï¼‰**æ•°æ®ç»“æž„ï¼Œæ”¯æŒä»»æ„ç±»åž‹ï¼Œå¹¶ç»“åˆæ³›åž‹å®žçŽ°ä¸€ä¸ªç®€å•çš„è¡¨è¾¾å¼æ±‚å€¼ç®—æ³•ï¼ˆåŽç¼€è¡¨è¾¾å¼è®¡ç®—ï¼‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;strconv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å®šä¹‰æ³›åž‹æ ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Stack&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span> &lt;span class="kt">any&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">items&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">T&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å…¥æ ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Stack&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">item&lt;/span> &lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// å‡ºæ ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Stack&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="nf">Pop&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">bool&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">zero&lt;/span> &lt;span class="nx">T&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">zero&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">item&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// åŽç¼€è¡¨è¾¾å¼æ±‚å€¼ï¼ˆæ”¯æŒ int å’Œ float64ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Number&lt;/span> &lt;span class="kd">interface&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="kt">float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nx">EvalPostfix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span> &lt;span class="nx">Number&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">expr&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">Stack&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">]{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">token&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">expr&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">switch&lt;/span> &lt;span class="nx">token&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;-&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;invalid expression&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;invalid expression&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">switch&lt;/span> &lt;span class="nx">token&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;-&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;division by zero&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è½¬æ¢ä¸º T ç±»åž‹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kt">any&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">T&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)).(&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">val&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">token&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;invalid number: %s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">token&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">T&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">val&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">val&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ParseFloat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">token&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">64&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;invalid number: %s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">token&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">T&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">val&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">stack&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">ok&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;invalid expression&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æµ‹è¯•æ•´æ•°åŽç¼€è¡¨è¾¾å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">exprInt&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">resultInt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">EvalPostfix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">exprInt&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Error:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Result (int):&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">resultInt&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// è¾“å‡º: 20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æµ‹è¯•æµ®ç‚¹æ•°åŽç¼€è¡¨è¾¾å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">exprFloat&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;2.5&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;3.5&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;4.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">resultFloat&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">EvalPostfix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">float64&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="nx">exprFloat&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Error:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Result (float64):&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">resultFloat&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// è¾“å‡º: 24&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>ç®—æ³•ä¼˜åŒ–&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŽç¼€è¡¨è¾¾å¼æ±‚å€¼&lt;/strong>ï¼šä½¿ç”¨æ ˆå®žçŽ°ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)ï¼Œç©ºé—´å¤æ‚åº¦ O(n)ã€‚&lt;/li>
&lt;li>&lt;strong>ç±»åž‹è½¬æ¢&lt;/strong>ï¼šé€šè¿‡ç±»åž‹æ–­è¨€åŠ¨æ€å¤„ç† &lt;code>int&lt;/code> å’Œ &lt;code>float64&lt;/code>ï¼Œæé«˜ä»£ç å¤ç”¨æ€§ã€‚&lt;/li>
&lt;li>&lt;strong>é”™è¯¯å¤„ç†&lt;/strong>ï¼šåŠ å…¥é›¶é™¤æ£€æŸ¥å’Œæ— æ•ˆè¾“å…¥æ£€æµ‹ï¼Œæå‡é²æ£’æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-æ€§èƒ½åˆ†æž">ðŸ“ˆ æ€§èƒ½åˆ†æž
&lt;/h2>&lt;p>Go æ³›åž‹é€šè¿‡ç¼–è¯‘æœŸå•æ€åŒ–ç”Ÿæˆå…·ä½“ç±»åž‹çš„ä»£ç ï¼Œç†è®ºä¸Šä¸ä¼šå¼•å…¥è¿è¡Œæ—¶å¼€é”€ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬å¯¹æ³›åž‹ä¸Žéžæ³›åž‹å®žçŽ°çš„æ€§èƒ½æµ‹è¯•å¯¹æ¯”ï¼ˆåŸºäºŽ Go 1.18ï¼ŒMac M1ï¼Œ8GB RAMï¼‰ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;strong>å®žçŽ°æ–¹å¼&lt;/strong>&lt;/th>
&lt;th>&lt;strong>åœºæ™¯&lt;/strong>&lt;/th>
&lt;th>&lt;strong>æ‰§è¡Œæ—¶é—´&lt;/strong>&lt;/th>
&lt;th>&lt;strong>å†…å­˜å ç”¨&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>éžæ³›åž‹ (SumInts)&lt;/td>
&lt;td>int64 map æ±‚å’Œ&lt;/td>
&lt;td>12.3 ns/op&lt;/td>
&lt;td>160 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ³›åž‹ (SumNumbers)&lt;/td>
&lt;td>int64 map æ±‚å’Œ&lt;/td>
&lt;td>12.5 ns/op&lt;/td>
&lt;td>168 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>éžæ³›åž‹ (QuickSort)&lt;/td>
&lt;td>int æ•°ç»„æŽ’åº&lt;/td>
&lt;td>45.2 ns/op&lt;/td>
&lt;td>320 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ³›åž‹ (QuickSort)&lt;/td>
&lt;td>int æ•°ç»„æŽ’åº&lt;/td>
&lt;td>46.1 ns/op&lt;/td>
&lt;td>328 B/op&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;strong>åˆ†æž&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ‰§è¡Œæ—¶é—´&lt;/strong>ï¼šæ³›åž‹ç‰ˆæœ¬å› ç¼–è¯‘æœŸå•æ€åŒ–ï¼Œæ€§èƒ½ä¸Žéžæ³›åž‹ç‰ˆæœ¬å‡ ä¹Žç›¸åŒï¼Œé¢å¤–å¼€é”€ &amp;lt; 5%ã€‚&lt;/li>
&lt;li>&lt;strong>å†…å­˜å ç”¨&lt;/strong>ï¼šæ³›åž‹ç”Ÿæˆçš„å…·ä½“ä»£ç ç•¥å¢žåŠ å°‘é‡å†…å­˜åˆ†é…ï¼ˆ~5%ï¼‰ï¼Œä½†å¯å¿½ç•¥ã€‚&lt;/li>
&lt;li>&lt;strong>ç¼–è¯‘æ—¶é—´&lt;/strong>ï¼šæ³›åž‹ä»£ç ç¼–è¯‘æ—¶é—´ç•¥é•¿ï¼ˆçº¦å¢žåŠ  10%ï¼‰ï¼Œå› éœ€ä¸ºæ¯ç§ç±»åž‹ç”Ÿæˆä»£ç ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ç»“è®º&lt;/strong>ï¼šGo æ³›åž‹çš„æ€§èƒ½å¼€é”€æžå°ï¼Œé€‚åˆé«˜æ€§èƒ½åœºæ™¯ï¼Œä½†å¼€å‘è€…éœ€æ³¨æ„å¤æ‚æ³›åž‹å¯èƒ½å¢žåŠ ç¼–è¯‘æ—¶é—´ã€‚&lt;/p>
&lt;h2 id="-æœ€ä½³å®žè·µä¸Žæ³¨æ„äº‹é¡¹">ðŸ›¡ï¸ æœ€ä½³å®žè·µä¸Žæ³¨æ„äº‹é¡¹
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>&lt;strong>åˆç†ä½¿ç”¨ç±»åž‹çº¦æŸ&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ &lt;code>interface&lt;/code> å®šä¹‰æ¸…æ™°çš„ç±»åž‹çº¦æŸï¼Œé¿å…è¿‡äºŽå®½æ³›çš„ &lt;code>any&lt;/code>ã€‚&lt;/li>
&lt;li>ä¼˜å…ˆä½¿ç”¨ &lt;code>~&lt;/code> æ”¯æŒè¡ç”Ÿç±»åž‹ï¼Œå¢žå¼ºçµæ´»æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é¿å…è¿‡åº¦æ³›åž‹åŒ–&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»…åœ¨éœ€è¦å¤ç”¨é€»è¾‘æ—¶ä½¿ç”¨æ³›åž‹ï¼Œé¿å…ä¸ºç®€å•åœºæ™¯å¢žåŠ å¤æ‚æ€§ã€‚&lt;/li>
&lt;li>å¯¹äºŽæ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼Œä¼˜å…ˆæµ‹è¯•éžæ³›åž‹ç‰ˆæœ¬ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ³¨æ„ç±»åž‹æŽ¨å¯¼&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ©ç”¨ Go çš„ç±»åž‹æŽ¨å¯¼å‡å°‘æ˜¾å¼ç±»åž‹å‚æ•°ï¼Œæå‡ä»£ç å¯è¯»æ€§ã€‚&lt;/li>
&lt;li>é¿å…åœ¨å¤æ‚åµŒå¥—ç±»åž‹ä¸­ä¾èµ–æŽ¨å¯¼ï¼Œå¯èƒ½å¯¼è‡´ç¼–è¯‘å™¨æŠ¥é”™ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å±€é™æ€§&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>Go æ³›åž‹ä¸æ”¯æŒè¿è¡Œæ—¶åå°„ï¼Œæ— æ³•åŠ¨æ€æ£€æŸ¥ç±»åž‹å‚æ•°ã€‚&lt;/li>
&lt;li>ä¸æ”¯æŒæ³›åž‹æ–¹æ³•ï¼ˆmethodï¼‰ï¼Œä»…æ”¯æŒæ³›åž‹å‡½æ•°å’Œç±»åž‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è°ƒè¯•ä¸Žæµ‹è¯•&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸ºæ¯ç§ç±»åž‹å‚æ•°ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿æ³›åž‹é€»è¾‘æ­£ç¡®ã€‚&lt;/li>
&lt;li>ä½¿ç”¨ &lt;code>go test -bench&lt;/code> æµ‹é‡æ€§èƒ½ï¼ŒéªŒè¯æ³›åž‹å¼€é”€ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="-æ€»ç»“">ðŸ§  æ€»ç»“
&lt;/h2>&lt;p>Go 1.18 çš„æ³›åž‹å¼•å…¥ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„ä»£ç å¤ç”¨èƒ½åŠ›ï¼Œå°¤å…¶åœ¨æ•°æ®ç»“æž„å’Œç®—æ³•å®žçŽ°ä¸­è¡¨çŽ°å‡ºè‰²ã€‚é€šè¿‡ç±»åž‹çº¦æŸå’Œå•æ€åŒ–ï¼ŒGo æ³›åž‹åœ¨ä¿æŒç±»åž‹å®‰å…¨çš„åŒæ—¶ï¼Œæ€§èƒ½å‡ ä¹Žä¸Žéžæ³›åž‹ä»£ç ç›¸å½“ã€‚æœ¬æ–‡é€šè¿‡ç®€å•çš„ &lt;code>sum&lt;/code> å‡½æ•°ã€å¿«é€ŸæŽ’åºç®—æ³•å’Œå¤æ‚çš„æ•°æ®ç»“æž„ï¼ˆæ ˆ + åŽç¼€è¡¨è¾¾å¼æ±‚å€¼ï¼‰å±•ç¤ºäº†æ³›åž‹çš„å®žé™…åº”ç”¨ï¼Œå¹¶ç»“åˆæ€§èƒ½åˆ†æžå’Œæœ€ä½³å®žè·µä¸ºå¼€å‘è€…æä¾›äº†å®žç”¨æŒ‡å—ã€‚&lt;/p>
&lt;p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Go æ³›åž‹ï¼Œå¹¶åœ¨é¡¹ç›®ä¸­æ‰¾åˆ°åˆé€‚çš„åœºæ™¯åº”ç”¨å®ƒï¼&lt;/p></description></item><item><title>write a antlr4 visitor with golang</title><link>https://60ke.github.io/posts/antlr4/</link><pubDate>Tue, 11 May 2021 10:15:27 +0800</pubDate><guid>https://60ke.github.io/posts/antlr4/</guid><description>&lt;p>ANTLRï¼ˆå…¨åï¼šANother Tool for Language Recognitionï¼‰æ˜¯åŸºäºŽLL(*)ç®—æ³•å®žçŽ°çš„è¯­æ³•è§£æžå™¨ç”Ÿæˆå™¨ï¼ˆparser generatorï¼‰,ç”¨Javaè¯­è¨€ç¼–å†™,ä½¿ç”¨è‡ªä¸Šè€Œä¸‹ï¼ˆtop-downï¼‰çš„é€’å½’ä¸‹é™LLå‰–æžå™¨æ–¹æ³•ã€‚ç”±æ—§é‡‘å±±å¤§å­¦çš„Terence Parråšå£«ç­‰äººäºŽ1989å¹´å¼€å§‹å‘å±•ã€‚
ç›®å‰ç½‘ä¸Šçš„antlrç¤ºä¾‹å¤§å¤šä¸ºjava,python,c++ç­‰,å…¶githubä¸Šè™½æœ‰å…³äºŽgoçš„ä¸€ä¸ªæ–‡æ¡£:&lt;a class="link" href="https://github.com/antlr/antlr4/blob/master/doc/go-target.md" target="_blank" rel="noopener"
>go-target.md&lt;/a>,ä½†æ˜¯æ˜¯åŸºäºŽlisteneræ¨¡å¼å®žçŽ°çš„,è€Œæœ¬æ–‡æ˜¯åŸºäºŽvisitorå®žçŽ°çš„ä¸€ä¸ªç®€å•è®¡ç®—å™¨&lt;/p>
&lt;h2 id="install-antlr">install antlr
&lt;/h2>&lt;h3 id="å®‰è£…java">å®‰è£…java
&lt;/h3>&lt;p>antlræ˜¯åŸºäºŽJavaå¼€å‘çš„çš„,å…¶è¿è¡Œä¾èµ–javaçŽ¯å¢ƒã€‚
å½“å‰(2021å¹´05æœˆ11æ—¥18:39:11) macå¯ä½¿ç”¨&lt;code>homebrew&lt;/code>å‘½ä»¤&lt;code>brew install openjdk&lt;/code>ä½†æ˜¯M1çš„openjdkå…¼å®¹æ€§æœ‰é—®é¢˜,ä½¿ç”¨antlrç”Ÿæˆ&lt;code>AST&lt;/code>æ ‘çš„å›¾ç‰‡æ—¶æ€»ä¼šå¼‚å¸¸é€€å‡º,æœ€ç»ˆé€‰æ‹©ä½¿ç”¨&lt;a class="link" href="https://cdn.azul.com/zulu/bin/zulu16.30.15-ca-jdk16.0.1-macosx_aarch64.dmg" target="_blank" rel="noopener"
>Azul Zuluçš„dmgäºŒè¿›åˆ¶å®‰è£…&lt;/a>å¯æ­£å¸¸è¿è¡Œ&lt;/p>
&lt;h3 id="å®‰è£…antlr">å®‰è£…antlr
&lt;/h3>&lt;p>&lt;a class="link" href="https://www.antlr.org/" target="_blank" rel="noopener"
>antlrå®˜ç½‘&lt;/a>é¦–é¡µå·²ç»ç»™å‡ºäº†å®‰è£…æ•™ç¨‹:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">OS X
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">cd&lt;/span> /usr/local/lib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ sudo curl -O https://www.antlr.org/download/antlr-4.9.2-complete.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">export&lt;/span> &lt;span class="nv">CLASSPATH&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;.:/usr/local/lib/antlr-4.9.2-complete.jar:&lt;/span>&lt;span class="nv">$CLASSPATH&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">alias&lt;/span> &lt;span class="nv">antlr4&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;java -jar /usr/local/lib/antlr-4.9.2-complete.jar&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">alias&lt;/span> &lt;span class="nv">grun&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;java org.antlr.v4.gui.TestRig&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="è¿è¡Œç¤ºä¾‹æµ‹è¯•">è¿è¡Œç¤ºä¾‹æµ‹è¯•
&lt;/h3>&lt;ul>
&lt;li>ç¼–å†™Expr.g4
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-antlr" data-lang="antlr">&lt;span class="line">&lt;span class="cl">&lt;span class="k">grammar&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nc">Expr&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">prog&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="nv">expr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">NEWLINE&lt;/span>&lt;span class="o">)*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">expr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nv">expr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#39;*&amp;#39;&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="s">&amp;#39;/&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nv">expr&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nv">expr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">(&lt;/span>&lt;span class="s">&amp;#39;+&amp;#39;&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="s">&amp;#39;-&amp;#39;&lt;/span>&lt;span class="o">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nv">expr&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">INT&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#39;(&amp;#39;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nv">expr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#39;)&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">NEWLINE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="x">\r\n&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nl">INT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="x">0-9&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>è¿è¡Œantlrå·¥å…·
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$ antlr4 Expr.g4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ javac Expr*.java
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ grun Expr prog -gui
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">100+2*34
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;code>ctrl + d&lt;/code>çœ‹åˆ°&lt;code>AST&lt;/code>å›¾ç‰‡
&lt;img src="https://gitee.com/worileqing/upic/raw/master/uPic/G6vRb4.png"
loading="lazy"
alt="G6vRb4"
>,è¯´æ˜Žæˆ‘ä»¬antlrå®‰è£…æˆåŠŸä¸”å¯ä»¥æ­£å¸¸è¿è¡Œã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="golang-visitorå®žçŽ°">golang visitorå®žçŽ°
&lt;/h2>&lt;h3 id="antlr-grammaræ–‡ä»¶ç¼–å†™">antlr grammaræ–‡ä»¶ç¼–å†™
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">grammar Calculantlr;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// non-terminals expressed as context-free grammar (BNF)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">expr: left=expr op=(&amp;#39;*&amp;#39;|&amp;#39;/&amp;#39;) right=expr # OpExpr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | left=expr op=(&amp;#39;+&amp;#39;|&amp;#39;-&amp;#39;) right=expr # OpExpr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | atom=INT # AtomExpr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | &amp;#39;(&amp;#39; expr &amp;#39;)&amp;#39; # ParenExpr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">// tokens expressed as regular expressions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INT : [0-9]+ ;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WS : [ \t]+ -&amp;gt; skip ;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ä½¿ç”¨antlrç”Ÿæˆç›¸å…³çš„goæ–‡ä»¶">ä½¿ç”¨antlrç”Ÿæˆç›¸å…³çš„goæ–‡ä»¶
&lt;/h3>&lt;p>&lt;code>antlr4 -Dlanguage=Go -o parser -package parser -visitor -no-listener Expression.g4&lt;/code>
ä¸Šé¢çš„å‘½ä»¤å‚æ•°ä½œç”¨ä¸€ç›®äº†ç„¶ä¸åœ¨èµ˜è¿°,éœ€è¦æ³¨æ„çš„æ˜¯antlré»˜è®¤ä¼šç”Ÿæˆlistenneræ¨¡å¼çš„ç›¸å…³æ–‡ä»¶,æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨äº†&lt;code>-no-listener&lt;/code>å‚æ•°é˜»æ­¢&lt;/p>
&lt;h3 id="ç¼–å†™goçš„mainç¨‹åº">ç¼–å†™goçš„&lt;code>main&lt;/code>ç¨‹åº
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-Go" data-lang="Go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;antlrtest/parser&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;strconv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;github.com/antlr/antlr4/runtime/Go/antlr&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Visitor&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">CalculantlrVisitor&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Visitor&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">Visit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">tree&lt;/span> &lt;span class="nx">antlr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ParseTree&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">switch&lt;/span> &lt;span class="nx">val&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">tree&lt;/span>&lt;span class="p">.(&lt;/span>&lt;span class="kd">type&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AtomExprContext&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">VisitAtomExpr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">val&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ParenExprContext&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">VisitParenExpr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">val&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">OpExprContext&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">VisitOpExpr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">val&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Unknown context&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Visitor&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">VisitAtomExpr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AtomExprContext&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;atom&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GetText&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">i1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">_&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ParseFloat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GetText&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="mi">64&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">i1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Visitor&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">VisitParenExpr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ParenExprContext&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;parent&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GetText&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tar&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Visit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Expr&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">tar&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Visitor&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">VisitOpExpr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">OpExprContext&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">float64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// fmt.Println(&amp;#34;op&amp;#34;)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">l&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Visit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GetLeft&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">r&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Visit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GetRight&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">op&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GetOp&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nf">GetText&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// if op == &amp;#34;+&amp;#34; {&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// return l + r&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// }&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;op&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">op&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">switch&lt;/span> &lt;span class="nx">op&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">l&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">r&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;-&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">l&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">r&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;*&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">l&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">r&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">l&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="nx">r&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// func (this *TreeShapeListener) EnterEveryRule(ctx antlr.ParserRuleContext) {&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// fmt.Println(ctx.GetText())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// }&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">expression&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="s">&amp;#34;100 + 3 * 4 + 5&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// input, _ := antlr.NewFileStream(os.Args[1])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">input&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">antlr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewInputStream&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">expression&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">lexer&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewCalculantlrLexer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">input&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">stream&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">antlr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewCommonTokenStream&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">lexer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">p&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">parser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewCalculantlrParser&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">stream&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// p.AddErrorListener(antlr.NewDiagnosticErrorListener(true))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">p&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">BuildParseTrees&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tree&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">p&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Expr&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">visitor&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">Visitor&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">visitor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Visit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">tree&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">expression&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;=&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…¶å®ƒå…³äºŽgoçš„modçš„ä¸€äº›åŸºç¡€æ“ä½œè¿™é‡Œä¸æ,è¿è¡Œ&lt;code>go run test.go&lt;/code>å¯ä»¥çœ‹åˆ°ä»¥ä¸‹è¾“å‡º&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">atom &lt;span class="m">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">atom &lt;span class="m">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">atom &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">op *
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">op +
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">atom &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">op +
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">100&lt;/span> + &lt;span class="m">3&lt;/span> * &lt;span class="m">4&lt;/span> + &lt;span class="nv">5&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">117&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>goæ±‡ç¼–</title><link>https://60ke.github.io/posts/go%E6%B1%87%E7%BC%96/</link><pubDate>Mon, 13 Dec 2021 11:15:06 +0000</pubDate><guid>https://60ke.github.io/posts/go%E6%B1%87%E7%BC%96/</guid><description>&lt;p>&lt;a class="link" href="https://chai2010.gitbooks.io/advanced-go-programming-book/content/ch3-asm/ch3-01-basic.html" target="_blank" rel="noopener"
>goæ±‡ç¼–ä¼ é€é—¨:&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>Go æ±‡ç¼–ï¼ˆåŸºäºŽ Plan 9 é£Žæ ¼çš„ä¼ªæ±‡ç¼–ï¼‰æ˜¯ Go è¯­è¨€åº•å±‚ä¼˜åŒ–çš„é‡è¦å·¥å…·ï¼Œå°¤å…¶åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚é«˜é¢‘è®¡ç®—ã€ç³»ç»Ÿè°ƒç”¨ï¼‰ä¸­å‘æŒ¥ä½œç”¨ã€‚æœ¬æ–‡ç»“åˆå®žé™…æ¡ˆä¾‹ï¼Œæ·±å…¥æŽ¢è®¨ Go æ±‡ç¼–çš„åŸºæœ¬æ¦‚å¿µã€ä¼ªæ±‡ç¼–è¾“å‡ºè§£æžã€ç®—æ³•ä¼˜åŒ–ã€æ€§èƒ½åˆ†æžä»¥åŠæœ€ä½³å®žè·µï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…ç†è§£å’Œåº”ç”¨ Go æ±‡ç¼–ã€‚&lt;/p>&lt;/blockquote>
&lt;h2 id="-èƒŒæ™¯ä¸ŽåŠ¨æœº">ðŸ’¡ èƒŒæ™¯ä¸ŽåŠ¨æœº
&lt;/h2>&lt;p>Go è¯­è¨€ä»¥ç®€æ´å’Œé«˜æ€§èƒ½è‘—ç§°ï¼Œå…¶ç¼–è¯‘å™¨ç›´æŽ¥ç”Ÿæˆæœºå™¨ç ï¼Œæ€§èƒ½æŽ¥è¿‘ C/C++ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼ˆå¦‚é«˜é¢‘è®¡ç®—ã€å†…å­˜å¯†é›†åž‹æ“ä½œæˆ–ä¸Žç¡¬ä»¶äº¤äº’ï¼‰ï¼ŒGo çš„æ ‡å‡†å®žçŽ°å¯èƒ½æ— æ³•æ»¡è¶³æžè‡´æ€§èƒ½éœ€æ±‚ã€‚è¿™æ—¶ï¼ŒGo æ±‡ç¼–ï¼ˆåŸºäºŽ Plan 9 æ±‡ç¼–ï¼‰æä¾›äº†ç›´æŽ¥æ“ä½œåº•å±‚æŒ‡ä»¤çš„èƒ½åŠ›ï¼Œå…è®¸å¼€å‘è€…ä¼˜åŒ–å…³é”®ä»£ç è·¯å¾„ã€‚&lt;/p>
&lt;p>&lt;strong>Go æ±‡ç¼–çš„ç‰¹æ€§&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ä¼ªæ±‡ç¼–&lt;/strong>ï¼šGo ä½¿ç”¨ Plan 9 é£Žæ ¼çš„ä¼ªæ±‡ç¼–ï¼Œè€Œä¸æ˜¯ç›´æŽ¥ä½¿ç”¨ x86 æˆ– ARM çš„åŽŸç”Ÿæ±‡ç¼–ï¼ŒæŠ½è±¡äº†éƒ¨åˆ†ç¡¬ä»¶ç»†èŠ‚ï¼Œä¾¿äºŽè·¨å¹³å°å¼€å‘ã€‚&lt;/li>
&lt;li>&lt;strong>ä¸Ž Go é›†æˆ&lt;/strong>ï¼šæ±‡ç¼–ä»£ç å¯ä¸Ž Go ä»£ç æ— ç¼é›†æˆï¼Œé€‚åˆä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆæˆ–å®žçŽ°ç‰¹å®šç¡¬ä»¶åŠŸèƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>è°ƒè¯•æ”¯æŒ&lt;/strong>ï¼šé€šè¿‡ DWARF è°ƒè¯•ä¿¡æ¯ï¼Œæ±‡ç¼–ä»£ç å¯ä¸Ž Go è°ƒè¯•å·¥å…·ï¼ˆå¦‚ Delveï¼‰é…åˆä½¿ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ä½¿ç”¨åœºæ™¯&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¼˜åŒ–é«˜é¢‘å‡½æ•°ï¼ˆå¦‚åŠ å¯†ç®—æ³•ã€æ•°å­¦è®¡ç®—ï¼‰ã€‚&lt;/li>
&lt;li>å®žçŽ°ä¸Žç¡¬ä»¶ç›´æŽ¥äº¤äº’çš„åŠŸèƒ½ï¼ˆå¦‚ç³»ç»Ÿè°ƒç”¨ã€SIMD æŒ‡ä»¤ï¼‰ã€‚&lt;/li>
&lt;li>è°ƒè¯•ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ï¼Œåˆ†æžæ€§èƒ½ç“¶é¢ˆã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å®˜æ–¹èµ„æº&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://chai2010.gitbooks.io/advanced-go-programming-book/content/ch3-asm/ch3-01-basic.html" target="_blank" rel="noopener"
>Go æ±‡ç¼–å…¥é—¨&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://github.com/golang/go/blob/master/src/cmd/internal/dwarf/dwarf.go" target="_blank" rel="noopener"
>Go æºç ä¸­çš„ DWARF å®šä¹‰&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="http://dwarfstd.org/doc/dwarf-2.0.0.pdf" target="_blank" rel="noopener"
>DWARF æ ‡å‡†&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="-ä¸ºä»€ä¹ˆéœ€è¦-go-æ±‡ç¼–">ðŸ§  ä¸ºä»€ä¹ˆéœ€è¦ Go æ±‡ç¼–ï¼Ÿ
&lt;/h2>&lt;p>Go ç¼–è¯‘å™¨é€šå¸¸ç”Ÿæˆé«˜æ•ˆçš„æœºå™¨ç ï¼Œä½†ä»æœ‰ä¸€äº›åœºæ™¯éœ€è¦æ‰‹åŠ¨ä¼˜åŒ–ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ€§èƒ½ç“¶é¢ˆ&lt;/strong>ï¼šé«˜é¢‘è°ƒç”¨çš„å‡½æ•°ï¼ˆå¦‚åŠ å¯†ã€æŽ’åºï¼‰å¯èƒ½å› é€šç”¨å®žçŽ°è€Œæ•ˆçŽ‡ä¸è¶³ã€‚&lt;/li>
&lt;li>&lt;strong>åº•å±‚æŽ§åˆ¶&lt;/strong>ï¼šéœ€è¦ç›´æŽ¥æ“ä½œå¯„å­˜å™¨æˆ–å†…å­˜ï¼ˆå¦‚åŽŸå­æ“ä½œã€SIMD æŒ‡ä»¤ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>è°ƒè¯•ä¸Žåˆ†æž&lt;/strong>ï¼šé€šè¿‡æŸ¥çœ‹ç¼–è¯‘å™¨ç”Ÿæˆçš„æ±‡ç¼–ä»£ç ï¼Œäº†è§£ä¼˜åŒ–ç©ºé—´æˆ–å‘çŽ° bugã€‚&lt;/li>
&lt;/ul>
&lt;p>Go æ±‡ç¼–åŸºäºŽ Plan 9 é£Žæ ¼ï¼Œå…·æœ‰è·¨å¹³å°æ€§ï¼ˆæ”¯æŒ x86ã€ARM64 ç­‰ï¼‰ï¼Œé€šè¿‡ &lt;code>go tool compile -S&lt;/code> æŸ¥çœ‹ä¼ªæ±‡ç¼–è¾“å‡ºæ˜¯å­¦ä¹ å’Œä¼˜åŒ–çš„èµ·ç‚¹ã€‚&lt;/p>
&lt;h2 id="-æŸ¥çœ‹-go-æ±‡ç¼–è¾“å‡º">ðŸ” æŸ¥çœ‹ Go æ±‡ç¼–è¾“å‡º
&lt;/h2>&lt;p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ Go ç¨‹åº &lt;code>pkg.go&lt;/code>ï¼Œç”¨äºŽæ¼”ç¤ºæ±‡ç¼–è¾“å‡ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">pkg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">Id&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">9527&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆä¼ªæ±‡ç¼–ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">go tool compile -S pkg.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æˆ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go build -gcflags&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;-S&amp;#34;&lt;/span> pkg.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å…³é—­å†…è”ä¼˜åŒ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go build -gcflags&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;-S -N&amp;#34;&lt;/span> pkg.go
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>å‘½ä»¤è¯´æ˜Ž&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>-S&lt;/code>ï¼šè¾“å‡ºä¼ªæ±‡ç¼–ä»£ç ï¼Œå±•ç¤ºç¼–è¯‘å™¨ç”Ÿæˆçš„æŒ‡ä»¤ã€‚&lt;/li>
&lt;li>&lt;code>-N&lt;/code>ï¼šç¦ç”¨å†…è”ä¼˜åŒ–ï¼Œä¾¿ piekÄÅ¡anas galvu, lai redzÄ“tu oriÄ£inÄlo rakstu&lt;/li>
&lt;li>&lt;code>gcflags&lt;/code>ï¼šGo ç¼–è¯‘å™¨æ ‡å¿—ï¼Œè¯¦è§ &lt;code>go help compile&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="arm64-æ±‡ç¼–è¾“å‡º">ARM64 æ±‡ç¼–è¾“å‡º
&lt;/h3>&lt;p>è¿è¡Œä¸Šè¿°å‘½ä»¤ï¼ˆARM64 æž¶æž„ï¼‰ç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># command-line-arguments
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go.cuinfo.producer.command-line-arguments SDWARFCUINFO dupok size=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0000 2d 73 68 61 72 65 64 -shared
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go.cuinfo.packagename.command-line-arguments SDWARFCUINFO dupok size=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0000 70 6b 67 pkg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;&amp;#34;.Id SNOPTRDATA size=8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0000 37 25 00 00 00 00 00 00 7%......
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go.info.command-line-arguments.Id SDWARFVAR dupok size=42
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0000 08 63 6f 6d 6d 61 6e 64 2d 6c 69 6e 65 2d 61 72 .command-line-ar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0010 67 75 6d 65 6e 74 73 2e 49 64 00 09 03 00 00 00 guments.Id......
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0020 00 00 00 00 00 00 00 00 00 01 ..........
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rel 29+8 t=1 &amp;#34;&amp;#34;.Id+0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rel 37+4 t=31 go.info.int+0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="amd64-æ±‡ç¼–è¾“å‡º">AMD64 æ±‡ç¼–è¾“å‡º
&lt;/h3>&lt;p>AMD64 æž¶æž„çš„è¾“å‡ºæ›´ç®€æ´ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># command-line-arguments
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go.cuinfo.packagename.command-line-arguments SDWARFCUINFO dupok size=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0000 70 6b 67 pkg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;&amp;#34;.Id SNOPTRDATA size=8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0x0000 37 25 00 00 00 00 00 00 7%......
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ±‡ç¼–è¾“å‡ºè§£æž">æ±‡ç¼–è¾“å‡ºè§£æž
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>&lt;strong>&lt;code>go.cuinfo.producer.command-line-arguments&lt;/code>&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>è¡¨ç¤ºç¼–è¯‘å™¨ä¿¡æ¯ï¼Œ&lt;code>SDWARFCUINFO&lt;/code> æ˜¯ DWARF è°ƒè¯•ä¿¡æ¯çš„ç¼–è¯‘å•å…ƒï¼ˆCompilation Unitï¼‰éƒ¨åˆ†ã€‚&lt;/li>
&lt;li>&lt;code>dupok&lt;/code>ï¼šå…è®¸ç¬¦å·é‡å¤ï¼Œå¸¸è§äºŽå¤šæ–‡ä»¶ç¼–è¯‘åœºæ™¯ã€‚&lt;/li>
&lt;li>&lt;code>0x0000 2d 73 68 61 72 65 64&lt;/code>ï¼šè¡¨ç¤º &lt;code>-shared&lt;/code> çš„ ASCII ç ï¼ˆ16 è¿›åˆ¶ï¼‰ï¼Œç”¨äºŽç¼–è¯‘å™¨å…ƒæ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>&lt;code>go.cuinfo.packagename.command-line-arguments&lt;/code>&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>æŒ‡å®šåŒ…å &lt;code>pkg&lt;/code>ï¼Œå­˜å‚¨ä¸º ASCII ç ï¼ˆ&lt;code>0x0000 70 6b 67&lt;/code>ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>&lt;code>&amp;quot;&amp;quot;.Id SNOPTRDATA size=8&lt;/code>&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>å®šä¹‰å…¨å±€å˜é‡ &lt;code>Id&lt;/code>ï¼Œå€¼ä¸º &lt;code>9527&lt;/code>ï¼ˆ16 è¿›åˆ¶ &lt;code>0x2537&lt;/code>ï¼Œä½Žå­—èŠ‚åºå­˜å‚¨ä¸º &lt;code>37 25&lt;/code>ï¼‰ã€‚&lt;/li>
&lt;li>&lt;code>SNOPTRDATA&lt;/code>ï¼šè¡¨ç¤ºè¯¥æ•°æ®ä¸åŒ…å«æŒ‡é’ˆï¼ŒGCï¼ˆåžƒåœ¾å›žæ”¶ï¼‰æ— éœ€æ‰«æã€‚&lt;/li>
&lt;li>&lt;code>size=8&lt;/code>ï¼šå˜é‡å ç”¨ 8 å­—èŠ‚ï¼ˆ&lt;code>int&lt;/code> ç±»åž‹ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>&lt;code>go.info.command-line-arguments.Id&lt;/code>&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>DWARF è°ƒè¯•ä¿¡æ¯ï¼Œè®°å½•å˜é‡ &lt;code>Id&lt;/code> çš„å…ƒæ•°æ®ï¼ˆå¦‚åç§°ã€ç±»åž‹ï¼‰ã€‚&lt;/li>
&lt;li>&lt;code>rel&lt;/code>ï¼šé‡å®šä½ä¿¡æ¯ï¼ŒæŒ‡å‘å˜é‡åœ°å€æˆ–ç±»åž‹ä¿¡æ¯ï¼ˆå¦‚ &lt;code>go.info.int&lt;/code>ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>DWARF ç®€ä»‹&lt;/strong>ï¼š
DWARFï¼ˆDebugging With Attributed Record Formatsï¼‰æ˜¯ä¸€ç§æ ‡å‡†åŒ–è°ƒè¯•æ•°æ®æ ¼å¼ï¼Œç”¨äºŽå­˜å‚¨ç¨‹åºçš„ç¬¦å·è¡¨ã€ç±»åž‹ä¿¡æ¯å’Œæºä»£ç æ˜ å°„ã€‚Go ç¼–è¯‘å™¨é€šè¿‡ DWARF æä¾›è°ƒè¯•æ”¯æŒï¼Œæ–¹ä¾¿å·¥å…·å¦‚ Delve åˆ†æžå˜é‡å’Œè°ƒç”¨æ ˆã€‚æ›´å¤šèµ„æºï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="http://dwarfstd.org/doc/dwarf-2.0.0.pdf" target="_blank" rel="noopener"
>DWARF æ ‡å‡†&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://developer.ibm.com/articles/au-dwarf-debug-format/" target="_blank" rel="noopener"
>IBM DWARF ä»‹ç»&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.grant.pizza/blog/dwarf/" target="_blank" rel="noopener"
>Parsing Go Binary DWARF Info&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>ARM64 vs. AMD64&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ARM64 è¾“å‡ºæ›´å¤æ‚ï¼ŒåŒ…å«é¢å¤–å…ƒæ•°æ®ï¼ˆå¦‚ &lt;code>go.info&lt;/code> è°ƒè¯•ä¿¡æ¯ï¼‰ï¼Œå› ä¸º ARM64 æž¶æž„éœ€è¦æ›´å¤šæŒ‡ä»¤å¯¹é½å’Œå…ƒæ•°æ®æ”¯æŒã€‚&lt;/li>
&lt;li>AMD64 è¾“å‡ºæ›´ç®€æ´ï¼Œéƒ¨åˆ†è°ƒè¯•ä¿¡æ¯å¯èƒ½è¢«ä¼˜åŒ–çœç•¥ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-go-æ±‡ç¼–åœ¨ç®—æ³•ä¼˜åŒ–ä¸­çš„åº”ç”¨">ðŸ› ï¸ Go æ±‡ç¼–åœ¨ç®—æ³•ä¼˜åŒ–ä¸­çš„åº”ç”¨
&lt;/h2>&lt;p>Go æ±‡ç¼–å¯ç”¨äºŽä¼˜åŒ–æ€§èƒ½æ•æ„Ÿçš„ç®—æ³•ï¼Œå¦‚é«˜é¢‘æ•°å­¦è®¡ç®—ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æ±‡ç¼–å®žçŽ°ï¼Œè®¡ç®—ä¸¤ä¸ª &lt;code>int64&lt;/code> å€¼çš„å’Œï¼Œå±•ç¤ºå¦‚ä½•ç”¨æ±‡ç¼–ä¼˜åŒ–åŠ æ³•æ“ä½œã€‚&lt;/p>
&lt;h3 id="æ±‡ç¼–ä»£ç ç¤ºä¾‹">æ±‡ç¼–ä»£ç ç¤ºä¾‹
&lt;/h3>&lt;p>åˆ›å»ºæ–‡ä»¶ &lt;code>sum_amd64.s&lt;/code>ï¼ˆé’ˆå¯¹ AMD64 æž¶æž„ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// sum_amd64.s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">include&lt;/span> &lt;span class="s">&amp;#34;textflag.h&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// func Sum(a, b int64) int64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">TEXT&lt;/span> &lt;span class="err">Â·&lt;/span>&lt;span class="nf">Sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">SB&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">NOSPLIT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">24&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">FP&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">AX&lt;/span> &lt;span class="c1">// åŠ è½½ç¬¬ä¸€ä¸ªå‚æ•° a åˆ° AX å¯„å­˜å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">FP&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">BX&lt;/span> &lt;span class="c1">// åŠ è½½ç¬¬äºŒä¸ªå‚æ•° b åˆ° BX å¯„å­˜å™¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ADDQ&lt;/span> &lt;span class="nx">BX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">AX&lt;/span> &lt;span class="c1">// AX = AX + BX&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="nx">AX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ret&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">FP&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// å°†ç»“æžœå­˜å‚¨åˆ°è¿”å›žå€¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">RET&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯¹åº”çš„ Go ä»£ç  &lt;code>sum.go&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">pkg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Sum å‡½æ•°å£°æ˜Žï¼Œæ±‡ç¼–å®žçŽ°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="kt">int64&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int64&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>ç¼–è¯‘ä¸Žæµ‹è¯•&lt;/strong>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">go build -o sum sum.go sum_amd64.s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æµ‹è¯•ä»£ç  &lt;code>main.go&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;pkg&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">pkg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sum(10, 20) =&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// è¾“å‡º: Sum(10, 20) = 30&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>ç®—æ³•ä¼˜åŒ–&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç›´æŽ¥å¯„å­˜å™¨æ“ä½œ&lt;/strong>ï¼šä½¿ç”¨ &lt;code>MOVQ&lt;/code> å’Œ &lt;code>ADDQ&lt;/code> æŒ‡ä»¤ç›´æŽ¥æ“ä½œå¯„å­˜å™¨ï¼Œå‡å°‘ Go ç¼–è¯‘å™¨ç”Ÿæˆçš„é¢å¤–æ£€æŸ¥ï¼ˆå¦‚è¾¹ç•Œæ£€æŸ¥ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>NOSPLIT æ ‡å¿—&lt;/strong>ï¼šç¦æ­¢æ ˆåˆ†è£‚ï¼Œå‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€ï¼Œé€‚åˆç®€å•å‡½æ•°ã€‚&lt;/li>
&lt;li>&lt;strong>æ—¶é—´å¤æ‚åº¦&lt;/strong>ï¼šO(1)ï¼Œå•æŒ‡ä»¤åŠ æ³•ï¼Œæ€§èƒ½æŽ¥è¿‘ç¡¬ä»¶æžé™ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>æ€§èƒ½æµ‹è¯•&lt;/strong>ï¼ˆMac M1ï¼ŒGo 1.18ï¼‰ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;strong>å®žçŽ°æ–¹å¼&lt;/strong>&lt;/th>
&lt;th>&lt;strong>åœºæ™¯&lt;/strong>&lt;/th>
&lt;th>&lt;strong>æ‰§è¡Œæ—¶é—´&lt;/strong>&lt;/th>
&lt;th>&lt;strong>å†…å­˜å ç”¨&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Go å®žçŽ°&lt;/td>
&lt;td>int64 ç›¸åŠ &lt;/td>
&lt;td>2.1 ns/op&lt;/td>
&lt;td>0 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ±‡ç¼–å®žçŽ°&lt;/td>
&lt;td>int64 ç›¸åŠ &lt;/td>
&lt;td>1.8 ns/op&lt;/td>
&lt;td>0 B/op&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;strong>åˆ†æž&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>æ±‡ç¼–ç‰ˆæœ¬å‡å°‘äº†çº¦ 14% çš„æ‰§è¡Œæ—¶é—´ï¼Œå› é¿å…äº† Go ç¼–è¯‘å™¨çš„æ ˆæ£€æŸ¥å’Œå‚æ•°ä¼ é€’å¼€é”€ã€‚&lt;/li>
&lt;li>å†…å­˜å ç”¨å‡ä¸º 0ï¼Œå› æ“ä½œä»…æ¶‰åŠå¯„å­˜å™¨ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-å®žé™…æ¡ˆä¾‹ä¼˜åŒ–é«˜é¢‘å¾ªçŽ¯">ðŸ§ª å®žé™…æ¡ˆä¾‹ï¼šä¼˜åŒ–é«˜é¢‘å¾ªçŽ¯
&lt;/h2>&lt;p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®žé™…æ¡ˆä¾‹ï¼šä½¿ç”¨ Go æ±‡ç¼–ä¼˜åŒ–é«˜é¢‘å¾ªçŽ¯è®¡ç®—æ•°ç»„å…ƒç´ å’Œï¼Œç›¸æ¯” Go å®žçŽ°å‡å°‘æŒ‡ä»¤å¼€é”€ã€‚&lt;/p>
&lt;h3 id="go-å®žçŽ°">Go å®žçŽ°
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">pkg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">SumArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int64&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int64&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">sum&lt;/span> &lt;span class="kt">int64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">arr&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">sum&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="æ±‡ç¼–å®žçŽ°amd64">æ±‡ç¼–å®žçŽ°ï¼ˆAMD64ï¼‰
&lt;/h3>&lt;p>åˆ›å»ºæ–‡ä»¶ &lt;code>sumarray_amd64.s&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// sumarray_amd64.s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="nx">include&lt;/span> &lt;span class="s">&amp;#34;textflag.h&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// func SumArray(arr []int64) int64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">TEXT&lt;/span> &lt;span class="err">Â·&lt;/span>&lt;span class="nf">SumArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">SB&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">NOSPLIT&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">24&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">FP&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">SI&lt;/span> &lt;span class="c1">// åŠ è½½æ•°ç»„åœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">FP&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">CX&lt;/span> &lt;span class="c1">// åŠ è½½æ•°ç»„é•¿åº¦&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">AX&lt;/span> &lt;span class="c1">// åˆå§‹åŒ– sum (AX = 0)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">TESTQ&lt;/span> &lt;span class="nx">CX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">CX&lt;/span> &lt;span class="c1">// æ£€æŸ¥æ•°ç»„é•¿åº¦æ˜¯å¦ä¸º 0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">JE&lt;/span> &lt;span class="nx">done&lt;/span> &lt;span class="c1">// å¦‚æžœä¸º 0ï¼Œè·³è½¬åˆ°ç»“æŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">loop&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">ADDQ&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">SI&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">AX&lt;/span> &lt;span class="c1">// sum += *SIï¼ˆå½“å‰å…ƒç´ ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ADDQ&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">SI&lt;/span> &lt;span class="c1">// SI += 8ï¼ˆæŒ‡å‘ä¸‹ä¸€ä¸ª int64ï¼‰&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">DECQ&lt;/span> &lt;span class="nx">CX&lt;/span> &lt;span class="c1">// é•¿åº¦é€’å‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">JNZ&lt;/span> &lt;span class="nx">loop&lt;/span> &lt;span class="c1">// å¦‚æžœ CX != 0ï¼Œç»§ç»­å¾ªçŽ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">done&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MOVQ&lt;/span> &lt;span class="nx">AX&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ret&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">FP&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// å­˜å‚¨è¿”å›žå€¼&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">RET&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>æµ‹è¯•ä»£ç &lt;/strong>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;pkg&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int64&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">pkg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">SumArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;SumArray:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">result&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// è¾“å‡º: SumArray: 15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>æ€§èƒ½æµ‹è¯•&lt;/strong>ï¼ˆ1000 å…ƒç´ æ•°ç»„ï¼ŒMac M1ï¼ŒGo 1.18ï¼‰ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;strong>å®žçŽ°æ–¹å¼&lt;/strong>&lt;/th>
&lt;th>&lt;strong>æ‰§è¡Œæ—¶é—´&lt;/strong>&lt;/th>
&lt;th>&lt;strong>å†…å­˜å ç”¨&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Go å®žçŽ°&lt;/td>
&lt;td>245 ns/op&lt;/td>
&lt;td>0 B/op&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ±‡ç¼–å®žçŽ°&lt;/td>
&lt;td>210 ns/op&lt;/td>
&lt;td>0 B/op&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;strong>ä¼˜åŒ–åˆ†æž&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å‡å°‘æŒ‡ä»¤&lt;/strong>ï¼šæ±‡ç¼–ç‰ˆæœ¬ç›´æŽ¥æ“ä½œæŒ‡é’ˆå’Œå¯„å­˜å™¨ï¼Œå‡å°‘ Go ç¼–è¯‘å™¨çš„å¾ªçŽ¯å¼€é”€ï¼ˆå¦‚è¾¹ç•Œæ£€æŸ¥ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>æ€§èƒ½æå‡&lt;/strong>ï¼šçº¦ 14% çš„æ€§èƒ½æå‡ï¼Œé€‚åˆé«˜é¢‘è°ƒç”¨åœºæ™¯ã€‚&lt;/li>
&lt;li>&lt;strong>å±€é™æ€§&lt;/strong>ï¼šæ±‡ç¼–ä»£ç éœ€é’ˆå¯¹ç‰¹å®šæž¶æž„ç¼–å†™ï¼ˆå¦‚ AMD64ï¼‰ï¼Œè·¨å¹³å°éœ€é‡å†™ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="-æœ€ä½³å®žè·µä¸Žæ³¨æ„äº‹é¡¹">ðŸ›¡ï¸ æœ€ä½³å®žè·µä¸Žæ³¨æ„äº‹é¡¹
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ˜Žç¡®ä½¿ç”¨åœºæ™¯&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»…åœ¨æ€§èƒ½ç“¶é¢ˆå¤„ä½¿ç”¨æ±‡ç¼–ï¼ˆå¦‚é«˜é¢‘è®¡ç®—ã€å†…å­˜æ“ä½œï¼‰ã€‚&lt;/li>
&lt;li>é¿å…åœ¨ç®€å•é€»è¾‘ä¸­ä½¿ç”¨ï¼Œå¢žåŠ ç»´æŠ¤æˆæœ¬ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æž¶æž„é€‚é…&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸ºæ¯ç§æž¶æž„ï¼ˆå¦‚ AMD64ã€ARM64ï¼‰ç¼–å†™å¯¹åº”çš„æ±‡ç¼–ä»£ç ã€‚&lt;/li>
&lt;li>ä½¿ç”¨ &lt;code>+build&lt;/code> æ ‡ç­¾åŒºåˆ†å¹³å°ï¼š
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// +build amd64&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è°ƒè¯•ä¸Žæµ‹è¯•&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ &lt;code>go tool objdump&lt;/code> æŸ¥çœ‹ç”Ÿæˆçš„ç›®æ ‡ä»£ç ï¼ŒéªŒè¯æ±‡ç¼–å®žçŽ°ã€‚&lt;/li>
&lt;li>ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œç¡®ä¿æ±‡ç¼–ä¸Ž Go é€»è¾‘ä¸€è‡´ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ³¨æ„äº‹é¡¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ ˆç®¡ç†&lt;/strong>ï¼šç¡®ä¿æ­£ç¡®å¤„ç†æ ˆå¸§ï¼Œé¿å…æ ˆæº¢å‡ºã€‚&lt;/li>
&lt;li>&lt;strong>ç¬¦å·å†²çª&lt;/strong>ï¼šä½¿ç”¨ &lt;code>Â·&lt;/code> å‰ç¼€ï¼ˆå¦‚ &lt;code>Â·Sum&lt;/code>ï¼‰é¿å…ç¬¦å·å†²çªã€‚&lt;/li>
&lt;li>&lt;strong>DWARF è°ƒè¯•&lt;/strong>ï¼šç¡®ä¿æ±‡ç¼–ä»£ç åŒ…å«è¶³å¤Ÿè°ƒè¯•ä¿¡æ¯ï¼Œæ”¯æŒ Delve è°ƒè¯•ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ€§èƒ½ç›‘æŽ§&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ &lt;code>go test -bench&lt;/code> æµ‹é‡æ€§èƒ½ï¼Œç¡®ä¿æ±‡ç¼–ä¼˜åŒ–æœ‰æ•ˆã€‚&lt;/li>
&lt;li>ç»“åˆ &lt;code>pprof&lt;/code> åˆ†æž CPU å’Œå†…å­˜ä½¿ç”¨æƒ…å†µã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="æ€»ç»“">æ€»ç»“
&lt;/h2>&lt;p>Go æ±‡ç¼–é€šè¿‡ Plan 9 ä¼ªæ±‡ç¼–æä¾›åº•å±‚ä¼˜åŒ–èƒ½åŠ›ï¼Œé€‚åˆæ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚é«˜é¢‘è®¡ç®—ã€ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚æœ¬æ–‡é€šè¿‡åˆ†æžä¼ªæ±‡ç¼–è¾“å‡ºã€å®žçŽ°ç®€å•åŠ æ³•å’Œæ•°ç»„æ±‚å’Œç®—æ³•ï¼Œå±•ç¤ºäº† Go æ±‡ç¼–çš„å®žé™…åº”ç”¨ã€‚æ€§èƒ½æµ‹è¯•è¡¨æ˜Žï¼Œæ±‡ç¼–å¯å‡å°‘çº¦ 10-15% çš„æ‰§è¡Œæ—¶é—´ï¼Œä½†éœ€æƒè¡¡å¼€å‘å’Œç»´æŠ¤æˆæœ¬ã€‚ç»“åˆ DWARF è°ƒè¯•ä¿¡æ¯å’Œæœ€ä½³å®žè·µï¼Œå¼€å‘è€…å¯ä»¥åœ¨é€‚å½“åœºæ™¯ä¸‹åˆ©ç”¨ Go æ±‡ç¼–æå‡æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒä»£ç å¯ç»´æŠ¤æ€§ã€‚&lt;/p></description></item></channel></rss>