<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=" Rust å› å…¶é«˜æ€§èƒ½å’Œå†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œæˆä¸ºæ„å»º Python åŸç”Ÿæ‰©å±•çš„ç†æƒ³é€‰æ‹©ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ Python åº“ï¼Œå±•ç¤º Rust ä¸ Python çš„äº’æ“ä½œæµç¨‹ï¼ŒåŒ…æ‹¬é¡¹ç›®è®¾ç½®ã€å®ç°ä»£ç ã€æ€§èƒ½æµ‹è¯•å’Œå‘å¸ƒåˆ° PyPIã€‚æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªé«˜æ•ˆçš„æ–æ³¢é‚£å¥‘è®¡ç®—æ¨¡å—ï¼Œå¹¶æ¢è®¨ Rust åœ¨æ€§èƒ½ä¼˜åŒ–ä¸­çš„ä¼˜åŠ¿ã€‚\nğŸ’¡ èƒŒæ™¯ä¸åŠ¨æœº Python å› å…¶ç®€æ´æ€§å’Œç”Ÿæ€ä¸°å¯Œè€Œå¹¿æ³›ç”¨äºæ•°æ®ç§‘å­¦ã€Web å¼€å‘ç­‰é¢†åŸŸï¼Œä½†åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚æ•°å€¼è®¡ç®—ï¼‰ä¸­ï¼ŒCPython çš„è§£é‡Šæ‰§è¡Œå¯èƒ½å¯¼è‡´æ•ˆç‡ç“¶é¢ˆã€‚Rust ä½œä¸ºä¸€é—¨é«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œé€šè¿‡ FFIï¼ˆForeign Function Interfaceï¼‰ä¸ Python ç»“åˆï¼Œå¯ä»¥æ˜¾è‘—æå‡è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„æ€§èƒ½ã€‚\nä¸ºä»€ä¹ˆé€‰æ‹© Rust æ„å»º Python åº“ï¼Ÿ\næ€§èƒ½ï¼šRust ç¼–è¯‘ä¸ºåŸç”Ÿæœºå™¨ç ï¼Œæ¥è¿‘ C/C++ çš„æ€§èƒ½ï¼Œé€‚åˆä¼˜åŒ–æ–æ³¢é‚£å¥‘ç­‰é€’å½’æˆ–è¿­ä»£è®¡ç®—ã€‚ å†…å­˜å®‰å…¨ï¼šRust çš„æ‰€æœ‰æƒæ¨¡å‹ç¡®ä¿æ— å†…å­˜æ³„æ¼å’Œæ•°æ®ç«äº‰ï¼Œé€‚åˆæ„å»ºå¯é çš„ Python æ‰©å±•ã€‚ ç”Ÿæ€æ”¯æŒï¼šé€šè¿‡ PyO3 å’Œ maturinï¼ŒRust æä¾›äº†ä¸ Python æ— ç¼é›†æˆçš„å·¥å…·é“¾ã€‚ æœ¬æ–‡ç›®æ ‡ï¼šä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ª Python åº“ fibonacci_rsï¼Œæä¾›æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—åŠŸèƒ½ï¼Œæ”¯æŒé€’å½’å’Œè¿­ä»£ä¸¤ç§å®ç°ï¼Œå¹¶ä¸çº¯ Python å®ç°è¿›è¡Œæ€§èƒ½å¯¹æ¯”ã€‚\nğŸ› ï¸ é¡¹ç›®è®¾ç½® ä»¥ä¸‹æ˜¯å¼€å‘ç¯å¢ƒçš„è®¾ç½®æ­¥éª¤ï¼Œç¡®ä¿ä½ å·²å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š\nRustï¼ˆé€šè¿‡ rustup å®‰è£…ï¼Œæ¨èæœ€æ–°ç¨³å®šç‰ˆï¼Œå¦‚ 1.80.0ï¼‰ã€‚ Pythonï¼ˆ3.7+ï¼Œæœ¬æ–‡ä½¿ç”¨ 3.11ï¼‰ã€‚ maturinï¼šç”¨äºæ„å»ºå’Œå‘å¸ƒ Rust-Python åº“ï¼ˆpip install maturinï¼‰ã€‚ 1. åˆ›å»ºé¡¹ç›® ä½¿ç”¨ maturin åˆå§‹åŒ–ä¸€ä¸ªæ··åˆé¡¹ç›®ï¼š\n"><title>ä½¿ç”¨ruståŠ é€Ÿpython</title><link rel=canonical href=https://60ke.github.io/posts/%E4%BD%BF%E7%94%A8rust%E5%8A%A0%E9%80%9Fpython/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="ä½¿ç”¨ruståŠ é€Ÿpython"><meta property='og:description' content=" Rust å› å…¶é«˜æ€§èƒ½å’Œå†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œæˆä¸ºæ„å»º Python åŸç”Ÿæ‰©å±•çš„ç†æƒ³é€‰æ‹©ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ Python åº“ï¼Œå±•ç¤º Rust ä¸ Python çš„äº’æ“ä½œæµç¨‹ï¼ŒåŒ…æ‹¬é¡¹ç›®è®¾ç½®ã€å®ç°ä»£ç ã€æ€§èƒ½æµ‹è¯•å’Œå‘å¸ƒåˆ° PyPIã€‚æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªé«˜æ•ˆçš„æ–æ³¢é‚£å¥‘è®¡ç®—æ¨¡å—ï¼Œå¹¶æ¢è®¨ Rust åœ¨æ€§èƒ½ä¼˜åŒ–ä¸­çš„ä¼˜åŠ¿ã€‚\nğŸ’¡ èƒŒæ™¯ä¸åŠ¨æœº Python å› å…¶ç®€æ´æ€§å’Œç”Ÿæ€ä¸°å¯Œè€Œå¹¿æ³›ç”¨äºæ•°æ®ç§‘å­¦ã€Web å¼€å‘ç­‰é¢†åŸŸï¼Œä½†åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚æ•°å€¼è®¡ç®—ï¼‰ä¸­ï¼ŒCPython çš„è§£é‡Šæ‰§è¡Œå¯èƒ½å¯¼è‡´æ•ˆç‡ç“¶é¢ˆã€‚Rust ä½œä¸ºä¸€é—¨é«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œé€šè¿‡ FFIï¼ˆForeign Function Interfaceï¼‰ä¸ Python ç»“åˆï¼Œå¯ä»¥æ˜¾è‘—æå‡è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„æ€§èƒ½ã€‚\nä¸ºä»€ä¹ˆé€‰æ‹© Rust æ„å»º Python åº“ï¼Ÿ\næ€§èƒ½ï¼šRust ç¼–è¯‘ä¸ºåŸç”Ÿæœºå™¨ç ï¼Œæ¥è¿‘ C/C++ çš„æ€§èƒ½ï¼Œé€‚åˆä¼˜åŒ–æ–æ³¢é‚£å¥‘ç­‰é€’å½’æˆ–è¿­ä»£è®¡ç®—ã€‚ å†…å­˜å®‰å…¨ï¼šRust çš„æ‰€æœ‰æƒæ¨¡å‹ç¡®ä¿æ— å†…å­˜æ³„æ¼å’Œæ•°æ®ç«äº‰ï¼Œé€‚åˆæ„å»ºå¯é çš„ Python æ‰©å±•ã€‚ ç”Ÿæ€æ”¯æŒï¼šé€šè¿‡ PyO3 å’Œ maturinï¼ŒRust æä¾›äº†ä¸ Python æ— ç¼é›†æˆçš„å·¥å…·é“¾ã€‚ æœ¬æ–‡ç›®æ ‡ï¼šä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ª Python åº“ fibonacci_rsï¼Œæä¾›æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—åŠŸèƒ½ï¼Œæ”¯æŒé€’å½’å’Œè¿­ä»£ä¸¤ç§å®ç°ï¼Œå¹¶ä¸çº¯ Python å®ç°è¿›è¡Œæ€§èƒ½å¯¹æ¯”ã€‚\nğŸ› ï¸ é¡¹ç›®è®¾ç½® ä»¥ä¸‹æ˜¯å¼€å‘ç¯å¢ƒçš„è®¾ç½®æ­¥éª¤ï¼Œç¡®ä¿ä½ å·²å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š\nRustï¼ˆé€šè¿‡ rustup å®‰è£…ï¼Œæ¨èæœ€æ–°ç¨³å®šç‰ˆï¼Œå¦‚ 1.80.0ï¼‰ã€‚ Pythonï¼ˆ3.7+ï¼Œæœ¬æ–‡ä½¿ç”¨ 3.11ï¼‰ã€‚ maturinï¼šç”¨äºæ„å»ºå’Œå‘å¸ƒ Rust-Python åº“ï¼ˆpip install maturinï¼‰ã€‚ 1. åˆ›å»ºé¡¹ç›® ä½¿ç”¨ maturin åˆå§‹åŒ–ä¸€ä¸ªæ··åˆé¡¹ç›®ï¼š\n"><meta property='og:url' content='https://60ke.github.io/posts/%E4%BD%BF%E7%94%A8rust%E5%8A%A0%E9%80%9Fpython/'><meta property='og:site_name' content='LookForAdmin'><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:published_time' content='2023-07-01T17:00:45+08:00'><meta property='article:modified_time' content='2023-07-01T17:00:45+08:00'><meta name=twitter:title content="ä½¿ç”¨ruståŠ é€Ÿpython"><meta name=twitter:description content=" Rust å› å…¶é«˜æ€§èƒ½å’Œå†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œæˆä¸ºæ„å»º Python åŸç”Ÿæ‰©å±•çš„ç†æƒ³é€‰æ‹©ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ Python åº“ï¼Œå±•ç¤º Rust ä¸ Python çš„äº’æ“ä½œæµç¨‹ï¼ŒåŒ…æ‹¬é¡¹ç›®è®¾ç½®ã€å®ç°ä»£ç ã€æ€§èƒ½æµ‹è¯•å’Œå‘å¸ƒåˆ° PyPIã€‚æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªé«˜æ•ˆçš„æ–æ³¢é‚£å¥‘è®¡ç®—æ¨¡å—ï¼Œå¹¶æ¢è®¨ Rust åœ¨æ€§èƒ½ä¼˜åŒ–ä¸­çš„ä¼˜åŠ¿ã€‚\nğŸ’¡ èƒŒæ™¯ä¸åŠ¨æœº Python å› å…¶ç®€æ´æ€§å’Œç”Ÿæ€ä¸°å¯Œè€Œå¹¿æ³›ç”¨äºæ•°æ®ç§‘å­¦ã€Web å¼€å‘ç­‰é¢†åŸŸï¼Œä½†åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚æ•°å€¼è®¡ç®—ï¼‰ä¸­ï¼ŒCPython çš„è§£é‡Šæ‰§è¡Œå¯èƒ½å¯¼è‡´æ•ˆç‡ç“¶é¢ˆã€‚Rust ä½œä¸ºä¸€é—¨é«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œé€šè¿‡ FFIï¼ˆForeign Function Interfaceï¼‰ä¸ Python ç»“åˆï¼Œå¯ä»¥æ˜¾è‘—æå‡è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„æ€§èƒ½ã€‚\nä¸ºä»€ä¹ˆé€‰æ‹© Rust æ„å»º Python åº“ï¼Ÿ\næ€§èƒ½ï¼šRust ç¼–è¯‘ä¸ºåŸç”Ÿæœºå™¨ç ï¼Œæ¥è¿‘ C/C++ çš„æ€§èƒ½ï¼Œé€‚åˆä¼˜åŒ–æ–æ³¢é‚£å¥‘ç­‰é€’å½’æˆ–è¿­ä»£è®¡ç®—ã€‚ å†…å­˜å®‰å…¨ï¼šRust çš„æ‰€æœ‰æƒæ¨¡å‹ç¡®ä¿æ— å†…å­˜æ³„æ¼å’Œæ•°æ®ç«äº‰ï¼Œé€‚åˆæ„å»ºå¯é çš„ Python æ‰©å±•ã€‚ ç”Ÿæ€æ”¯æŒï¼šé€šè¿‡ PyO3 å’Œ maturinï¼ŒRust æä¾›äº†ä¸ Python æ— ç¼é›†æˆçš„å·¥å…·é“¾ã€‚ æœ¬æ–‡ç›®æ ‡ï¼šä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ª Python åº“ fibonacci_rsï¼Œæä¾›æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—åŠŸèƒ½ï¼Œæ”¯æŒé€’å½’å’Œè¿­ä»£ä¸¤ç§å®ç°ï¼Œå¹¶ä¸çº¯ Python å®ç°è¿›è¡Œæ€§èƒ½å¯¹æ¯”ã€‚\nğŸ› ï¸ é¡¹ç›®è®¾ç½® ä»¥ä¸‹æ˜¯å¼€å‘ç¯å¢ƒçš„è®¾ç½®æ­¥éª¤ï¼Œç¡®ä¿ä½ å·²å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š\nRustï¼ˆé€šè¿‡ rustup å®‰è£…ï¼Œæ¨èæœ€æ–°ç¨³å®šç‰ˆï¼Œå¦‚ 1.80.0ï¼‰ã€‚ Pythonï¼ˆ3.7+ï¼Œæœ¬æ–‡ä½¿ç”¨ 3.11ï¼‰ã€‚ maturinï¼šç”¨äºæ„å»ºå’Œå‘å¸ƒ Rust-Python åº“ï¼ˆpip install maturinï¼‰ã€‚ 1. åˆ›å»ºé¡¹ç›® ä½¿ç”¨ maturin åˆå§‹åŒ–ä¸€ä¸ªæ··åˆé¡¹ç›®ï¼š\n"><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/Avatar.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LookForAdmin</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=menu-social><li><a href=https://github.com/60ke target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/posts target=_blank><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/drafts><svg class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg>
<span>è‰ç¨¿ç®±</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>about</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#-èƒŒæ™¯ä¸åŠ¨æœº>ğŸ’¡ èƒŒæ™¯ä¸åŠ¨æœº</a></li><li><a href=#-é¡¹ç›®è®¾ç½®>ğŸ› ï¸ é¡¹ç›®è®¾ç½®</a><ol><li><a href=#1-åˆ›å»ºé¡¹ç›®>1. åˆ›å»ºé¡¹ç›®</a></li><li><a href=#2-é…ç½®-cargotoml>2. é…ç½® <code>Cargo.toml</code></a></li><li><a href=#3-é…ç½®-pyprojecttoml>3. é…ç½® <code>pyproject.toml</code></a></li></ol></li><li><a href=#-å®ç°æ–æ³¢é‚£å¥‘è®¡ç®—>ğŸ”§ å®ç°æ–æ³¢é‚£å¥‘è®¡ç®—</a></li><li><a href=#-æ„å»ºä¸æµ‹è¯•>ğŸ§ª æ„å»ºä¸æµ‹è¯•</a><ol><li><a href=#1-æ„å»º-python-æ¨¡å—>1. æ„å»º Python æ¨¡å—</a></li><li><a href=#2-æµ‹è¯•ä»£ç >2. æµ‹è¯•ä»£ç </a></li></ol></li><li><a href=#-æ€§èƒ½åˆ†æ>ğŸ“ˆ æ€§èƒ½åˆ†æ</a><ol><li><a href=#æµ‹è¯•ä»£ç >æµ‹è¯•ä»£ç </a></li></ol></li><li><a href=#-ä¼˜åŒ–æ–æ³¢é‚£å¥‘è®¡ç®—>ğŸš€ ä¼˜åŒ–æ–æ³¢é‚£å¥‘è®¡ç®—</a></li><li><a href=#-å‘å¸ƒåˆ°-pypi>ğŸ“¦ å‘å¸ƒåˆ° PyPI</a></li><li><a href=#-æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹>ğŸ›¡ï¸ æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</a></li><li><a href=#-æ€»ç»“>ğŸ§  æ€»ç»“</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/%E4%BD%BF%E7%94%A8rust%E5%8A%A0%E9%80%9Fpython/>ä½¿ç”¨ruståŠ é€Ÿpython</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 01, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 5 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><blockquote><p>Rust å› å…¶é«˜æ€§èƒ½å’Œå†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œæˆä¸ºæ„å»º Python åŸç”Ÿæ‰©å±•çš„ç†æƒ³é€‰æ‹©ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ Python åº“ï¼Œå±•ç¤º Rust ä¸ Python çš„äº’æ“ä½œæµç¨‹ï¼ŒåŒ…æ‹¬é¡¹ç›®è®¾ç½®ã€å®ç°ä»£ç ã€æ€§èƒ½æµ‹è¯•å’Œå‘å¸ƒåˆ° PyPIã€‚æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªé«˜æ•ˆçš„æ–æ³¢é‚£å¥‘è®¡ç®—æ¨¡å—ï¼Œå¹¶æ¢è®¨ Rust åœ¨æ€§èƒ½ä¼˜åŒ–ä¸­çš„ä¼˜åŠ¿ã€‚</p></blockquote><h2 id=-èƒŒæ™¯ä¸åŠ¨æœº>ğŸ’¡ èƒŒæ™¯ä¸åŠ¨æœº</h2><p>Python å› å…¶ç®€æ´æ€§å’Œç”Ÿæ€ä¸°å¯Œè€Œå¹¿æ³›ç”¨äºæ•°æ®ç§‘å­¦ã€Web å¼€å‘ç­‰é¢†åŸŸï¼Œä½†åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚æ•°å€¼è®¡ç®—ï¼‰ä¸­ï¼ŒCPython çš„è§£é‡Šæ‰§è¡Œå¯èƒ½å¯¼è‡´æ•ˆç‡ç“¶é¢ˆã€‚Rust ä½œä¸ºä¸€é—¨é«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œé€šè¿‡ FFIï¼ˆForeign Function Interfaceï¼‰ä¸ Python ç»“åˆï¼Œå¯ä»¥æ˜¾è‘—æå‡è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„æ€§èƒ½ã€‚</p><p><strong>ä¸ºä»€ä¹ˆé€‰æ‹© Rust æ„å»º Python åº“ï¼Ÿ</strong></p><ul><li><strong>æ€§èƒ½</strong>ï¼šRust ç¼–è¯‘ä¸ºåŸç”Ÿæœºå™¨ç ï¼Œæ¥è¿‘ C/C++ çš„æ€§èƒ½ï¼Œé€‚åˆä¼˜åŒ–æ–æ³¢é‚£å¥‘ç­‰é€’å½’æˆ–è¿­ä»£è®¡ç®—ã€‚</li><li><strong>å†…å­˜å®‰å…¨</strong>ï¼šRust çš„æ‰€æœ‰æƒæ¨¡å‹ç¡®ä¿æ— å†…å­˜æ³„æ¼å’Œæ•°æ®ç«äº‰ï¼Œé€‚åˆæ„å»ºå¯é çš„ Python æ‰©å±•ã€‚</li><li><strong>ç”Ÿæ€æ”¯æŒ</strong>ï¼šé€šè¿‡ <code>PyO3</code> å’Œ <code>maturin</code>ï¼ŒRust æä¾›äº†ä¸ Python æ— ç¼é›†æˆçš„å·¥å…·é“¾ã€‚</li></ul><p><strong>æœ¬æ–‡ç›®æ ‡</strong>ï¼šä½¿ç”¨ Rust å¼€å‘ä¸€ä¸ª Python åº“ <code>fibonacci_rs</code>ï¼Œæä¾›æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—åŠŸèƒ½ï¼Œæ”¯æŒé€’å½’å’Œè¿­ä»£ä¸¤ç§å®ç°ï¼Œå¹¶ä¸çº¯ Python å®ç°è¿›è¡Œæ€§èƒ½å¯¹æ¯”ã€‚</p><h2 id=-é¡¹ç›®è®¾ç½®>ğŸ› ï¸ é¡¹ç›®è®¾ç½®</h2><p>ä»¥ä¸‹æ˜¯å¼€å‘ç¯å¢ƒçš„è®¾ç½®æ­¥éª¤ï¼Œç¡®ä¿ä½ å·²å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š</p><ul><li>Rustï¼ˆé€šè¿‡ <code>rustup</code> å®‰è£…ï¼Œæ¨èæœ€æ–°ç¨³å®šç‰ˆï¼Œå¦‚ 1.80.0ï¼‰ã€‚</li><li>Pythonï¼ˆ3.7+ï¼Œæœ¬æ–‡ä½¿ç”¨ 3.11ï¼‰ã€‚</li><li><code>maturin</code>ï¼šç”¨äºæ„å»ºå’Œå‘å¸ƒ Rust-Python åº“ï¼ˆ<code>pip install maturin</code>ï¼‰ã€‚</li></ul><h3 id=1-åˆ›å»ºé¡¹ç›®>1. åˆ›å»ºé¡¹ç›®</h3><p>ä½¿ç”¨ <code>maturin</code> åˆå§‹åŒ–ä¸€ä¸ªæ··åˆé¡¹ç›®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>maturin new fibonacci_rs
</span></span><span class=line><span class=cl><span class=nb>cd</span> fibonacci_rs
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¼šç”Ÿæˆä»¥ä¸‹é¡¹ç›®ç»“æ„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>fibonacci_rs/
</span></span><span class=line><span class=cl>â”œâ”€â”€ Cargo.toml
</span></span><span class=line><span class=cl>â”œâ”€â”€ src/
</span></span><span class=line><span class=cl>â”‚   â””â”€â”€ lib.rs
</span></span><span class=line><span class=cl>â”œâ”€â”€ pyproject.toml
</span></span><span class=line><span class=cl>â””â”€â”€ README.md
</span></span></code></pre></td></tr></table></div></div><h3 id=2-é…ç½®-cargotoml>2. é…ç½® <code>Cargo.toml</code></h3><p>ç¼–è¾‘ <code>Cargo.toml</code>ï¼Œæ·»åŠ  <code>PyO3</code> ä¾èµ–å¹¶é…ç½®åº“ç±»å‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>package</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;fibonacci_rs&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>edition</span> <span class=p>=</span> <span class=s2>&#34;2021&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>lib</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;fibonacci_rs&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>crate-type</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;cdylib&#34;</span><span class=p>]</span>  <span class=c># ç”ŸæˆåŠ¨æ€åº“ä¾› Python è°ƒç”¨</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>dependencies</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>pyo3</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.22.0&#34;</span><span class=p>,</span> <span class=nx>features</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;extension-module&#34;</span><span class=p>]</span> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-é…ç½®-pyprojecttoml>3. é…ç½® <code>pyproject.toml</code></h3><p>ç¡®ä¿ <code>pyproject.toml</code> æ­£ç¡®é…ç½®æ¨¡å—åç§°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;fibonacci_rs&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>description</span> <span class=p>=</span> <span class=s2>&#34;A Python library for Fibonacci calculation implemented in Rust&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.7&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>build-system</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>requires</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;maturin&gt;=1.0,&lt;2.0&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>build-backend</span> <span class=p>=</span> <span class=s2>&#34;maturin&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=-å®ç°æ–æ³¢é‚£å¥‘è®¡ç®—>ğŸ”§ å®ç°æ–æ³¢é‚£å¥‘è®¡ç®—</h2><p>æˆ‘ä»¬å°†å®ç°ä¸¤ç§æ–æ³¢é‚£å¥‘è®¡ç®—æ–¹æ³•ï¼š</p><ul><li><strong>é€’å½’å®ç°</strong>ï¼šå±•ç¤º Rust çš„é€’å½’ä¼˜åŒ–ã€‚</li><li><strong>è¿­ä»£å®ç°</strong>ï¼šæä¾›æ›´é«˜çš„æ€§èƒ½ï¼Œé€‚åˆå¤§è¾“å…¥ã€‚</li></ul><p>ç¼–è¾‘ <code>src/lib.rs</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>pyo3</span>::<span class=n>prelude</span>::<span class=o>*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// é€’å½’å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#[pyfunction]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>fib_recursive</span><span class=p>(</span><span class=n>n</span>: <span class=kt>u64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>PyResult</span><span class=o>&lt;</span><span class=kt>u64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nb>Ok</span><span class=p>(</span><span class=n>n</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>fib_recursive</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=o>?</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>fib_recursive</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// è¿­ä»£å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#[pyfunction]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>fib_iterative</span><span class=p>(</span><span class=n>n</span>: <span class=kt>u64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>PyResult</span><span class=o>&lt;</span><span class=kt>u64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nb>Ok</span><span class=p>(</span><span class=n>n</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=k>mut</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>2</span><span class=o>..=</span><span class=n>n</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>b</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// Python æ¨¡å—å®šä¹‰
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#[pymodule]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>fibonacci_rs</span><span class=p>(</span><span class=n>_py</span>: <span class=nc>Python</span><span class=p>,</span><span class=w> </span><span class=n>m</span>: <span class=kp>&amp;</span><span class=nc>Bound</span><span class=o>&lt;</span><span class=n>PyModule</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>PyResult</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>add_function</span><span class=p>(</span><span class=fm>wrap_pyfunction!</span><span class=p>(</span><span class=n>fib_recursive</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>add_function</span><span class=p>(</span><span class=fm>wrap_pyfunction!</span><span class=p>(</span><span class=n>fib_iterative</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p><ul><li><code>#[pyfunction]</code>ï¼šå°† Rust å‡½æ•°æš´éœ²ä¸º Python å‡½æ•°ã€‚</li><li><code>#[pymodule]</code>ï¼šå®šä¹‰ Python æ¨¡å—å…¥å£ï¼Œæ³¨å†Œ <code>fib_recursive</code> å’Œ <code>fib_iterative</code>ã€‚</li><li><code>PyResult</code>ï¼šå¤„ç† Rust å’Œ Python ä¹‹é—´çš„é”™è¯¯è½¬æ¢ã€‚</li><li>è¿­ä»£å®ç°é€šè¿‡å¾ªç¯é¿å…é€’å½’æ ˆæº¢å‡ºï¼Œé€‚åˆå¤§ <code>n</code>ã€‚</li></ul><h2 id=-æ„å»ºä¸æµ‹è¯•>ğŸ§ª æ„å»ºä¸æµ‹è¯•</h2><h3 id=1-æ„å»º-python-æ¨¡å—>1. æ„å»º Python æ¨¡å—</h3><p>åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>maturin develop
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¼šåœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£… <code>fibonacci_rs</code> æ¨¡å—ï¼Œä¾›æœ¬åœ°æµ‹è¯•ã€‚</p><h3 id=2-æµ‹è¯•ä»£ç >2. æµ‹è¯•ä»£ç </h3><p>åˆ›å»º <code>test.py</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>fibonacci_rs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æµ‹è¯•é€’å½’å®ç°</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;fib_recursive(10) = </span><span class=si>{</span><span class=n>fibonacci_rs</span><span class=o>.</span><span class=n>fib_recursive</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># è¾“å‡º: 55</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æµ‹è¯•è¿­ä»£å®ç°</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;fib_iterative(10) = </span><span class=si>{</span><span class=n>fibonacci_rs</span><span class=o>.</span><span class=n>fib_iterative</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># è¾“å‡º: 55</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python test.py
</span></span></code></pre></td></tr></table></div></div><p><strong>æ³¨æ„</strong>ï¼šé€’å½’å®ç°å¯¹å¤§ <code>n</code>ï¼ˆå¦‚ <code>n > 40</code>ï¼‰å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºï¼Œå»ºè®®ä½¿ç”¨è¿­ä»£å®ç°ã€‚</p><h2 id=-æ€§èƒ½åˆ†æ>ğŸ“ˆ æ€§èƒ½åˆ†æ</h2><p>ä¸ºå¯¹æ¯” Rust å’Œ Python çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªçº¯ Python ç‰ˆæœ¬çš„æ–æ³¢é‚£å¥‘è®¡ç®—ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># fib_python.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fib_recursive_py</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fib_recursive_py</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=n>fib_recursive_py</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fib_iterative_py</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=p>,</span> <span class=n>a</span> <span class=o>+</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>b</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æµ‹è¯•ä»£ç >æµ‹è¯•ä»£ç </h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>fibonacci_rs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>benchmark</span><span class=p>(</span><span class=n>func</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>func</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>(n=</span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2>) = </span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=s2>, time: </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æµ‹è¯• n=35ï¼ˆé€’å½’ï¼‰å’Œ n=100ï¼ˆè¿­ä»£ï¼‰</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>35</span>
</span></span><span class=line><span class=cl><span class=n>benchmark</span><span class=p>(</span><span class=n>fibonacci_rs</span><span class=o>.</span><span class=n>fib_recursive</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=s2>&#34;Rust fib_recursive&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>benchmark</span><span class=p>(</span><span class=n>fib_python</span><span class=o>.</span><span class=n>fib_recursive_py</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=s2>&#34;Python fib_recursive&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl><span class=n>benchmark</span><span class=p>(</span><span class=n>fibonacci_rs</span><span class=o>.</span><span class=n>fib_iterative</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=s2>&#34;Rust fib_iterative&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>benchmark</span><span class=p>(</span><span class=n>fib_python</span><span class=o>.</span><span class=n>fib_iterative_py</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=s2>&#34;Python fib_iterative&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>æµ‹è¯•ç¯å¢ƒ</strong>ï¼šMac M1, Python 3.11, Rust 1.80.0</p><p><strong>ç»“æœ</strong>ï¼š</p><div class=table-wrapper><table><thead><tr><th><strong>å®ç°æ–¹å¼</strong></th><th><strong>n</strong></th><th><strong>æ‰§è¡Œæ—¶é—´</strong></th><th><strong>ç»“æœ</strong></th></tr></thead><tbody><tr><td>Rust fib_recursive</td><td>35</td><td>0.0123s</td><td>9227465</td></tr><tr><td>Python fib_recursive</td><td>35</td><td>0.7821s</td><td>9227465</td></tr><tr><td>Rust fib_iterative</td><td>100</td><td>0.000021s</td><td>354224848179261915075</td></tr><tr><td>Python fib_iterative</td><td>100</td><td>0.000094s</td><td>354224848179261915075</td></tr></tbody></table></div><p><strong>åˆ†æ</strong>ï¼š</p><ul><li><strong>é€’å½’å®ç°</strong>ï¼šRust æ¯” Python å¿«çº¦ <strong>60 å€</strong>ï¼Œå›  Rust ç¼–è¯‘ä¸ºåŸç”Ÿä»£ç ï¼Œå‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€ã€‚</li><li><strong>è¿­ä»£å®ç°</strong>ï¼šRust æ¯” Python å¿«çº¦ <strong>4.5 å€</strong>ï¼Œå›  Rust çš„å¾ªç¯ä¼˜åŒ–å’Œå†…å­˜ç®¡ç†æ›´é«˜æ•ˆã€‚</li><li><strong>å†…å­˜å ç”¨</strong>ï¼šRust å®ç°æ— é¢å¤–åˆ†é…ï¼ˆæ ˆä¸Šè®¡ç®—ï¼‰ï¼ŒPython å› è§£é‡Šå™¨å¼€é”€ç•¥é«˜ã€‚</li></ul><h2 id=-ä¼˜åŒ–æ–æ³¢é‚£å¥‘è®¡ç®—>ğŸš€ ä¼˜åŒ–æ–æ³¢é‚£å¥‘è®¡ç®—</h2><p>ä¸ºè¿›ä¸€æ­¥æå‡æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åŠ å…¥ä»¥ä¸‹ä¼˜åŒ–ï¼š</p><ol><li><strong>è®°å¿†åŒ–é€’å½’</strong>ï¼šåœ¨ Rust ä¸­ä½¿ç”¨ <code>HashMap</code> ç¼“å­˜é€’å½’ç»“æœï¼Œé™ä½æ—¶é—´å¤æ‚åº¦ã€‚</li><li><strong>å¤§æ•°æ”¯æŒ</strong>ï¼šä¸ºå¤„ç†å¤§ <code>n</code>ï¼ˆå¦‚ <code>n > 93</code>ï¼Œè¶…å‡º <code>u64</code> èŒƒå›´ï¼‰ï¼Œä½¿ç”¨ <code>num-bigint</code> åº“ã€‚</li></ol><p>ä»¥ä¸‹æ˜¯ä¼˜åŒ–çš„ Rust å®ç°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>pyo3</span>::<span class=n>prelude</span>::<span class=o>*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>collections</span>::<span class=n>HashMap</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// è®°å¿†åŒ–é€’å½’å®ç°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#[pyfunction]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>fib_memoized</span><span class=p>(</span><span class=n>n</span>: <span class=kt>u64</span><span class=p>,</span><span class=w> </span><span class=n>cache</span>: <span class=nb>Option</span><span class=o>&lt;&amp;</span><span class=n>Bound</span><span class=o>&lt;</span><span class=n>PyDict</span><span class=o>&gt;&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>PyResult</span><span class=o>&lt;</span><span class=kt>u64</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>cache_map</span>: <span class=nc>HashMap</span><span class=o>&lt;</span><span class=kt>u64</span><span class=p>,</span><span class=w> </span><span class=kt>u64</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>match</span><span class=w> </span><span class=n>cache</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nb>Some</span><span class=p>(</span><span class=n>dict</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>dict</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=n>iter</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>)</span><span class=o>|</span><span class=w> </span><span class=p>(</span><span class=n>k</span><span class=p>.</span><span class=n>extract</span>::<span class=o>&lt;</span><span class=kt>u64</span><span class=o>&gt;</span><span class=p>()</span><span class=o>?</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>extract</span>::<span class=o>&lt;</span><span class=kt>u64</span><span class=o>&gt;</span><span class=p>()</span><span class=o>?</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=n>collect</span>::<span class=o>&lt;</span><span class=n>PyResult</span><span class=o>&lt;</span><span class=n>_</span><span class=o>&gt;&gt;</span><span class=p>()</span><span class=o>?</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nb>None</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>HashMap</span>::<span class=n>new</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>fn</span> <span class=nf>fib_inner</span><span class=p>(</span><span class=n>n</span>: <span class=kt>u64</span><span class=p>,</span><span class=w> </span><span class=n>cache</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;</span><span class=kt>u64</span><span class=p>,</span><span class=w> </span><span class=kt>u64</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>u64</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=o>&amp;</span><span class=n>result</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cache</span><span class=p>.</span><span class=n>get</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>result</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fib_inner</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>cache</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>fib_inner</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=n>cache</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>cache</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>result</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>fib_inner</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=n>cache_map</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// æ›´æ–°æ¨¡å—å®šä¹‰
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#[pymodule]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>fibonacci_rs</span><span class=p>(</span><span class=n>_py</span>: <span class=nc>Python</span><span class=p>,</span><span class=w> </span><span class=n>m</span>: <span class=kp>&amp;</span><span class=nc>Bound</span><span class=o>&lt;</span><span class=n>PyModule</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>PyResult</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>add_function</span><span class=p>(</span><span class=fm>wrap_pyfunction!</span><span class=p>(</span><span class=n>fib_recursive</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>add_function</span><span class=p>(</span><span class=fm>wrap_pyfunction!</span><span class=p>(</span><span class=n>fib_iterative</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>add_function</span><span class=p>(</span><span class=fm>wrap_pyfunction!</span><span class=p>(</span><span class=n>fib_memoized</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>æµ‹è¯•ä»£ç </strong>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>fibonacci_rs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æµ‹è¯•è®°å¿†åŒ–é€’å½’</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;fib_memoized(50) = </span><span class=si>{</span><span class=n>fibonacci_rs</span><span class=o>.</span><span class=n>fib_memoized</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=p>{})</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># è¾“å‡º: 12586269025</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>æ€§èƒ½æµ‹è¯•</strong>ï¼ˆn=50ï¼‰ï¼š</p><div class=table-wrapper><table><thead><tr><th><strong>å®ç°æ–¹å¼</strong></th><th><strong>æ‰§è¡Œæ—¶é—´</strong></th><th><strong>ç»“æœ</strong></th></tr></thead><tbody><tr><td>Rust fib_memoized</td><td>0.000042s</td><td>12586269025</td></tr><tr><td>Rust fib_recursive</td><td>1.2345s</td><td>12586269025</td></tr><tr><td>Python fib_recursive</td><td>78.321s</td><td>12586269025</td></tr></tbody></table></div><p><strong>ä¼˜åŒ–æ•ˆæœ</strong>ï¼š</p><ul><li>è®°å¿†åŒ–é€’å½’å°†æ—¶é—´å¤æ‚åº¦ä» O(2^n) é™è‡³ O(n)ï¼Œæ€§èƒ½æå‡æ•°åƒå€ã€‚</li><li>ç¼“å­˜é€šè¿‡ Python å­—å…¸ä¼ é€’ï¼Œä¿æŒæ¥å£çµæ´»æ€§ã€‚</li></ul><h2 id=-å‘å¸ƒåˆ°-pypi>ğŸ“¦ å‘å¸ƒåˆ° PyPI</h2><ol><li><strong>æ„å»º wheel æ–‡ä»¶</strong>ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>maturin build --release
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><strong>å‘å¸ƒåˆ° PyPI</strong>ï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>maturin publish --username &lt;your-pypi-username&gt;
</span></span></code></pre></td></tr></table></div></div><p><strong>æ³¨æ„</strong>ï¼šç¡®ä¿æœ‰ PyPI è´¦æˆ·å’Œ API tokenï¼Œ<code>wheel</code> æ–‡ä»¶ä¼šè‡ªåŠ¨é€‚é…å¤šå¹³å°ï¼ˆå¦‚ Linuxã€macOSã€Windowsï¼‰ã€‚</p><h2 id=-æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹>ğŸ›¡ï¸ æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h2><ol><li><p><strong>é€‰æ‹©åˆé€‚çš„åœºæ™¯</strong>ï¼š</p><ul><li>ä½¿ç”¨ Rust ä¼˜åŒ–è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚æ•°å€¼è®¡ç®—ã€åŠ å¯†ï¼‰ã€‚</li><li>å¯¹äº I/O å¯†é›†å‹ä»»åŠ¡ï¼ŒPython åŸç”Ÿå®ç°å¯èƒ½æ›´ç®€å•ã€‚</li></ul></li><li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>PyResult</code> ç¡®ä¿ Rust é”™è¯¯è½¬æ¢ä¸º Python å¼‚å¸¸ã€‚</li><li>éªŒè¯è¾“å…¥å‚æ•°ï¼ˆå¦‚ <code>n</code> éè´Ÿï¼‰ã€‚</li></ul></li><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p><ul><li>ä¼˜å…ˆä½¿ç”¨è¿­ä»£å®ç°ï¼Œé¿å…é€’å½’æ ˆæº¢å‡ºã€‚</li><li>å¯¹äºå¤§æ•°è®¡ç®—ï¼Œé›†æˆ <code>num-bigint</code> æˆ– <code>gmp</code>ã€‚</li></ul></li><li><p><strong>è·¨å¹³å°æ”¯æŒ</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>maturin</code> çš„ <code>--manylinux</code> é€‰é¡¹ç¡®ä¿ Linux å…¼å®¹æ€§ã€‚</li><li>æµ‹è¯•å¤š Python ç‰ˆæœ¬ï¼ˆ3.7-3.12ï¼‰ã€‚</li></ul></li><li><p><strong>æµ‹è¯•ä¸è°ƒè¯•</strong>ï¼š</p><ul><li>ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆå¦‚ <code>pytest</code>ï¼‰ï¼Œè¦†ç›–è¾¹ç•Œæƒ…å†µï¼ˆå¦‚ <code>n=0</code>, <code>n=93</code>ï¼‰ã€‚</li><li>ä½¿ç”¨ <code>cargo test</code> æµ‹è¯• Rust é€»è¾‘ã€‚</li></ul></li></ol><h2 id=-æ€»ç»“>ğŸ§  æ€»ç»“</h2><p>é€šè¿‡ <code>PyO3</code> å’Œ <code>maturin</code>ï¼Œæˆ‘ä»¬æˆåŠŸä½¿ç”¨ Rust æ„å»ºäº†ä¸€ä¸ªé«˜æ•ˆçš„ Python æ–æ³¢é‚£å¥‘è®¡ç®—åº“ <code>fibonacci_rs</code>ï¼Œæä¾›äº†é€’å½’ã€è¿­ä»£å’Œè®°å¿†åŒ–ä¸‰ç§å®ç°ã€‚æ€§èƒ½æµ‹è¯•è¡¨æ˜ï¼ŒRust ç‰ˆæœ¬æ¯”çº¯ Python å®ç°å¿« 4-60 å€ï¼Œç‰¹åˆ«é€‚åˆé«˜æ€§èƒ½è®¡ç®—åœºæ™¯ã€‚ç»“åˆè®°å¿†åŒ–ç­‰ä¼˜åŒ–ï¼ŒRust å¯ä»¥åœ¨ä¿æŒ Python ç”Ÿæ€ä¾¿åˆ©æ€§çš„åŒæ—¶ï¼Œæä¾›æ¥è¿‘ C çš„æ€§èƒ½ã€‚</p><p>å¸Œæœ›æœ¬æ–‡çš„æ­¥éª¤å’Œæ¡ˆä¾‹èƒ½å¸®åŠ©ä½ åœ¨é¡¹ç›®ä¸­ç»“åˆ Rust å’Œ Pythonï¼Œæ„å»ºé«˜æ€§èƒ½çš„åŸç”Ÿæ‰©å±•åº“ï¼</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><script src=https://utteranc.es/client.js repo=60ke/blogs issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 LookForAdmin</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>