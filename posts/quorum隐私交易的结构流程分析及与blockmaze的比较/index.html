<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="BlockMaze隐私交易 定义 BlockMaze，一种基于 zk-SNARKs 的高效隐私保护账户模型区块链。与双余额模型一起，BlockMaze 通过隐藏账户余额、交易金额以及发送者和接收者之间的联系来实现强大的隐私保证。BlockMaze是基于 Libsnark 和 Go-Ethereum 实现的。
实现原理及交易流程 一、实现原理 blockmaze隐私交易的实现为在账户下添加cmt(commitment)用于存储密文余额，发送交易时使用接受者的公钥加密且不指定接受者的地址，但是在链下告诉接受者该交易的hash，同时减去自己对应的密文余额。接受者通过交易hash获取对应的交易信息，同时通过私钥解密转账的金额，然后加上自己对应的密文余额。(相当于隐私交易的转账金额存到了隐私交易里面)。 二、交易流程 ![[20220714192452.jpg]] 1.节点A执行Mint操作，转化零知识余额到自己的账户中 2.节点B执行getPubKeyRLP()根据其账户地址获取其公钥，线下告诉节点A， 3.节点A执行Send操作进行转账，并更新自己的零知识余额，其中pubkey为接收方(节点B)的公钥,线下告诉节点B 交易SendTransaction的hash 4.节点B通过节点A产生的send交易的hash执行Deposit操作 5.节点A执行Redeem操作，转化明文余额到自己的账户中
Quorum隐私交易 定义 隐私是指在相关参与者之间保持交易私密的能力。其他参与者无法访问交易内容。
实现原理及交易流程 一、实现原理 quorum通过一个名为Tessera 的隐私交易管理器来管理隐私交易。发送者将原有的交易payload用key替代(key为Tessera对该payload加密生成的)，隐私交易的接收方通过Tessera获取key对应的原始交易payload。如果该交易为合约调用交易，非接收方的账户跳过该交易的执行，接收方则通过Tessera还原payload并调用虚拟机执行然后更新存储。同时为了避免因此带来的状态不一致，隐私交易和公共交易存储的树是用不同的树分开存储的。
状态验证：块验证包括检查公共状态树的根以确定公共状态是否跨节点同步。它还包括检查全局交易哈希，这是一个区块中所有公共和私人交易的哈希。这意味着每个节点都可以验证它与其他节点具有相同的交易集。公共状态根和私有交易输入的同步（通过全局交易哈希）意味着参与节点之间私有状态的同步。进一步验证如果私有交易的私有状态变化在所有参与者中是相同的，可使eth_storageRoot 指定私有智能合约地址和区块高度。如果状态在所有参与节点之间同步，则它们返回相同的根哈希。
限制: 隐私合约交易在与公共合约交易进行数据交互时，隐私合约交易智能读取公共存储的状态，而不能写入(一旦写入会造成隐私交易接收者和非接受者数据不一致的情况)
二、交易流程 (1) 一般隐私交易 ![[Pasted image 20220722165506.png]]
参与者 A 向其 GoQuorum 节点 A 发送私人交易。
GoQuorum 将私有交易data值序列化为 JSON，并将其与参与者详细信息一起发送到 Tessera 节点 A。
Tessera 加密data并分发给交易参与者。
Tessera 将加密的哈希返回data给 GoQuorum 节点 A。GoQuorum 用data哈希替换私有交易值。GoQuorum 签署私人交易并将其设置v为37或38将交易标记为私人交易。
GoQuorum 在整个网络中分发私人交易。
所有节点都可以看到交易。只有交易参与者（参与者 A 和 B）才能从 Tessera 获取解密数据并执行交易。 (2) 隐私标记交易 !"><title>Quorum隐私交易的结构流程分析及与BlockMaze的比较</title><link rel=canonical href=https://60ke.github.io/posts/quorum%E9%9A%90%E7%A7%81%E4%BA%A4%E6%98%93%E7%9A%84%E7%BB%93%E6%9E%84%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90%E5%8F%8A%E4%B8%8Eblockmaze%E7%9A%84%E6%AF%94%E8%BE%83/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="Quorum隐私交易的结构流程分析及与BlockMaze的比较"><meta property="og:description" content="BlockMaze隐私交易 定义 BlockMaze，一种基于 zk-SNARKs 的高效隐私保护账户模型区块链。与双余额模型一起，BlockMaze 通过隐藏账户余额、交易金额以及发送者和接收者之间的联系来实现强大的隐私保证。BlockMaze是基于 Libsnark 和 Go-Ethereum 实现的。
实现原理及交易流程 一、实现原理 blockmaze隐私交易的实现为在账户下添加cmt(commitment)用于存储密文余额，发送交易时使用接受者的公钥加密且不指定接受者的地址，但是在链下告诉接受者该交易的hash，同时减去自己对应的密文余额。接受者通过交易hash获取对应的交易信息，同时通过私钥解密转账的金额，然后加上自己对应的密文余额。(相当于隐私交易的转账金额存到了隐私交易里面)。 二、交易流程 ![[20220714192452.jpg]] 1.节点A执行Mint操作，转化零知识余额到自己的账户中 2.节点B执行getPubKeyRLP()根据其账户地址获取其公钥，线下告诉节点A， 3.节点A执行Send操作进行转账，并更新自己的零知识余额，其中pubkey为接收方(节点B)的公钥,线下告诉节点B 交易SendTransaction的hash 4.节点B通过节点A产生的send交易的hash执行Deposit操作 5.节点A执行Redeem操作，转化明文余额到自己的账户中
Quorum隐私交易 定义 隐私是指在相关参与者之间保持交易私密的能力。其他参与者无法访问交易内容。
实现原理及交易流程 一、实现原理 quorum通过一个名为Tessera 的隐私交易管理器来管理隐私交易。发送者将原有的交易payload用key替代(key为Tessera对该payload加密生成的)，隐私交易的接收方通过Tessera获取key对应的原始交易payload。如果该交易为合约调用交易，非接收方的账户跳过该交易的执行，接收方则通过Tessera还原payload并调用虚拟机执行然后更新存储。同时为了避免因此带来的状态不一致，隐私交易和公共交易存储的树是用不同的树分开存储的。
状态验证：块验证包括检查公共状态树的根以确定公共状态是否跨节点同步。它还包括检查全局交易哈希，这是一个区块中所有公共和私人交易的哈希。这意味着每个节点都可以验证它与其他节点具有相同的交易集。公共状态根和私有交易输入的同步（通过全局交易哈希）意味着参与节点之间私有状态的同步。进一步验证如果私有交易的私有状态变化在所有参与者中是相同的，可使eth_storageRoot 指定私有智能合约地址和区块高度。如果状态在所有参与节点之间同步，则它们返回相同的根哈希。
限制: 隐私合约交易在与公共合约交易进行数据交互时，隐私合约交易智能读取公共存储的状态，而不能写入(一旦写入会造成隐私交易接收者和非接受者数据不一致的情况)
二、交易流程 (1) 一般隐私交易 ![[Pasted image 20220722165506.png]]
参与者 A 向其 GoQuorum 节点 A 发送私人交易。
GoQuorum 将私有交易data值序列化为 JSON，并将其与参与者详细信息一起发送到 Tessera 节点 A。
Tessera 加密data并分发给交易参与者。
Tessera 将加密的哈希返回data给 GoQuorum 节点 A。GoQuorum 用data哈希替换私有交易值。GoQuorum 签署私人交易并将其设置v为37或38将交易标记为私人交易。
GoQuorum 在整个网络中分发私人交易。
所有节点都可以看到交易。只有交易参与者（参与者 A 和 B）才能从 Tessera 获取解密数据并执行交易。 (2) 隐私标记交易 !"><meta property="og:url" content="https://60ke.github.io/posts/quorum%E9%9A%90%E7%A7%81%E4%BA%A4%E6%98%93%E7%9A%84%E7%BB%93%E6%9E%84%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90%E5%8F%8A%E4%B8%8Eblockmaze%E7%9A%84%E6%AF%94%E8%BE%83/"><meta property="og:site_name" content="LookForAdmin"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:published_time" content="2022-08-24T19:56:44+08:00"><meta property="article:modified_time" content="2022-08-24T19:56:44+08:00"><meta name=twitter:title content="Quorum隐私交易的结构流程分析及与BlockMaze的比较"><meta name=twitter:description content="BlockMaze隐私交易 定义 BlockMaze，一种基于 zk-SNARKs 的高效隐私保护账户模型区块链。与双余额模型一起，BlockMaze 通过隐藏账户余额、交易金额以及发送者和接收者之间的联系来实现强大的隐私保证。BlockMaze是基于 Libsnark 和 Go-Ethereum 实现的。
实现原理及交易流程 一、实现原理 blockmaze隐私交易的实现为在账户下添加cmt(commitment)用于存储密文余额，发送交易时使用接受者的公钥加密且不指定接受者的地址，但是在链下告诉接受者该交易的hash，同时减去自己对应的密文余额。接受者通过交易hash获取对应的交易信息，同时通过私钥解密转账的金额，然后加上自己对应的密文余额。(相当于隐私交易的转账金额存到了隐私交易里面)。 二、交易流程 ![[20220714192452.jpg]] 1.节点A执行Mint操作，转化零知识余额到自己的账户中 2.节点B执行getPubKeyRLP()根据其账户地址获取其公钥，线下告诉节点A， 3.节点A执行Send操作进行转账，并更新自己的零知识余额，其中pubkey为接收方(节点B)的公钥,线下告诉节点B 交易SendTransaction的hash 4.节点B通过节点A产生的send交易的hash执行Deposit操作 5.节点A执行Redeem操作，转化明文余额到自己的账户中
Quorum隐私交易 定义 隐私是指在相关参与者之间保持交易私密的能力。其他参与者无法访问交易内容。
实现原理及交易流程 一、实现原理 quorum通过一个名为Tessera 的隐私交易管理器来管理隐私交易。发送者将原有的交易payload用key替代(key为Tessera对该payload加密生成的)，隐私交易的接收方通过Tessera获取key对应的原始交易payload。如果该交易为合约调用交易，非接收方的账户跳过该交易的执行，接收方则通过Tessera还原payload并调用虚拟机执行然后更新存储。同时为了避免因此带来的状态不一致，隐私交易和公共交易存储的树是用不同的树分开存储的。
状态验证：块验证包括检查公共状态树的根以确定公共状态是否跨节点同步。它还包括检查全局交易哈希，这是一个区块中所有公共和私人交易的哈希。这意味着每个节点都可以验证它与其他节点具有相同的交易集。公共状态根和私有交易输入的同步（通过全局交易哈希）意味着参与节点之间私有状态的同步。进一步验证如果私有交易的私有状态变化在所有参与者中是相同的，可使eth_storageRoot 指定私有智能合约地址和区块高度。如果状态在所有参与节点之间同步，则它们返回相同的根哈希。
限制: 隐私合约交易在与公共合约交易进行数据交互时，隐私合约交易智能读取公共存储的状态，而不能写入(一旦写入会造成隐私交易接收者和非接受者数据不一致的情况)
二、交易流程 (1) 一般隐私交易 ![[Pasted image 20220722165506.png]]
参与者 A 向其 GoQuorum 节点 A 发送私人交易。
GoQuorum 将私有交易data值序列化为 JSON，并将其与参与者详细信息一起发送到 Tessera 节点 A。
Tessera 加密data并分发给交易参与者。
Tessera 将加密的哈希返回data给 GoQuorum 节点 A。GoQuorum 用data哈希替换私有交易值。GoQuorum 签署私人交易并将其设置v为37或38将交易标记为私人交易。
GoQuorum 在整个网络中分发私人交易。
所有节点都可以看到交易。只有交易参与者（参与者 A 和 B）才能从 Tessera 获取解密数据并执行交易。 (2) 隐私标记交易 !"><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/Avatar.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LookForAdmin</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=social-menu><li><a href=https://github.com/60ke target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/posts target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/drafts><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>草稿箱</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>about</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#定义>定义</a><ol><li><a href=#实现原理及交易流程>实现原理及交易流程</a></li></ol></li><li><a href=#quorum隐私交易>Quorum隐私交易</a><ol><li><a href=#定义-1>定义</a></li><li><a href=#实现原理及交易流程-1>实现原理及交易流程</a></li></ol></li><li><a href=#结论>结论</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/posts/quorum%E9%9A%90%E7%A7%81%E4%BA%A4%E6%98%93%E7%9A%84%E7%BB%93%E6%9E%84%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90%E5%8F%8A%E4%B8%8Eblockmaze%E7%9A%84%E6%AF%94%E8%BE%83/>Quorum隐私交易的结构流程分析及与BlockMaze的比较</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Aug 24, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 1 分钟</time></div></footer></div></header><section class=article-content><h1 id=blockmaze隐私交易>BlockMaze隐私交易</h1><h2 id=定义>定义</h2><p>BlockMaze，一种基于 zk-SNARKs 的高效隐私保护账户模型区块链。与双余额模型一起，BlockMaze 通过隐藏账户余额、交易金额以及发送者和接收者之间的联系来实现强大的隐私保证。BlockMaze是基于 Libsnark 和 Go-Ethereum 实现的。</p><h3 id=实现原理及交易流程>实现原理及交易流程</h3><p>一、实现原理
blockmaze隐私交易的实现为在账户下添加<code>cmt</code>(commitment)用于存储密文余额，发送交易时使用接受者的公钥加密且不指定接受者的地址，但是在链下告诉接受者该交易的<code>hash</code>，同时减去自己对应的密文余额。接受者通过交易hash获取对应的交易信息，同时通过私钥解密转账的金额，然后加上自己对应的密文余额。(相当于隐私交易的转账金额存到了隐私交易里面)。
二、交易流程
![[20220714192452.jpg]]
1.节点A执行Mint操作，转化零知识余额到自己的账户中
2.节点B执行getPubKeyRLP()根据其账户地址获取其公钥，线下告诉节点A，
3.节点A执行Send操作进行转账，并更新自己的零知识余额，其中pubkey为接收方(节点B)的公钥,线下告诉节点B 交易SendTransaction的hash
4.节点B通过节点A产生的send交易的hash执行Deposit操作
5.节点A执行Redeem操作，转化明文余额到自己的账户中</p><h2 id=quorum隐私交易>Quorum隐私交易</h2><h3 id=定义-1>定义</h3><p>隐私是指在相关参与者之间保持交易私密的能力。其他参与者无法访问交易内容。</p><h3 id=实现原理及交易流程-1>实现原理及交易流程</h3><p>一、实现原理
quorum通过一个名为<a class=link href=https://docs.tessera.consensys.net target=_blank rel=noopener>Tessera</a> 的隐私交易管理器来管理隐私交易。发送者将原有的交易payload用key替代(key为Tessera对该payload加密生成的)，隐私交易的接收方通过Tessera获取key对应的原始交易payload。如果该交易为合约调用交易，非接收方的账户跳过该交易的执行，接收方则通过Tessera还原payload并调用虚拟机执行然后更新存储。同时为了避免因此带来的状态不一致，隐私交易和公共交易存储的树是用不同的树分开存储的。</p><p>状态验证：块验证包括检查公共状态树的根以确定公共状态是否跨节点同步。它还包括检查全局交易哈希，这是一个区块中所有公共和私人交易的哈希。这意味着每个节点都可以验证它与其他节点具有相同的交易集。公共状态根和私有交易输入的同步（通过全局交易哈希）意味着参与节点之间私有状态的同步。进一步验证如果私有交易的私有状态变化在所有参与者中是相同的，可使<code>eth_storageRoot</code> 指定私有智能合约地址和区块高度。如果状态在所有参与节点之间同步，则它们返回相同的根哈希。</p><p>限制:
隐私合约交易在与公共合约交易进行数据交互时，隐私合约交易智能读取公共存储的状态，而不能写入(一旦写入会造成隐私交易接收者和非接受者数据不一致的情况)</p><p>二、交易流程
(1) 一般隐私交易
![[Pasted image 20220722165506.png]]</p><ol><li><p>参与者 A 向其 GoQuorum 节点 A 发送私人交易。</p></li><li><p>GoQuorum 将私有交易<code>data</code>值序列化为 JSON，并将其与参与者详细信息一起发送到 Tessera 节点 A。</p></li><li><p>Tessera 加密<code>data</code>并分发给交易参与者。</p></li><li><p>Tessera 将加密的哈希返回<code>data</code>给 GoQuorum 节点 A。GoQuorum 用<code>data</code>哈希替换私有交易值。GoQuorum 签署私人交易并将其设置<code>v</code>为<code>37</code>或<code>38</code>将交易标记为私人交易。</p></li><li><p>GoQuorum 在整个网络中分发私人交易。</p></li><li><p>所有节点都可以看到交易。只有交易参与者（参与者 A 和 B）才能从 Tessera 获取解密数据并执行交易。
(2) 隐私标记交易
![[Pasted image 20220722165642.png]]</p></li><li><p>参与者 A 向其 GoQuorum 节点 A 发送私人交易。</p></li><li><p>GoQuorum 将私有交易<code>data</code>值序列化为 JSON，并将其与参与者详细信息一起发送到 Tessera 节点 A。</p></li><li><p>Tessera 加密<code>data</code>并分发给交易参与者。</p></li><li><p>Tessera 将加密的哈希返回<code>data</code>给 GoQuorum 节点 A。GoQuorum 创建一个公共 PMT，并将<code>data</code>字段设置为哈希。GoQuorum 签署 PMT。</p></li><li><p>GoQuorum 在整个网络中分发 PMT。所有节点都可以看到 PMT。</p><p>PMT 的处理方式与标准公共交易相同。由于 PMT 的<code>to</code>值是隐私预编译合约的地址，因此该合约被调用。</p></li><li><p>GoQuorum 节点 B 和 C 使用 PMT 调用隐私预编译<code>data</code>。</p></li><li><p>GoQuorum 尝试使用来自 PMT 的公开可用哈希从 Tessera 检索解密的私人交易。</p></li><li><p>动作取决于节点是否是事务参与者：</p><ol><li><p>参与者：GoQuorum<code>data</code>从 Tessera 获取隐私交易的解密信息，隐私预编译执行隐私交易。</p></li><li><p>非参与者：没有找到隐私交易，所以隐私预编译立即返回。
(3) 有关零知识证明的隐私交易
<a class=link href=https://github.com/ConsenSys/anonymous-zether target=_blank rel=noopener>https://github.com/ConsenSys/anonymous-zether</a> 是在quorum基础上基于zether实现的零知识证明的隐私交易。</p></li></ol></li></ol><h2 id=结论>结论</h2><p>BlockMaze通过在原有的以太坊账户模型中添加一个用于存储隐私金额的密文字段，然后通过隐私交易对账户的密文余额进行操作，BlockMaze仅支持转账之间的金额隐私交易，不涉及有关智能合约的执行。BlockMaz零知识证明采用zk-snark。BlockMaze宣称的隐藏交易双方的对应关系是通过一次性构建多笔交易，这些交易存在多个发送方和接收方从而模糊发送者和接受者的对应关系。但其仅支持转账类型的隐私交易，不过其结构设计较为简单，但是其代码长期未更新，项目整体更像是一个demo，没见在实际中的应用，其方案可能存在许多隐藏问题。</p><p>quorum也是基于账户模型开发的，而且支持所有类型的隐私交易(转账交易与合约交易)，其方案考虑的比较完善且代码更新活跃，文档完善，不过其结构设计相对BlockMaze更为复杂，但结构比较清晰。</p><p>总的来说quorum能够实现更为完善的隐私交易，具备多种共识方案的切换(其链本身的特性)，同时其项目也在实际中广泛应用，能够提供更为完备的解决方案。</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><script src=https://utteranc.es/client.js repo=60ke/blogs issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 LookForAdmin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>