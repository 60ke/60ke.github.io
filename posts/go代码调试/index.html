<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Goç›®å‰æ”¯æŒGDB,LLDB,Delveç­‰è°ƒè¯•å·¥å…·.å®˜æ–¹å‡ºäº†GDBè°ƒè¯•æ•™ç¨‹ä½†æ˜¯å®˜æ–¹æ›´æ¨èDelve(âŠ™ËâŠ™)
Delveæ–‡æ¡£ Delveå®˜æ–¹æ–‡æ¡£
goè¯­è¨€é«˜çº§ç¼–ç¨‹ä¹‹Delveè°ƒè¯• ä¸ºé¿å…å¤±è”,å°†ä¸­æ–‡æ–‡æ¡£æ‘˜æŠ„
3.9 Delve è°ƒè¯•å™¨ ç›®å‰ Go è¯­è¨€æ”¯æŒ GDBã€LLDB å’Œ Delve å‡ ç§è°ƒè¯•å™¨ã€‚å…¶ä¸­ GDB æ˜¯æœ€æ—©æ”¯æŒçš„è°ƒè¯•å·¥&amp;gt;å…·ï¼ŒLLDB æ˜¯ macOS ç³»ç»Ÿæ¨èçš„æ ‡å‡†è°ƒè¯•å·¥å…·ã€‚ä½†æ˜¯ GDB å’Œ LLDB å¯¹ Go è¯­è¨€çš„ä¸“æœ‰&amp;gt;ç‰¹æ€§éƒ½ç¼ºä¹å¾ˆå¤§æ”¯æŒï¼Œè€Œåªæœ‰ Delve æ˜¯ä¸“é—¨ä¸º Go è¯­è¨€è®¾è®¡å¼€å‘çš„è°ƒè¯•å·¥å…·ã€‚è€Œä¸” &amp;gt;Delve æœ¬èº«ä¹Ÿæ˜¯é‡‡ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå¯¹ Windows å¹³å°ä¹Ÿæä¾›äº†ä¸€æ ·çš„æ”¯æŒã€‚æœ¬èŠ‚æˆ‘ä»¬&amp;gt;åŸºäº Delve ç®€å•è§£é‡Šå¦‚ä½•è°ƒè¯• Go æ±‡ç¼–ç¨‹åºã€‚
3.9.1 Delve å…¥é—¨ é¦–å…ˆæ ¹æ®å®˜æ–¹çš„æ–‡æ¡£æ­£ç¡®å®‰è£… Delve è°ƒè¯•å™¨ã€‚æˆ‘ä»¬ä¼šå…ˆæ„é€ ä¸€ä¸ªç®€å•çš„ Go è¯­è¨€ä»£ç ï¼Œ&amp;gt;ç”¨äºç†Ÿæ‚‰ä¸‹ Delve çš„ç®€å•ç”¨æ³•ã€‚
åˆ›å»º main.go æ–‡ä»¶ï¼Œmain å‡½æ•°å…ˆé€šè¿‡å¾ªåˆå§‹åŒ–ä¸€ä¸ªåˆ‡ç‰‡ï¼Œç„¶åè¾“å‡ºåˆ‡ç‰‡çš„å†…å®¹ï¼š
1 2 3 4 5 6 7 8 9 10 11 12 13 package main import ( &amp;#34;fmt&amp;#34; ) func main() { nums := make([]int, 5) for i := 0; i &amp;lt;len(nums); i++ { nums[i] = i * i } fmt."><title>goä»£ç è°ƒè¯•</title><link rel=canonical href=https://60ke.github.io/posts/go%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="goä»£ç è°ƒè¯•"><meta property="og:description" content="Goç›®å‰æ”¯æŒGDB,LLDB,Delveç­‰è°ƒè¯•å·¥å…·.å®˜æ–¹å‡ºäº†GDBè°ƒè¯•æ•™ç¨‹ä½†æ˜¯å®˜æ–¹æ›´æ¨èDelve(âŠ™ËâŠ™)
Delveæ–‡æ¡£ Delveå®˜æ–¹æ–‡æ¡£
goè¯­è¨€é«˜çº§ç¼–ç¨‹ä¹‹Delveè°ƒè¯• ä¸ºé¿å…å¤±è”,å°†ä¸­æ–‡æ–‡æ¡£æ‘˜æŠ„
3.9 Delve è°ƒè¯•å™¨ ç›®å‰ Go è¯­è¨€æ”¯æŒ GDBã€LLDB å’Œ Delve å‡ ç§è°ƒè¯•å™¨ã€‚å…¶ä¸­ GDB æ˜¯æœ€æ—©æ”¯æŒçš„è°ƒè¯•å·¥&amp;gt;å…·ï¼ŒLLDB æ˜¯ macOS ç³»ç»Ÿæ¨èçš„æ ‡å‡†è°ƒè¯•å·¥å…·ã€‚ä½†æ˜¯ GDB å’Œ LLDB å¯¹ Go è¯­è¨€çš„ä¸“æœ‰&amp;gt;ç‰¹æ€§éƒ½ç¼ºä¹å¾ˆå¤§æ”¯æŒï¼Œè€Œåªæœ‰ Delve æ˜¯ä¸“é—¨ä¸º Go è¯­è¨€è®¾è®¡å¼€å‘çš„è°ƒè¯•å·¥å…·ã€‚è€Œä¸” &amp;gt;Delve æœ¬èº«ä¹Ÿæ˜¯é‡‡ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå¯¹ Windows å¹³å°ä¹Ÿæä¾›äº†ä¸€æ ·çš„æ”¯æŒã€‚æœ¬èŠ‚æˆ‘ä»¬&amp;gt;åŸºäº Delve ç®€å•è§£é‡Šå¦‚ä½•è°ƒè¯• Go æ±‡ç¼–ç¨‹åºã€‚
3.9.1 Delve å…¥é—¨ é¦–å…ˆæ ¹æ®å®˜æ–¹çš„æ–‡æ¡£æ­£ç¡®å®‰è£… Delve è°ƒè¯•å™¨ã€‚æˆ‘ä»¬ä¼šå…ˆæ„é€ ä¸€ä¸ªç®€å•çš„ Go è¯­è¨€ä»£ç ï¼Œ&amp;gt;ç”¨äºç†Ÿæ‚‰ä¸‹ Delve çš„ç®€å•ç”¨æ³•ã€‚
åˆ›å»º main.go æ–‡ä»¶ï¼Œmain å‡½æ•°å…ˆé€šè¿‡å¾ªåˆå§‹åŒ–ä¸€ä¸ªåˆ‡ç‰‡ï¼Œç„¶åè¾“å‡ºåˆ‡ç‰‡çš„å†…å®¹ï¼š
1 2 3 4 5 6 7 8 9 10 11 12 13 package main import ( &amp;#34;fmt&amp;#34; ) func main() { nums := make([]int, 5) for i := 0; i &amp;lt;len(nums); i++ { nums[i] = i * i } fmt."><meta property="og:url" content="https://60ke.github.io/posts/go%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95/"><meta property="og:site_name" content="LookForAdmin"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="Go"><meta property="article:tag" content="dlv"><meta property="article:tag" content="debug"><meta property="article:tag" content="ebpf"><meta property="article:published_time" content="2023-03-09T10:54:32+08:00"><meta property="article:modified_time" content="2023-03-09T10:54:32+08:00"><meta name=twitter:title content="goä»£ç è°ƒè¯•"><meta name=twitter:description content="Goç›®å‰æ”¯æŒGDB,LLDB,Delveç­‰è°ƒè¯•å·¥å…·.å®˜æ–¹å‡ºäº†GDBè°ƒè¯•æ•™ç¨‹ä½†æ˜¯å®˜æ–¹æ›´æ¨èDelve(âŠ™ËâŠ™)
Delveæ–‡æ¡£ Delveå®˜æ–¹æ–‡æ¡£
goè¯­è¨€é«˜çº§ç¼–ç¨‹ä¹‹Delveè°ƒè¯• ä¸ºé¿å…å¤±è”,å°†ä¸­æ–‡æ–‡æ¡£æ‘˜æŠ„
3.9 Delve è°ƒè¯•å™¨ ç›®å‰ Go è¯­è¨€æ”¯æŒ GDBã€LLDB å’Œ Delve å‡ ç§è°ƒè¯•å™¨ã€‚å…¶ä¸­ GDB æ˜¯æœ€æ—©æ”¯æŒçš„è°ƒè¯•å·¥&amp;gt;å…·ï¼ŒLLDB æ˜¯ macOS ç³»ç»Ÿæ¨èçš„æ ‡å‡†è°ƒè¯•å·¥å…·ã€‚ä½†æ˜¯ GDB å’Œ LLDB å¯¹ Go è¯­è¨€çš„ä¸“æœ‰&amp;gt;ç‰¹æ€§éƒ½ç¼ºä¹å¾ˆå¤§æ”¯æŒï¼Œè€Œåªæœ‰ Delve æ˜¯ä¸“é—¨ä¸º Go è¯­è¨€è®¾è®¡å¼€å‘çš„è°ƒè¯•å·¥å…·ã€‚è€Œä¸” &amp;gt;Delve æœ¬èº«ä¹Ÿæ˜¯é‡‡ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå¯¹ Windows å¹³å°ä¹Ÿæä¾›äº†ä¸€æ ·çš„æ”¯æŒã€‚æœ¬èŠ‚æˆ‘ä»¬&amp;gt;åŸºäº Delve ç®€å•è§£é‡Šå¦‚ä½•è°ƒè¯• Go æ±‡ç¼–ç¨‹åºã€‚
3.9.1 Delve å…¥é—¨ é¦–å…ˆæ ¹æ®å®˜æ–¹çš„æ–‡æ¡£æ­£ç¡®å®‰è£… Delve è°ƒè¯•å™¨ã€‚æˆ‘ä»¬ä¼šå…ˆæ„é€ ä¸€ä¸ªç®€å•çš„ Go è¯­è¨€ä»£ç ï¼Œ&amp;gt;ç”¨äºç†Ÿæ‚‰ä¸‹ Delve çš„ç®€å•ç”¨æ³•ã€‚
åˆ›å»º main.go æ–‡ä»¶ï¼Œmain å‡½æ•°å…ˆé€šè¿‡å¾ªåˆå§‹åŒ–ä¸€ä¸ªåˆ‡ç‰‡ï¼Œç„¶åè¾“å‡ºåˆ‡ç‰‡çš„å†…å®¹ï¼š
1 2 3 4 5 6 7 8 9 10 11 12 13 package main import ( &amp;#34;fmt&amp;#34; ) func main() { nums := make([]int, 5) for i := 0; i &amp;lt;len(nums); i++ { nums[i] = i * i } fmt."><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/Avatar.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LookForAdmin</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=social-menu><li><a href=https://github.com/60ke target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/posts target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/drafts><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>è‰ç¨¿ç®±</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>about</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#delveæ–‡æ¡£>Delveæ–‡æ¡£</a></li></ol><ol><li><a href=#391-delve-å…¥é—¨>3.9.1 Delve å…¥é—¨</a></li><li><a href=#392-è°ƒè¯•æ±‡ç¼–ç¨‹åº>3.9.2 è°ƒè¯•æ±‡ç¼–ç¨‹åº</a></li><li><a href=#ebpfä¸dlv>EBPFä¸DLV</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/go/>go</a>
<a href=/categories/ebpf/>ebpf</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/go%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95/>goä»£ç è°ƒè¯•</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 09, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 8 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>Goç›®å‰æ”¯æŒ<a class=link href=https://sourceware.org/gdb/current/onlinedocs/gdb/ target=_blank rel=noopener>GDB</a>,<a class=link href=https://lldb.llvm.org/use/tutorial.html target=_blank rel=noopener>LLDB</a>,<a class=link href=https://github.com/go-delve/delve target=_blank rel=noopener>Delve</a>ç­‰è°ƒè¯•å·¥å…·.å®˜æ–¹å‡ºäº†<a class=link href=https://go.dev/doc/gdb target=_blank rel=noopener>GDBè°ƒè¯•æ•™ç¨‹</a>ä½†æ˜¯å®˜æ–¹æ›´æ¨è<a class=link href=https://github.com/go-delve/delve target=_blank rel=noopener>Delve</a>(âŠ™ËâŠ™)</p><h2 id=delveæ–‡æ¡£>Delveæ–‡æ¡£</h2><ul><li><p><a class=link href=https://github.com/go-delve/delve/tree/master/Documentation target=_blank rel=noopener>Delveå®˜æ–¹æ–‡æ¡£</a></p></li><li><p><a class=link href=https://chai2010.cn/advanced-go-programming-book/ch3-asm/ch3-09-debug.html target=_blank rel=noopener>goè¯­è¨€é«˜çº§ç¼–ç¨‹ä¹‹Delveè°ƒè¯•</a>
ä¸ºé¿å…å¤±è”,å°†ä¸­æ–‡æ–‡æ¡£æ‘˜æŠ„</p><blockquote><h1 id=39-delve-è°ƒè¯•å™¨>3.9 Delve è°ƒè¯•å™¨</h1><p>ç›®å‰ Go è¯­è¨€æ”¯æŒ GDBã€LLDB å’Œ Delve å‡ ç§è°ƒè¯•å™¨ã€‚å…¶ä¸­ GDB æ˜¯æœ€æ—©æ”¯æŒçš„è°ƒè¯•å·¥>å…·ï¼ŒLLDB æ˜¯ macOS ç³»ç»Ÿæ¨èçš„æ ‡å‡†è°ƒè¯•å·¥å…·ã€‚ä½†æ˜¯ GDB å’Œ LLDB å¯¹ Go è¯­è¨€çš„ä¸“æœ‰>ç‰¹æ€§éƒ½ç¼ºä¹å¾ˆå¤§æ”¯æŒï¼Œè€Œåªæœ‰ Delve æ˜¯ä¸“é—¨ä¸º Go è¯­è¨€è®¾è®¡å¼€å‘çš„è°ƒè¯•å·¥å…·ã€‚è€Œä¸” >Delve æœ¬èº«ä¹Ÿæ˜¯é‡‡ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå¯¹ Windows å¹³å°ä¹Ÿæä¾›äº†ä¸€æ ·çš„æ”¯æŒã€‚æœ¬èŠ‚æˆ‘ä»¬>åŸºäº Delve ç®€å•è§£é‡Šå¦‚ä½•è°ƒè¯• Go æ±‡ç¼–ç¨‹åºã€‚</p><h2 id=391-delve-å…¥é—¨>3.9.1 Delve å…¥é—¨</h2><p>é¦–å…ˆæ ¹æ®å®˜æ–¹çš„æ–‡æ¡£æ­£ç¡®å®‰è£… Delve è°ƒè¯•å™¨ã€‚æˆ‘ä»¬ä¼šå…ˆæ„é€ ä¸€ä¸ªç®€å•çš„ Go è¯­è¨€ä»£ç ï¼Œ>ç”¨äºç†Ÿæ‚‰ä¸‹ Delve çš„ç®€å•ç”¨æ³•ã€‚</p><p>åˆ›å»º main.go æ–‡ä»¶ï¼Œmain å‡½æ•°å…ˆé€šè¿‡å¾ªåˆå§‹åŒ–ä¸€ä¸ªåˆ‡ç‰‡ï¼Œç„¶åè¾“å‡ºåˆ‡ç‰‡çš„å†…å®¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>nums</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>);</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  	<span class=nx>nums</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=nx>i</span> <span class=o>*</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å‘½ä»¤è¡Œè¿›å…¥åŒ…æ‰€åœ¨ç›®å½•ï¼Œç„¶åè¾“å…¥ <code>dlv debug</code> å‘½ä»¤è¿›å…¥è°ƒè¯•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dlv debug
</span></span><span class=line><span class=cl>Type &#39;help&#39; for list of commands.
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>è¾“å…¥ help å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ° Delve æä¾›çš„è°ƒè¯•å‘½ä»¤åˆ—è¡¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=nx>help</span>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>following</span> <span class=nx>commands</span> <span class=nx>are</span> <span class=nx>available</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=nx>args</span> <span class=o>------------------------</span> <span class=nx>Print</span> <span class=nx>function</span> <span class=nx>arguments</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=k>break</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>b</span><span class=p>)</span> <span class=o>------------</span> <span class=nx>Sets</span> <span class=nx>a</span> <span class=nx>breakpoint</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>breakpoints</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>bp</span><span class=p>)</span> <span class=o>-----</span> <span class=nx>Print</span> <span class=nx>out</span> <span class=nx>info</span> <span class=k>for</span> <span class=nx>active</span> <span class=p>&gt;</span><span class=nx>breakpoints</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>clear</span> <span class=o>-----------------------</span> <span class=nx>Deletes</span> <span class=nx>breakpoint</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>clearall</span> <span class=o>--------------------</span> <span class=nx>Deletes</span> <span class=nx>multiple</span> <span class=nx>breakpoints</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>condition</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>cond</span><span class=p>)</span> <span class=o>-----</span> <span class=nx>Set</span> <span class=nx>breakpoint</span> <span class=nx>condition</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>config</span> <span class=o>----------------------</span> <span class=nx>Changes</span> <span class=nx>configuration</span> <span class=nx>parameters</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=k>continue</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>c</span><span class=p>)</span> <span class=o>---------</span> <span class=nx>Run</span> <span class=nx>until</span> <span class=nx>breakpoint</span> <span class=nx>or</span> <span class=nx>program</span> <span class=p>&gt;</span><span class=nx>termination</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>disassemble</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>disass</span><span class=p>)</span> <span class=o>-</span> <span class=nx>Disassembler</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>down</span> <span class=o>------------------------</span> <span class=nx>Move</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>frame</span> <span class=nx>down</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>exit</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>quit</span> <span class=p>|</span> <span class=nx>q</span><span class=p>)</span> <span class=o>------</span> <span class=nx>Exit</span> <span class=nx>the</span> <span class=nx>debugger</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>frame</span> <span class=o>-----------------------</span> <span class=nx>Set</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>frame</span><span class=p>,</span> <span class=nx>or</span> <span class=p>&gt;</span><span class=nx>execute</span> <span class=nx>command</span><span class=o>...</span>
</span></span><span class=line><span class=cl>   <span class=nx>funcs</span> <span class=o>-----------------------</span> <span class=nx>Print</span> <span class=nx>list</span> <span class=nx>of</span> <span class=nx>functions</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>goroutine</span> <span class=o>-------------------</span> <span class=nx>Shows</span> <span class=nx>or</span> <span class=nx>changes</span> <span class=nx>current</span> <span class=p>&gt;</span><span class=nx>goroutine</span>
</span></span><span class=line><span class=cl>   <span class=nx>goroutines</span> <span class=o>------------------</span> <span class=nx>List</span> <span class=nx>program</span> <span class=nx>goroutines</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>help</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>h</span><span class=p>)</span> <span class=o>-------------</span> <span class=nx>Prints</span> <span class=nx>the</span> <span class=nx>help</span> <span class=nx>message</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>list</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>ls</span> <span class=p>|</span> <span class=nx>l</span><span class=p>)</span> <span class=o>--------</span> <span class=nx>Show</span> <span class=nx>source</span> <span class=nx>code</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>locals</span> <span class=o>----------------------</span> <span class=nx>Print</span> <span class=nx>local</span> <span class=nx>variables</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>next</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>n</span><span class=p>)</span> <span class=o>-------------</span> <span class=nx>Step</span> <span class=nx>over</span> <span class=nx>to</span> <span class=nx>next</span> <span class=nx>source</span> <span class=nx>line</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>on</span> <span class=o>--------------------------</span> <span class=nx>Executes</span> <span class=nx>a</span> <span class=nx>command</span> <span class=nx>when</span> <span class=nx>a</span> <span class=p>&gt;</span><span class=nx>breakpoint</span> <span class=nx>is</span> <span class=nx>hit</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>print</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>p</span><span class=p>)</span> <span class=o>------------</span> <span class=nx>Evaluate</span> <span class=nx>an</span> <span class=nx>expression</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>regs</span> <span class=o>------------------------</span> <span class=nx>Print</span> <span class=nx>contents</span> <span class=nx>of</span> <span class=nx>CPU</span> <span class=nx>registers</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>restart</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>r</span><span class=p>)</span> <span class=o>----------</span> <span class=nx>Restart</span> <span class=nx>process</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>set</span> <span class=o>-------------------------</span> <span class=nx>Changes</span> <span class=nx>the</span> <span class=nx>value</span> <span class=nx>of</span> <span class=nx>a</span> <span class=nx>variable</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>source</span> <span class=o>----------------------</span> <span class=nx>Executes</span> <span class=nx>a</span> <span class=nx>file</span> <span class=nx>containing</span> <span class=nx>a</span> <span class=p>&gt;</span><span class=nx>list</span> <span class=nx>of</span> <span class=nx>delve</span><span class=o>...</span>
</span></span><span class=line><span class=cl>   <span class=nx>sources</span> <span class=o>---------------------</span> <span class=nx>Print</span> <span class=nx>list</span> <span class=nx>of</span> <span class=nx>source</span> <span class=nx>files</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>stack</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>bt</span><span class=p>)</span> <span class=o>-----------</span> <span class=nx>Print</span> <span class=nx>stack</span> <span class=nx>trace</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>step</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>s</span><span class=p>)</span> <span class=o>-------------</span> <span class=nx>Single</span> <span class=nx>step</span> <span class=nx>through</span> <span class=nx>program</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>step</span><span class=o>-</span><span class=nf>instruction</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>si</span><span class=p>)</span>  <span class=nx>Single</span> <span class=nx>step</span> <span class=nx>a</span> <span class=nx>single</span> <span class=nx>cpu</span> <span class=p>&gt;</span><span class=nx>instruction</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>stepout</span> <span class=o>---------------------</span> <span class=nx>Step</span> <span class=nx>out</span> <span class=nx>of</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>function</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>thread</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>tr</span><span class=p>)</span> <span class=o>----------</span> <span class=nx>Switch</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>specified</span> <span class=nx>thread</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>threads</span> <span class=o>---------------------</span> <span class=nx>Print</span> <span class=nx>out</span> <span class=nx>info</span> <span class=k>for</span> <span class=nx>every</span> <span class=nx>traced</span> <span class=p>&gt;</span><span class=nx>thread</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>trace</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>t</span><span class=p>)</span> <span class=o>------------</span> <span class=nx>Set</span> <span class=nx>tracepoint</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>types</span> <span class=o>-----------------------</span> <span class=nx>Print</span> <span class=nx>list</span> <span class=nx>of</span> <span class=nx>types</span>
</span></span><span class=line><span class=cl>   <span class=nx>up</span> <span class=o>--------------------------</span> <span class=nx>Move</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>frame</span> <span class=nx>up</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>vars</span> <span class=o>------------------------</span> <span class=nx>Print</span> <span class=kn>package</span> <span class=nx>variables</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>whatis</span> <span class=o>----------------------</span> <span class=nx>Prints</span> <span class=kd>type</span> <span class=nx>of</span> <span class=nx>an</span> <span class=nx>expression</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span> <span class=nx>help</span> <span class=nx>followed</span> <span class=nx>by</span> <span class=nx>a</span> <span class=nx>command</span> <span class=k>for</span> <span class=nx>full</span> <span class=nx>documentation</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¯ä¸ª Go ç¨‹åºçš„å…¥å£æ˜¯ main.main å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ break åœ¨æ­¤è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) break main.main
</span></span><span class=line><span class=cl>Breakpoint 1 set at 0x10ae9b8 for main.main() ./main.go:7
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åé€šè¿‡ breakpoints æŸ¥çœ‹å·²ç»è®¾ç½®çš„æ‰€æœ‰æ–­ç‚¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) breakpoints
</span></span><span class=line><span class=cl>Breakpoint unrecovered-panic at 0x102a380 for runtime.startpanic()
</span></span><span class=line><span class=cl>   /usr/local/go/src/runtime/panic.go:588 (0)
</span></span><span class=line><span class=cl>       print runtime.curg._panic.arg
</span></span><span class=line><span class=cl>Breakpoint 1 at 0x10ae9b8 for main.main() ./main.go:7 (0)
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å‘ç°é™¤äº†æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„ main.main å‡½æ•°æ–­ç‚¹å¤–ï¼ŒDelve å†…éƒ¨å·²ç»ä¸º panic å¼‚>å¸¸å‡½æ•°è®¾ç½®äº†ä¸€ä¸ªæ–­ç‚¹ã€‚</p><p>é€šè¿‡ vars å‘½ä»¤å¯ä»¥æŸ¥çœ‹å…¨éƒ¨åŒ…çº§çš„å˜é‡ã€‚å› ä¸ºæœ€ç»ˆçš„ç›®æ ‡ç¨‹åºå¯èƒ½å«æœ‰å¤§é‡çš„å…¨å±€å˜>é‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªæ­£åˆ™å‚æ•°é€‰æ‹©æƒ³æŸ¥çœ‹çš„å…¨å±€å˜é‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) vars main
</span></span><span class=line><span class=cl>main.initdoneÂ· = 2
</span></span><span class=line><span class=cl>runtime.main_init_done = chan bool 0/0
</span></span><span class=line><span class=cl>runtime.mainStarted = true
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åå°±å¯ä»¥é€šè¿‡ continue å‘½ä»¤è®©ç¨‹åºè¿è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) continue
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:7 (hits goroutine(1):1 total:1) (PC: &gt;0x10ae9b8)
</span></span><span class=line><span class=cl>    2:
</span></span><span class=line><span class=cl>    3: import (
</span></span><span class=line><span class=cl>    4:         &#34;fmt&#34;
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>=&gt;   7: func main() {
</span></span><span class=line><span class=cl>    8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>    9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>   10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>è¾“å…¥ next å‘½ä»¤å•æ­¥æ‰§è¡Œè¿›å…¥ main å‡½æ•°å†…éƒ¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) next
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:8 (PC: 0x10ae9cf)
</span></span><span class=line><span class=cl>    3: import (
</span></span><span class=line><span class=cl>    4:         &#34;fmt&#34;
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>    7: func main() {
</span></span><span class=line><span class=cl>=&gt;   8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>    9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>   10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>   13: }
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>è¿›å…¥å‡½æ•°ä¹‹åå¯ä»¥é€šè¿‡ args å’Œ locals å‘½ä»¤æŸ¥çœ‹å‡½æ•°çš„å‚æ•°å’Œå±€éƒ¨å˜é‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) args
</span></span><span class=line><span class=cl>(no args)
</span></span><span class=line><span class=cl>(dlv) locals
</span></span><span class=line><span class=cl>nums = []int len: 842350763880, cap: 17491881, nil
</span></span></code></pre></td></tr></table></div></div><p>å› ä¸º main å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œå› æ­¤ args å‘½ä»¤æ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚è€Œ locals å‘½ä»¤åˆ™è¾“å‡ºäº†å±€>éƒ¨å˜é‡ nums åˆ‡ç‰‡çš„å€¼ï¼šæ­¤æ—¶åˆ‡ç‰‡è¿˜æœªå®Œæˆåˆå§‹åŒ–ï¼Œåˆ‡ç‰‡çš„åº•å±‚æŒ‡é’ˆä¸º nilï¼Œé•¿åº¦å’Œå®¹é‡>éƒ½æ˜¯ä¸€ä¸ªéšæœºæ•°å€¼ã€‚</p><p>å†æ¬¡è¾“å…¥ next å‘½ä»¤å•æ­¥æ‰§è¡Œåå°±å¯ä»¥æŸ¥çœ‹åˆ° nums åˆ‡ç‰‡åˆå§‹åŒ–ä¹‹åçš„ç»“æœäº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) next
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:9 (PC: 0x10aea12)
</span></span><span class=line><span class=cl>    4:         &#34;fmt&#34;
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>    7: func main() {
</span></span><span class=line><span class=cl>    8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>=&gt;   9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>   10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>   13: }
</span></span><span class=line><span class=cl>(dlv) locals
</span></span><span class=line><span class=cl>nums = []int len: 5, cap: 5, [...]
</span></span><span class=line><span class=cl>i = 17601536
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>æ­¤æ—¶å› ä¸ºè°ƒè¯•å™¨å·²ç»åˆ°äº† for è¯­å¥è¡Œï¼Œå› æ­¤å±€éƒ¨å˜é‡å‡ºç°äº†è¿˜æœªåˆå§‹åŒ–çš„å¾ªç¯è¿­ä»£å˜é‡ >iã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ç»„åˆä½¿ç”¨ break å’Œ condition å‘½ä»¤ï¼Œåœ¨å¾ªç¯å†…éƒ¨è®¾ç½®ä¸€ä¸ªæ¡ä»¶æ–­ç‚¹ï¼Œå½“>å¾ªç¯å˜é‡ i ç­‰äº 3 æ—¶æ–­ç‚¹ç”Ÿæ•ˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) break main.go:10
</span></span><span class=line><span class=cl>Breakpoint 2 set at 0x10aea33 for main.main() ./main.go:10
</span></span><span class=line><span class=cl>(dlv) condition 2 i==3
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åé€šè¿‡ continue æ‰§è¡Œåˆ°åˆšè®¾ç½®çš„æ¡ä»¶æ–­ç‚¹ï¼Œå¹¶ä¸”è¾“å‡ºå±€éƒ¨å˜é‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) continue
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:10 (hits goroutine(1):1 total:1) (PC: &gt;0x10aea33)
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>    7: func main() {
</span></span><span class=line><span class=cl>    8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>    9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>=&gt;  10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>   13: }
</span></span><span class=line><span class=cl>(dlv) locals
</span></span><span class=line><span class=cl>nums = []int len: 5, cap: 5, [...]
</span></span><span class=line><span class=cl>i = 3
</span></span><span class=line><span class=cl>(dlv) print nums
</span></span><span class=line><span class=cl>[]int len: 5, cap: 5, [0,1,4,0,0]
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å‘ç°å½“å¾ªç¯å˜é‡ i ç­‰äº 3 æ—¶ï¼Œnums åˆ‡ç‰‡çš„å‰ 3 ä¸ªå…ƒç´ å·²ç»æ­£ç¡®åˆå§‹åŒ–ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ stack æŸ¥çœ‹å½“å‰æ‰§è¡Œå‡½æ•°çš„æ ˆå¸§ä¿¡æ¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) stack
</span></span><span class=line><span class=cl>0  0x00000000010aea33 in main.main
</span></span><span class=line><span class=cl>  at ./main.go:10
</span></span><span class=line><span class=cl>1  0x000000000102bd60 in runtime.main
</span></span><span class=line><span class=cl>  at /usr/local/go/src/runtime/proc.go:198
</span></span><span class=line><span class=cl>2  0x0000000001053bd1 in runtime.goexit
</span></span><span class=line><span class=cl>  at /usr/local/go/src/runtime/asm_amd64.s:2361
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>æˆ–è€…é€šè¿‡ goroutine å’Œ goroutines å‘½ä»¤æŸ¥çœ‹å½“å‰ Goroutine ç›¸å…³çš„ä¿¡æ¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) goroutine
</span></span><span class=line><span class=cl>Thread 101686 at ./main.go:10
</span></span><span class=line><span class=cl>Goroutine 1:
</span></span><span class=line><span class=cl> Runtime: ./main.go:10 main.main (0x10aea33)
</span></span><span class=line><span class=cl> User: ./main.go:10 main.main (0x10aea33)
</span></span><span class=line><span class=cl> Go: /usr/local/go/src/runtime/asm_amd64.s:258 runtime.rt0_go &gt;(0x1051643)
</span></span><span class=line><span class=cl> Start: /usr/local/go/src/runtime/proc.go:109 runtime.main &gt;(0x102bb90)
</span></span><span class=line><span class=cl>(dlv) goroutines
</span></span><span class=line><span class=cl>[4 goroutines]
</span></span><span class=line><span class=cl>* Goroutine 1 - User: ./main.go:10 main.main (0x10aea33) (thread &gt;101686)
</span></span><span class=line><span class=cl> Goroutine 2 - User: /usr/local/go/src/runtime/proc.go:292 \
</span></span><span class=line><span class=cl>               runtime.gopark (0x102c189)
</span></span><span class=line><span class=cl> Goroutine 3 - User: /usr/local/go/src/runtime/proc.go:292 \
</span></span><span class=line><span class=cl>               runtime.gopark (0x102c189)
</span></span><span class=line><span class=cl> Goroutine 4 - User: /usr/local/go/src/runtime/proc.go:292 \
</span></span><span class=line><span class=cl>               runtime.gopark (0x102c189)
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>æœ€åå®Œæˆè°ƒè¯•å·¥ä½œåè¾“å…¥ quit å‘½ä»¤é€€å‡ºè°ƒè¯•å™¨ã€‚è‡³æ­¤æˆ‘ä»¬å·²ç»æŒæ¡äº† Delve è°ƒè¯•å™¨å™¨>çš„ç®€å•ç”¨æ³•ã€‚</p><h2 id=392-è°ƒè¯•æ±‡ç¼–ç¨‹åº>3.9.2 è°ƒè¯•æ±‡ç¼–ç¨‹åº</h2><p>ç”¨ Delve è°ƒè¯• Go æ±‡ç¼–ç¨‹åºçš„è¿‡ç¨‹æ¯”è°ƒè¯• Go è¯­è¨€ç¨‹åºæ›´åŠ ç®€å•ã€‚è°ƒè¯•æ±‡ç¼–ç¨‹åºæ—¶ï¼Œæˆ‘>ä»¬éœ€è¦æ—¶åˆ»å…³æ³¨å¯„å­˜å™¨çš„çŠ¶æ€ï¼Œå¦‚æœæ¶‰åŠå‡½æ•°è°ƒç”¨æˆ–å±€éƒ¨å˜é‡æˆ–å‚æ•°è¿˜éœ€è¦é‡ç‚¹å…³æ³¨æ ˆå¯„å­˜>å™¨ SP çš„çŠ¶æ€ã€‚</p><p>ä¸ºäº†ç¼–è¯‘æ¼”ç¤ºï¼Œæˆ‘ä»¬é‡æ–°å®ç°ä¸€ä¸ªæ›´ç®€å•çš„ main å‡½æ•°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=nf>asmSayHello</span><span class=p>()</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>asmSayHello</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ main å‡½æ•°ä¸­è°ƒç”¨æ±‡ç¼–è¯­è¨€å®ç°çš„ asmSayHello å‡½æ•°è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>asmSayHello å‡½æ•°åœ¨ main_amd64.s æ–‡ä»¶ä¸­å®ç°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#include &#34;textflag.h&#34;
</span></span><span class=line><span class=cl>#include &#34;funcdata.h&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// &#34;Hello World!\n&#34;
</span></span><span class=line><span class=cl>DATA  text&lt;&gt;+0(SB)/8,$&#34;Hello Wo&#34;
</span></span><span class=line><span class=cl>DATA  text&lt;&gt;+8(SB)/8,$&#34;rld!\n&#34;
</span></span><span class=line><span class=cl>GLOBL text&lt;&gt;(SB),NOPTR,$16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// func asmSayHello()
</span></span><span class=line><span class=cl>TEXT Â·asmSayHello(SB), $16-0
</span></span><span class=line><span class=cl>  NO_LOCAL_POINTERS
</span></span><span class=line><span class=cl>  MOVQ $text&lt;&gt;+0(SB), AX
</span></span><span class=line><span class=cl>  MOVQ AX, (SP)
</span></span><span class=line><span class=cl>  MOVQ $16, 8(SP)
</span></span><span class=line><span class=cl>  CALL runtimeÂ·printstring(SB)
</span></span><span class=line><span class=cl>  RET
</span></span></code></pre></td></tr></table></div></div><p>å‚è€ƒå‰é¢çš„è°ƒè¯•æµç¨‹ï¼Œåœ¨æ‰§è¡Œåˆ° main å‡½æ•°æ–­ç‚¹æ—¶ï¼Œå¯ä»¥ disassemble åæ±‡ç¼–å‘½ä»¤æŸ¥>çœ‹ main å‡½æ•°å¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=k>break</span> <span class=nx>main</span><span class=p>.</span><span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=nx>Breakpoint</span> <span class=mi>1</span> <span class=nx>set</span> <span class=nx>at</span> <span class=mh>0x105011f</span> <span class=k>for</span> <span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span> <span class=p>.</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=k>continue</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> <span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span> <span class=p>.</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=p>(</span><span class=nx>hits</span> <span class=nf>goroutine</span><span class=p>(</span><span class=mi>1</span><span class=p>):</span><span class=mi>1</span> <span class=nx>total</span><span class=p>:</span><span class=mi>1</span><span class=p>)</span> <span class=p>(</span><span class=nx>PC</span><span class=p>:</span> <span class=p>&gt;</span><span class=mh>0x105011f</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=p>:</span> <span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>=&gt;</span><span class=mi>3</span><span class=p>:</span> <span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=nf>asmSayHello</span><span class=p>()</span> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=mi>5</span><span class=p>:</span> <span class=kd>func</span> <span class=nf>asmSayHello</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=nx>disassemble</span>
</span></span><span class=line><span class=cl><span class=nx>TEXT</span> <span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>(</span><span class=nx>SB</span><span class=p>)</span> <span class=o>/</span><span class=nx>path</span><span class=o>/</span><span class=nx>to</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050110</span>  <span class=mi>65488</span><span class=nx>b0c25a0080000</span> <span class=nx>mov</span> <span class=nx>rcx</span><span class=p>,</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=nx>g</span>  <span class=p>&gt;[</span><span class=mh>0x8a0</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050119</span>  <span class=mi>483</span><span class=nx>b6110</span>           <span class=nx>cmp</span> <span class=nx>rsp</span><span class=p>,</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>r</span>  <span class=p>&gt;</span><span class=o>+</span><span class=mh>0x10</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105011d</span>  <span class=mi>761</span><span class=nx>a</span>               <span class=nx>jbe</span> <span class=mh>0x1050139</span>
</span></span><span class=line><span class=cl><span class=p>=&gt;</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105011f</span><span class=o>*</span> <span class=mi>4883</span><span class=nx>ec08</span>           <span class=nx>sub</span> <span class=nx>rsp</span><span class=p>,</span> <span class=mh>0x8</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050123</span>  <span class=mi>48892</span><span class=nx>c24</span>           <span class=nx>mov</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rsp</span><span class=p>],</span> <span class=nx>rbp</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050127</span>  <span class=mi>488</span><span class=nx>d2c24</span>           <span class=nx>lea</span> <span class=nx>rbp</span><span class=p>,</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rsp</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105012b</span>  <span class=nx>e880000000</span>         <span class=nx>call</span> <span class=err>$</span><span class=nx>main</span><span class=p>.</span><span class=nx>asmSayHello</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050130</span>  <span class=mi>488</span><span class=nx>b2c24</span>           <span class=nx>mov</span> <span class=nx>rbp</span><span class=p>,</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rsp</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050134</span>  <span class=mi>4883</span><span class=nx>c408</span>           <span class=nx>add</span> <span class=nx>rsp</span><span class=p>,</span> <span class=mh>0x8</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050138</span>  <span class=nx>c3</span>                 <span class=nx>ret</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050139</span>  <span class=nx>e87288ffff</span>         <span class=nx>call</span> <span class=err>$</span><span class=nx>runtime</span><span class=p>.&gt;</span><span class=nx>morestack_noctxt</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105013e</span>  <span class=nx>ebd0</span>               <span class=nx>jmp</span> <span class=err>$</span><span class=nx>main</span><span class=p>.</span><span class=nf>main</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è™½ç„¶ main å‡½æ•°å†…éƒ¨åªæœ‰ä¸€è¡Œå‡½æ•°è°ƒç”¨è¯­å¥ï¼Œä½†æ˜¯å´ç”Ÿæˆäº†å¾ˆå¤šæ±‡ç¼–æŒ‡ä»¤ã€‚åœ¨å‡½æ•°çš„å¼€å¤´>é€šè¿‡æ¯”è¾ƒ rsp å¯„å­˜å™¨åˆ¤æ–­æ ˆç©ºé—´æ˜¯å¦ä¸è¶³ï¼Œå¦‚æœä¸è¶³åˆ™è·³è½¬åˆ° 0x1050139 åœ°å€è°ƒç”¨ >runtime.morestack å‡½æ•°è¿›è¡Œæ ˆæ‰©å®¹ï¼Œç„¶åè·³å›åˆ° main å‡½æ•°å¼€å§‹ä½ç½®é‡æ–°è¿›è¡Œæ ˆç©º>é—´æµ‹è¯•ã€‚è€Œåœ¨ asmSayHello å‡½æ•°è°ƒç”¨ä¹‹å‰ï¼Œå…ˆæ‰©å±• rsp ç©ºé—´ç”¨äºä¸´æ—¶å­˜å‚¨ rbp å¯„å­˜>å™¨çš„çŠ¶æ€ï¼Œåœ¨å‡½æ•°è¿”å›åé€šè¿‡æ ˆæ¢å¤ rbp çš„å€¼å¹¶å›æ”¶ä¸´æ—¶æ ˆç©ºé—´ã€‚é€šè¿‡å¯¹æ¯” Go è¯­è¨€ä»£>ç å’Œå¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åŠ æ·±å¯¹ Go æ±‡ç¼–è¯­è¨€çš„ç†è§£ã€‚</p><p>ä»æ±‡ç¼–è¯­è¨€è§’åº¦æ·±åˆ» Go è¯­è¨€å„ç§ç‰¹æ€§çš„å·¥ä½œæœºåˆ¶å¯¹è°ƒè¯•å·¥ä½œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¸®åŠ©ã€‚å¦‚æœ>å¸Œæœ›åœ¨æ±‡ç¼–æŒ‡ä»¤å±‚é¢è°ƒè¯• Go ä»£ç ï¼ŒDelve è¿˜æä¾›äº†ä¸€ä¸ª step-instruction å•æ­¥æ‰§>è¡Œæ±‡ç¼–æŒ‡ä»¤çš„å‘½ä»¤ã€‚</p><p>ç°åœ¨æˆ‘ä»¬ä¾ç„¶ç”¨ break å‘½ä»¤åœ¨ asmSayHello å‡½æ•°è®¾ç½®æ–­ç‚¹ï¼Œå¹¶ä¸”è¾“å…¥ continue å‘½>ä»¤è®©è°ƒè¯•å™¨æ‰§è¡Œåˆ°æ–­ç‚¹ä½ç½®åœä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) break main.asmSayHello
</span></span><span class=line><span class=cl>Breakpoint 2 set at 0x10501bf for main.asmSayHello() ./main_amd64.&gt;s:10
</span></span><span class=line><span class=cl>(dlv) continue
</span></span><span class=line><span class=cl>&gt; main.asmSayHello() ./main_amd64.s:10 (hits goroutine(1):1 &gt;total:1) (PC: 0x10501bf)
</span></span><span class=line><span class=cl>    5: DATA  text&lt;&gt;+0(SB)/8,$&#34;Hello Wo&#34;
</span></span><span class=line><span class=cl>    6: DATA  text&lt;&gt;+8(SB)/8,$&#34;rld!\n&#34;
</span></span><span class=line><span class=cl>    7: GLOBL text&lt;&gt;(SB),NOPTR,$16
</span></span><span class=line><span class=cl>    8:
</span></span><span class=line><span class=cl>    9: // func asmSayHello()
</span></span><span class=line><span class=cl>=&gt;  10: TEXT Â·asmSayHello(SB), $16-0
</span></span><span class=line><span class=cl>   11:         NO_LOCAL_POINTERS
</span></span><span class=line><span class=cl>   12:         MOVQ $text&lt;&gt;+0(SB), AX
</span></span><span class=line><span class=cl>   13:         MOVQ AX, (SP)
</span></span><span class=line><span class=cl>   14:         MOVQ $16, 8(SP)
</span></span><span class=line><span class=cl>   15:         CALL runtimeÂ·printstring(SB)
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ regs æŸ¥çœ‹å…¨éƒ¨çš„å¯„å­˜å™¨çŠ¶æ€ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) regs
</span></span><span class=line><span class=cl>      rax = 0x0000000001050110
</span></span><span class=line><span class=cl>      rbx = 0x0000000000000000
</span></span><span class=line><span class=cl>      rcx = 0x000000c420000300
</span></span><span class=line><span class=cl>      rdx = 0x0000000001070be0
</span></span><span class=line><span class=cl>      rdi = 0x000000c42007c020
</span></span><span class=line><span class=cl>      rsi = 0x0000000000000001
</span></span><span class=line><span class=cl>      rbp = 0x000000c420049f78
</span></span><span class=line><span class=cl>      rsp = 0x000000c420049f70
</span></span><span class=line><span class=cl>       r8 = 0x7fffffffffffffff
</span></span><span class=line><span class=cl>       r9 = 0xffffffffffffffff
</span></span><span class=line><span class=cl>      r10 = 0x0000000000000100
</span></span><span class=line><span class=cl>      r11 = 0x0000000000000286
</span></span><span class=line><span class=cl>      r12 = 0x000000c41fffff7c
</span></span><span class=line><span class=cl>      r13 = 0x0000000000000000
</span></span><span class=line><span class=cl>      r14 = 0x0000000000000178
</span></span><span class=line><span class=cl>      r15 = 0x0000000000000004
</span></span><span class=line><span class=cl>      rip = 0x00000000010501bf
</span></span><span class=line><span class=cl>   rflags = 0x0000000000000206
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>å› ä¸º AMD64 çš„å„ç§å¯„å­˜å™¨éå¸¸å¤šï¼Œé¡¹ç›®çš„ä¿¡æ¯ä¸­åˆ»æ„çœç•¥äº†éé€šç”¨çš„å¯„å­˜å™¨ã€‚å¦‚æœå†å•æ­¥>æ‰§è¡Œåˆ° 13 è¡Œæ—¶ï¼Œå¯ä»¥å‘ç° AX å¯„å­˜å™¨å€¼çš„å˜åŒ–ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) regs
</span></span><span class=line><span class=cl>      rax = 0x00000000010a4060
</span></span><span class=line><span class=cl>      rbx = 0x0000000000000000
</span></span><span class=line><span class=cl>      rcx = 0x000000c420000300
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ¨æ–­æ±‡ç¼–ç¨‹åºå†…éƒ¨å®šä¹‰çš„ <code>text&lt;></code> æ•°æ®çš„åœ°å€ä¸º >0x00000000010a4060ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿‡ print å‘½ä»¤æ¥æŸ¥çœ‹è¯¥å†…å­˜å†…çš„æ•°æ®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) print *(*[5]byte)(uintptr(0x00000000010a4060))
</span></span><span class=line><span class=cl>[5]uint8 [72,101,108,108,111]
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å¯ä»¥å‘ç°è¾“å‡ºçš„ <code>[5]uint8 [72,101,108,108,111]</code> åˆšå¥½æ˜¯å¯¹åº” â€œHelloâ€ å­—>ç¬¦ä¸²ã€‚é€šè¿‡ç±»ä¼¼çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹ SP å¯¹åº”çš„æ ˆæŒ‡é’ˆä½ç½®ï¼Œç„¶åæŸ¥çœ‹æ ˆä¸­å±€éƒ¨å˜>é‡çš„å€¼ã€‚</p><p>è‡³æ­¤æˆ‘ä»¬å°±æŒæ¡äº† Go æ±‡ç¼–ç¨‹åºçš„ç®€å•è°ƒè¯•æŠ€æœ¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback></code></pre></td></tr></table></div></div></blockquote></li></ul><h2 id=ebpfä¸dlv>EBPFä¸DLV</h2><p>æœ€è¿‘åœ¨å­¦ä¹ epbfæ—¶å‘ç°Delveæ”¯æŒebpfå‚æ•°.</p><p>åœ¨<code>Ubuntu 20.04.5 LTS</code>ç³»ç»Ÿä¸‹,ä½¿ç”¨rootæƒé™</p><p>å‘½ä»¤å¦‚ä¸‹:</p><p><code>/home/lsk/go/bin/dlv trace foo --ebpf</code></p><p>å¦‚æœä¸åŠ <code>ebpf</code>å‚æ•°åˆ™é»˜è®¤ä½¿ç”¨ptraceå‚æ•°,å…³äºtraceçš„å…·ä½“ä½¿ç”¨æ–¹æ³•è§:https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_trace.md</p></section><footer class=article-footer><section class=article-tags><a href=/tags/go/>go</a>
<a href=/tags/dlv/>dlv</a>
<a href=/tags/debug/>debug</a>
<a href=/tags/ebpf/>ebpf</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/githubaction/><div class=article-details><h2 class=article-title>Githubä½¿ç”¨Actionè‡ªåŠ¨ç¼–è¯‘å‘å¸ƒgoé¡¹ç›®</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=60ke/blogs issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 LookForAdmin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>