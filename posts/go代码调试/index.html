<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Go目前支持GDB,LLDB,Delve等调试工具.官方出了GDB调试教程但是官方更推荐Delve(⊙ˍ⊙)
Delve文档 Delve官方文档
go语言高级编程之Delve调试 为避免失联,将中文文档摘抄
3.9 Delve 调试器 目前 Go 语言支持 GDB、LLDB 和 Delve 几种调试器。其中 GDB 是最早支持的调试工&amp;gt;具，LLDB 是 macOS 系统推荐的标准调试工具。但是 GDB 和 LLDB 对 Go 语言的专有&amp;gt;特性都缺乏很大支持，而只有 Delve 是专门为 Go 语言设计开发的调试工具。而且 &amp;gt;Delve 本身也是采用 Go 语言开发，对 Windows 平台也提供了一样的支持。本节我们&amp;gt;基于 Delve 简单解释如何调试 Go 汇编程序。
3.9.1 Delve 入门 首先根据官方的文档正确安装 Delve 调试器。我们会先构造一个简单的 Go 语言代码，&amp;gt;用于熟悉下 Delve 的简单用法。
创建 main.go 文件，main 函数先通过循初始化一个切片，然后输出切片的内容：
1 2 3 4 5 6 7 8 9 10 11 12 13 package main import ( &amp;#34;fmt&amp;#34; ) func main() { nums := make([]int, 5) for i := 0; i &amp;lt;len(nums); i++ { nums[i] = i * i } fmt."><title>go代码调试</title><link rel=canonical href=https://60ke.github.io/posts/go%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="go代码调试"><meta property="og:description" content="Go目前支持GDB,LLDB,Delve等调试工具.官方出了GDB调试教程但是官方更推荐Delve(⊙ˍ⊙)
Delve文档 Delve官方文档
go语言高级编程之Delve调试 为避免失联,将中文文档摘抄
3.9 Delve 调试器 目前 Go 语言支持 GDB、LLDB 和 Delve 几种调试器。其中 GDB 是最早支持的调试工&amp;gt;具，LLDB 是 macOS 系统推荐的标准调试工具。但是 GDB 和 LLDB 对 Go 语言的专有&amp;gt;特性都缺乏很大支持，而只有 Delve 是专门为 Go 语言设计开发的调试工具。而且 &amp;gt;Delve 本身也是采用 Go 语言开发，对 Windows 平台也提供了一样的支持。本节我们&amp;gt;基于 Delve 简单解释如何调试 Go 汇编程序。
3.9.1 Delve 入门 首先根据官方的文档正确安装 Delve 调试器。我们会先构造一个简单的 Go 语言代码，&amp;gt;用于熟悉下 Delve 的简单用法。
创建 main.go 文件，main 函数先通过循初始化一个切片，然后输出切片的内容：
1 2 3 4 5 6 7 8 9 10 11 12 13 package main import ( &amp;#34;fmt&amp;#34; ) func main() { nums := make([]int, 5) for i := 0; i &amp;lt;len(nums); i++ { nums[i] = i * i } fmt."><meta property="og:url" content="https://60ke.github.io/posts/go%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95/"><meta property="og:site_name" content="LookForAdmin"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="Go"><meta property="article:tag" content="dlv"><meta property="article:tag" content="debug"><meta property="article:tag" content="ebpf"><meta property="article:published_time" content="2023-03-09T10:54:32+08:00"><meta property="article:modified_time" content="2023-03-09T10:54:32+08:00"><meta name=twitter:title content="go代码调试"><meta name=twitter:description content="Go目前支持GDB,LLDB,Delve等调试工具.官方出了GDB调试教程但是官方更推荐Delve(⊙ˍ⊙)
Delve文档 Delve官方文档
go语言高级编程之Delve调试 为避免失联,将中文文档摘抄
3.9 Delve 调试器 目前 Go 语言支持 GDB、LLDB 和 Delve 几种调试器。其中 GDB 是最早支持的调试工&amp;gt;具，LLDB 是 macOS 系统推荐的标准调试工具。但是 GDB 和 LLDB 对 Go 语言的专有&amp;gt;特性都缺乏很大支持，而只有 Delve 是专门为 Go 语言设计开发的调试工具。而且 &amp;gt;Delve 本身也是采用 Go 语言开发，对 Windows 平台也提供了一样的支持。本节我们&amp;gt;基于 Delve 简单解释如何调试 Go 汇编程序。
3.9.1 Delve 入门 首先根据官方的文档正确安装 Delve 调试器。我们会先构造一个简单的 Go 语言代码，&amp;gt;用于熟悉下 Delve 的简单用法。
创建 main.go 文件，main 函数先通过循初始化一个切片，然后输出切片的内容：
1 2 3 4 5 6 7 8 9 10 11 12 13 package main import ( &amp;#34;fmt&amp;#34; ) func main() { nums := make([]int, 5) for i := 0; i &amp;lt;len(nums); i++ { nums[i] = i * i } fmt."><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/Avatar.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LookForAdmin</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=social-menu><li><a href=https://github.com/60ke target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/posts target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/drafts><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>草稿箱</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>about</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#delve文档>Delve文档</a></li></ol><ol><li><a href=#391-delve-入门>3.9.1 Delve 入门</a></li><li><a href=#392-调试汇编程序>3.9.2 调试汇编程序</a></li><li><a href=#ebpf与dlv>EBPF与DLV</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/go/>go</a>
<a href=/categories/ebpf/>ebpf</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/go%E4%BB%A3%E7%A0%81%E8%B0%83%E8%AF%95/>go代码调试</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 09, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 8 分钟</time></div></footer></div></header><section class=article-content><p>Go目前支持<a class=link href=https://sourceware.org/gdb/current/onlinedocs/gdb/ target=_blank rel=noopener>GDB</a>,<a class=link href=https://lldb.llvm.org/use/tutorial.html target=_blank rel=noopener>LLDB</a>,<a class=link href=https://github.com/go-delve/delve target=_blank rel=noopener>Delve</a>等调试工具.官方出了<a class=link href=https://go.dev/doc/gdb target=_blank rel=noopener>GDB调试教程</a>但是官方更推荐<a class=link href=https://github.com/go-delve/delve target=_blank rel=noopener>Delve</a>(⊙ˍ⊙)</p><h2 id=delve文档>Delve文档</h2><ul><li><p><a class=link href=https://github.com/go-delve/delve/tree/master/Documentation target=_blank rel=noopener>Delve官方文档</a></p></li><li><p><a class=link href=https://chai2010.cn/advanced-go-programming-book/ch3-asm/ch3-09-debug.html target=_blank rel=noopener>go语言高级编程之Delve调试</a>
为避免失联,将中文文档摘抄</p><blockquote><h1 id=39-delve-调试器>3.9 Delve 调试器</h1><p>目前 Go 语言支持 GDB、LLDB 和 Delve 几种调试器。其中 GDB 是最早支持的调试工>具，LLDB 是 macOS 系统推荐的标准调试工具。但是 GDB 和 LLDB 对 Go 语言的专有>特性都缺乏很大支持，而只有 Delve 是专门为 Go 语言设计开发的调试工具。而且 >Delve 本身也是采用 Go 语言开发，对 Windows 平台也提供了一样的支持。本节我们>基于 Delve 简单解释如何调试 Go 汇编程序。</p><h2 id=391-delve-入门>3.9.1 Delve 入门</h2><p>首先根据官方的文档正确安装 Delve 调试器。我们会先构造一个简单的 Go 语言代码，>用于熟悉下 Delve 的简单用法。</p><p>创建 main.go 文件，main 函数先通过循初始化一个切片，然后输出切片的内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>nums</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span><span class=nb>len</span><span class=p>(</span><span class=nx>nums</span><span class=p>);</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  	<span class=nx>nums</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=nx>i</span> <span class=o>*</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>nums</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>命令行进入包所在目录，然后输入 <code>dlv debug</code> 命令进入调试：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dlv debug
</span></span><span class=line><span class=cl>Type &#39;help&#39; for list of commands.
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>输入 help 命令可以查看到 Delve 提供的调试命令列表：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=nx>help</span>
</span></span><span class=line><span class=cl><span class=nx>The</span> <span class=nx>following</span> <span class=nx>commands</span> <span class=nx>are</span> <span class=nx>available</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=nx>args</span> <span class=o>------------------------</span> <span class=nx>Print</span> <span class=nx>function</span> <span class=nx>arguments</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=k>break</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>b</span><span class=p>)</span> <span class=o>------------</span> <span class=nx>Sets</span> <span class=nx>a</span> <span class=nx>breakpoint</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>breakpoints</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>bp</span><span class=p>)</span> <span class=o>-----</span> <span class=nx>Print</span> <span class=nx>out</span> <span class=nx>info</span> <span class=k>for</span> <span class=nx>active</span> <span class=p>&gt;</span><span class=nx>breakpoints</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>clear</span> <span class=o>-----------------------</span> <span class=nx>Deletes</span> <span class=nx>breakpoint</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>clearall</span> <span class=o>--------------------</span> <span class=nx>Deletes</span> <span class=nx>multiple</span> <span class=nx>breakpoints</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>condition</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>cond</span><span class=p>)</span> <span class=o>-----</span> <span class=nx>Set</span> <span class=nx>breakpoint</span> <span class=nx>condition</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>config</span> <span class=o>----------------------</span> <span class=nx>Changes</span> <span class=nx>configuration</span> <span class=nx>parameters</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=k>continue</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>c</span><span class=p>)</span> <span class=o>---------</span> <span class=nx>Run</span> <span class=nx>until</span> <span class=nx>breakpoint</span> <span class=nx>or</span> <span class=nx>program</span> <span class=p>&gt;</span><span class=nx>termination</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>disassemble</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>disass</span><span class=p>)</span> <span class=o>-</span> <span class=nx>Disassembler</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>down</span> <span class=o>------------------------</span> <span class=nx>Move</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>frame</span> <span class=nx>down</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>exit</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>quit</span> <span class=p>|</span> <span class=nx>q</span><span class=p>)</span> <span class=o>------</span> <span class=nx>Exit</span> <span class=nx>the</span> <span class=nx>debugger</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>frame</span> <span class=o>-----------------------</span> <span class=nx>Set</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>frame</span><span class=p>,</span> <span class=nx>or</span> <span class=p>&gt;</span><span class=nx>execute</span> <span class=nx>command</span><span class=o>...</span>
</span></span><span class=line><span class=cl>   <span class=nx>funcs</span> <span class=o>-----------------------</span> <span class=nx>Print</span> <span class=nx>list</span> <span class=nx>of</span> <span class=nx>functions</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>goroutine</span> <span class=o>-------------------</span> <span class=nx>Shows</span> <span class=nx>or</span> <span class=nx>changes</span> <span class=nx>current</span> <span class=p>&gt;</span><span class=nx>goroutine</span>
</span></span><span class=line><span class=cl>   <span class=nx>goroutines</span> <span class=o>------------------</span> <span class=nx>List</span> <span class=nx>program</span> <span class=nx>goroutines</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>help</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>h</span><span class=p>)</span> <span class=o>-------------</span> <span class=nx>Prints</span> <span class=nx>the</span> <span class=nx>help</span> <span class=nx>message</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>list</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>ls</span> <span class=p>|</span> <span class=nx>l</span><span class=p>)</span> <span class=o>--------</span> <span class=nx>Show</span> <span class=nx>source</span> <span class=nx>code</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>locals</span> <span class=o>----------------------</span> <span class=nx>Print</span> <span class=nx>local</span> <span class=nx>variables</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>next</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>n</span><span class=p>)</span> <span class=o>-------------</span> <span class=nx>Step</span> <span class=nx>over</span> <span class=nx>to</span> <span class=nx>next</span> <span class=nx>source</span> <span class=nx>line</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>on</span> <span class=o>--------------------------</span> <span class=nx>Executes</span> <span class=nx>a</span> <span class=nx>command</span> <span class=nx>when</span> <span class=nx>a</span> <span class=p>&gt;</span><span class=nx>breakpoint</span> <span class=nx>is</span> <span class=nx>hit</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>print</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>p</span><span class=p>)</span> <span class=o>------------</span> <span class=nx>Evaluate</span> <span class=nx>an</span> <span class=nx>expression</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>regs</span> <span class=o>------------------------</span> <span class=nx>Print</span> <span class=nx>contents</span> <span class=nx>of</span> <span class=nx>CPU</span> <span class=nx>registers</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>restart</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>r</span><span class=p>)</span> <span class=o>----------</span> <span class=nx>Restart</span> <span class=nx>process</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>set</span> <span class=o>-------------------------</span> <span class=nx>Changes</span> <span class=nx>the</span> <span class=nx>value</span> <span class=nx>of</span> <span class=nx>a</span> <span class=nx>variable</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>source</span> <span class=o>----------------------</span> <span class=nx>Executes</span> <span class=nx>a</span> <span class=nx>file</span> <span class=nx>containing</span> <span class=nx>a</span> <span class=p>&gt;</span><span class=nx>list</span> <span class=nx>of</span> <span class=nx>delve</span><span class=o>...</span>
</span></span><span class=line><span class=cl>   <span class=nx>sources</span> <span class=o>---------------------</span> <span class=nx>Print</span> <span class=nx>list</span> <span class=nx>of</span> <span class=nx>source</span> <span class=nx>files</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>stack</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>bt</span><span class=p>)</span> <span class=o>-----------</span> <span class=nx>Print</span> <span class=nx>stack</span> <span class=nx>trace</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>step</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>s</span><span class=p>)</span> <span class=o>-------------</span> <span class=nx>Single</span> <span class=nx>step</span> <span class=nx>through</span> <span class=nx>program</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>step</span><span class=o>-</span><span class=nf>instruction</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>si</span><span class=p>)</span>  <span class=nx>Single</span> <span class=nx>step</span> <span class=nx>a</span> <span class=nx>single</span> <span class=nx>cpu</span> <span class=p>&gt;</span><span class=nx>instruction</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>stepout</span> <span class=o>---------------------</span> <span class=nx>Step</span> <span class=nx>out</span> <span class=nx>of</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>function</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>thread</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>tr</span><span class=p>)</span> <span class=o>----------</span> <span class=nx>Switch</span> <span class=nx>to</span> <span class=nx>the</span> <span class=nx>specified</span> <span class=nx>thread</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>threads</span> <span class=o>---------------------</span> <span class=nx>Print</span> <span class=nx>out</span> <span class=nx>info</span> <span class=k>for</span> <span class=nx>every</span> <span class=nx>traced</span> <span class=p>&gt;</span><span class=nx>thread</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nf>trace</span> <span class=p>(</span><span class=nx>alias</span><span class=p>:</span> <span class=nx>t</span><span class=p>)</span> <span class=o>------------</span> <span class=nx>Set</span> <span class=nx>tracepoint</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>types</span> <span class=o>-----------------------</span> <span class=nx>Print</span> <span class=nx>list</span> <span class=nx>of</span> <span class=nx>types</span>
</span></span><span class=line><span class=cl>   <span class=nx>up</span> <span class=o>--------------------------</span> <span class=nx>Move</span> <span class=nx>the</span> <span class=nx>current</span> <span class=nx>frame</span> <span class=nx>up</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>vars</span> <span class=o>------------------------</span> <span class=nx>Print</span> <span class=kn>package</span> <span class=nx>variables</span><span class=p>.</span>
</span></span><span class=line><span class=cl>   <span class=nx>whatis</span> <span class=o>----------------------</span> <span class=nx>Prints</span> <span class=kd>type</span> <span class=nx>of</span> <span class=nx>an</span> <span class=nx>expression</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=nx>Type</span> <span class=nx>help</span> <span class=nx>followed</span> <span class=nx>by</span> <span class=nx>a</span> <span class=nx>command</span> <span class=k>for</span> <span class=nx>full</span> <span class=nx>documentation</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>每个 Go 程序的入口是 main.main 函数，我们可以用 break 在此设置一个断点：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) break main.main
</span></span><span class=line><span class=cl>Breakpoint 1 set at 0x10ae9b8 for main.main() ./main.go:7
</span></span></code></pre></td></tr></table></div></div><p>然后通过 breakpoints 查看已经设置的所有断点：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) breakpoints
</span></span><span class=line><span class=cl>Breakpoint unrecovered-panic at 0x102a380 for runtime.startpanic()
</span></span><span class=line><span class=cl>   /usr/local/go/src/runtime/panic.go:588 (0)
</span></span><span class=line><span class=cl>       print runtime.curg._panic.arg
</span></span><span class=line><span class=cl>Breakpoint 1 at 0x10ae9b8 for main.main() ./main.go:7 (0)
</span></span></code></pre></td></tr></table></div></div><p>我们发现除了我们自己设置的 main.main 函数断点外，Delve 内部已经为 panic 异>常函数设置了一个断点。</p><p>通过 vars 命令可以查看全部包级的变量。因为最终的目标程序可能含有大量的全局变>量，我们可以通过一个正则参数选择想查看的全局变量：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) vars main
</span></span><span class=line><span class=cl>main.initdone· = 2
</span></span><span class=line><span class=cl>runtime.main_init_done = chan bool 0/0
</span></span><span class=line><span class=cl>runtime.mainStarted = true
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>然后就可以通过 continue 命令让程序运行到下一个断点处：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) continue
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:7 (hits goroutine(1):1 total:1) (PC: &gt;0x10ae9b8)
</span></span><span class=line><span class=cl>    2:
</span></span><span class=line><span class=cl>    3: import (
</span></span><span class=line><span class=cl>    4:         &#34;fmt&#34;
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>=&gt;   7: func main() {
</span></span><span class=line><span class=cl>    8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>    9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>   10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>输入 next 命令单步执行进入 main 函数内部：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) next
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:8 (PC: 0x10ae9cf)
</span></span><span class=line><span class=cl>    3: import (
</span></span><span class=line><span class=cl>    4:         &#34;fmt&#34;
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>    7: func main() {
</span></span><span class=line><span class=cl>=&gt;   8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>    9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>   10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>   13: }
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>进入函数之后可以通过 args 和 locals 命令查看函数的参数和局部变量：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) args
</span></span><span class=line><span class=cl>(no args)
</span></span><span class=line><span class=cl>(dlv) locals
</span></span><span class=line><span class=cl>nums = []int len: 842350763880, cap: 17491881, nil
</span></span></code></pre></td></tr></table></div></div><p>因为 main 函数没有参数，因此 args 命令没有任何输出。而 locals 命令则输出了局>部变量 nums 切片的值：此时切片还未完成初始化，切片的底层指针为 nil，长度和容量>都是一个随机数值。</p><p>再次输入 next 命令单步执行后就可以查看到 nums 切片初始化之后的结果了：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) next
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:9 (PC: 0x10aea12)
</span></span><span class=line><span class=cl>    4:         &#34;fmt&#34;
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>    7: func main() {
</span></span><span class=line><span class=cl>    8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>=&gt;   9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>   10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>   13: }
</span></span><span class=line><span class=cl>(dlv) locals
</span></span><span class=line><span class=cl>nums = []int len: 5, cap: 5, [...]
</span></span><span class=line><span class=cl>i = 17601536
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>此时因为调试器已经到了 for 语句行，因此局部变量出现了还未初始化的循环迭代变量 >i。</p><p>下面我们通过组合使用 break 和 condition 命令，在循环内部设置一个条件断点，当>循环变量 i 等于 3 时断点生效：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) break main.go:10
</span></span><span class=line><span class=cl>Breakpoint 2 set at 0x10aea33 for main.main() ./main.go:10
</span></span><span class=line><span class=cl>(dlv) condition 2 i==3
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>然后通过 continue 执行到刚设置的条件断点，并且输出局部变量：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) continue
</span></span><span class=line><span class=cl>&gt; main.main() ./main.go:10 (hits goroutine(1):1 total:1) (PC: &gt;0x10aea33)
</span></span><span class=line><span class=cl>    5: )
</span></span><span class=line><span class=cl>    6:
</span></span><span class=line><span class=cl>    7: func main() {
</span></span><span class=line><span class=cl>    8:         nums := make([]int, 5)
</span></span><span class=line><span class=cl>    9:         for i := 0; i &lt;len(nums); i++ {
</span></span><span class=line><span class=cl>=&gt;  10:                 nums[i] = i * i
</span></span><span class=line><span class=cl>   11:         }
</span></span><span class=line><span class=cl>   12:         fmt.Println(nums)
</span></span><span class=line><span class=cl>   13: }
</span></span><span class=line><span class=cl>(dlv) locals
</span></span><span class=line><span class=cl>nums = []int len: 5, cap: 5, [...]
</span></span><span class=line><span class=cl>i = 3
</span></span><span class=line><span class=cl>(dlv) print nums
</span></span><span class=line><span class=cl>[]int len: 5, cap: 5, [0,1,4,0,0]
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>我们发现当循环变量 i 等于 3 时，nums 切片的前 3 个元素已经正确初始化。</p><p>我们还可以通过 stack 查看当前执行函数的栈帧信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) stack
</span></span><span class=line><span class=cl>0  0x00000000010aea33 in main.main
</span></span><span class=line><span class=cl>  at ./main.go:10
</span></span><span class=line><span class=cl>1  0x000000000102bd60 in runtime.main
</span></span><span class=line><span class=cl>  at /usr/local/go/src/runtime/proc.go:198
</span></span><span class=line><span class=cl>2  0x0000000001053bd1 in runtime.goexit
</span></span><span class=line><span class=cl>  at /usr/local/go/src/runtime/asm_amd64.s:2361
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>或者通过 goroutine 和 goroutines 命令查看当前 Goroutine 相关的信息：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) goroutine
</span></span><span class=line><span class=cl>Thread 101686 at ./main.go:10
</span></span><span class=line><span class=cl>Goroutine 1:
</span></span><span class=line><span class=cl> Runtime: ./main.go:10 main.main (0x10aea33)
</span></span><span class=line><span class=cl> User: ./main.go:10 main.main (0x10aea33)
</span></span><span class=line><span class=cl> Go: /usr/local/go/src/runtime/asm_amd64.s:258 runtime.rt0_go &gt;(0x1051643)
</span></span><span class=line><span class=cl> Start: /usr/local/go/src/runtime/proc.go:109 runtime.main &gt;(0x102bb90)
</span></span><span class=line><span class=cl>(dlv) goroutines
</span></span><span class=line><span class=cl>[4 goroutines]
</span></span><span class=line><span class=cl>* Goroutine 1 - User: ./main.go:10 main.main (0x10aea33) (thread &gt;101686)
</span></span><span class=line><span class=cl> Goroutine 2 - User: /usr/local/go/src/runtime/proc.go:292 \
</span></span><span class=line><span class=cl>               runtime.gopark (0x102c189)
</span></span><span class=line><span class=cl> Goroutine 3 - User: /usr/local/go/src/runtime/proc.go:292 \
</span></span><span class=line><span class=cl>               runtime.gopark (0x102c189)
</span></span><span class=line><span class=cl> Goroutine 4 - User: /usr/local/go/src/runtime/proc.go:292 \
</span></span><span class=line><span class=cl>               runtime.gopark (0x102c189)
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>最后完成调试工作后输入 quit 命令退出调试器。至此我们已经掌握了 Delve 调试器器>的简单用法。</p><h2 id=392-调试汇编程序>3.9.2 调试汇编程序</h2><p>用 Delve 调试 Go 汇编程序的过程比调试 Go 语言程序更加简单。调试汇编程序时，我>们需要时刻关注寄存器的状态，如果涉及函数调用或局部变量或参数还需要重点关注栈寄存>器 SP 的状态。</p><p>为了编译演示，我们重新实现一个更简单的 main 函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=nf>asmSayHello</span><span class=p>()</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>asmSayHello</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>在 main 函数中调用汇编语言实现的 asmSayHello 函数输出一个字符串。</p><p>asmSayHello 函数在 main_amd64.s 文件中实现：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#include &#34;textflag.h&#34;
</span></span><span class=line><span class=cl>#include &#34;funcdata.h&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// &#34;Hello World!\n&#34;
</span></span><span class=line><span class=cl>DATA  text&lt;&gt;+0(SB)/8,$&#34;Hello Wo&#34;
</span></span><span class=line><span class=cl>DATA  text&lt;&gt;+8(SB)/8,$&#34;rld!\n&#34;
</span></span><span class=line><span class=cl>GLOBL text&lt;&gt;(SB),NOPTR,$16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// func asmSayHello()
</span></span><span class=line><span class=cl>TEXT ·asmSayHello(SB), $16-0
</span></span><span class=line><span class=cl>  NO_LOCAL_POINTERS
</span></span><span class=line><span class=cl>  MOVQ $text&lt;&gt;+0(SB), AX
</span></span><span class=line><span class=cl>  MOVQ AX, (SP)
</span></span><span class=line><span class=cl>  MOVQ $16, 8(SP)
</span></span><span class=line><span class=cl>  CALL runtime·printstring(SB)
</span></span><span class=line><span class=cl>  RET
</span></span></code></pre></td></tr></table></div></div><p>参考前面的调试流程，在执行到 main 函数断点时，可以 disassemble 反汇编命令查>看 main 函数对应的汇编代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=k>break</span> <span class=nx>main</span><span class=p>.</span><span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=nx>Breakpoint</span> <span class=mi>1</span> <span class=nx>set</span> <span class=nx>at</span> <span class=mh>0x105011f</span> <span class=k>for</span> <span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span> <span class=p>.</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=k>continue</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> <span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span> <span class=p>.</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=p>(</span><span class=nx>hits</span> <span class=nf>goroutine</span><span class=p>(</span><span class=mi>1</span><span class=p>):</span><span class=mi>1</span> <span class=nx>total</span><span class=p>:</span><span class=mi>1</span><span class=p>)</span> <span class=p>(</span><span class=nx>PC</span><span class=p>:</span> <span class=p>&gt;</span><span class=mh>0x105011f</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=mi>1</span><span class=p>:</span> <span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>=&gt;</span><span class=mi>3</span><span class=p>:</span> <span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=nf>asmSayHello</span><span class=p>()</span> <span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=mi>5</span><span class=p>:</span> <span class=kd>func</span> <span class=nf>asmSayHello</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span> <span class=nx>disassemble</span>
</span></span><span class=line><span class=cl><span class=nx>TEXT</span> <span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>(</span><span class=nx>SB</span><span class=p>)</span> <span class=o>/</span><span class=nx>path</span><span class=o>/</span><span class=nx>to</span><span class=o>/</span><span class=nx>pkg</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050110</span>  <span class=mi>65488</span><span class=nx>b0c25a0080000</span> <span class=nx>mov</span> <span class=nx>rcx</span><span class=p>,</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=nx>g</span>  <span class=p>&gt;[</span><span class=mh>0x8a0</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050119</span>  <span class=mi>483</span><span class=nx>b6110</span>           <span class=nx>cmp</span> <span class=nx>rsp</span><span class=p>,</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>r</span>  <span class=p>&gt;</span><span class=o>+</span><span class=mh>0x10</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105011d</span>  <span class=mi>761</span><span class=nx>a</span>               <span class=nx>jbe</span> <span class=mh>0x1050139</span>
</span></span><span class=line><span class=cl><span class=p>=&gt;</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105011f</span><span class=o>*</span> <span class=mi>4883</span><span class=nx>ec08</span>           <span class=nx>sub</span> <span class=nx>rsp</span><span class=p>,</span> <span class=mh>0x8</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050123</span>  <span class=mi>48892</span><span class=nx>c24</span>           <span class=nx>mov</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rsp</span><span class=p>],</span> <span class=nx>rbp</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050127</span>  <span class=mi>488</span><span class=nx>d2c24</span>           <span class=nx>lea</span> <span class=nx>rbp</span><span class=p>,</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rsp</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105012b</span>  <span class=nx>e880000000</span>         <span class=nx>call</span> <span class=err>$</span><span class=nx>main</span><span class=p>.</span><span class=nx>asmSayHello</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050130</span>  <span class=mi>488</span><span class=nx>b2c24</span>           <span class=nx>mov</span> <span class=nx>rbp</span><span class=p>,</span> <span class=nx>qword</span> <span class=nx>ptr</span> <span class=p>[</span><span class=nx>rsp</span><span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050134</span>  <span class=mi>4883</span><span class=nx>c408</span>           <span class=nx>add</span> <span class=nx>rsp</span><span class=p>,</span> <span class=mh>0x8</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050138</span>  <span class=nx>c3</span>                 <span class=nx>ret</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x1050139</span>  <span class=nx>e87288ffff</span>         <span class=nx>call</span> <span class=err>$</span><span class=nx>runtime</span><span class=p>.&gt;</span><span class=nx>morestack_noctxt</span>
</span></span><span class=line><span class=cl> <span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>3</span> <span class=mh>0x105013e</span>  <span class=nx>ebd0</span>               <span class=nx>jmp</span> <span class=err>$</span><span class=nx>main</span><span class=p>.</span><span class=nf>main</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nx>dlv</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>虽然 main 函数内部只有一行函数调用语句，但是却生成了很多汇编指令。在函数的开头>通过比较 rsp 寄存器判断栈空间是否不足，如果不足则跳转到 0x1050139 地址调用 >runtime.morestack 函数进行栈扩容，然后跳回到 main 函数开始位置重新进行栈空>间测试。而在 asmSayHello 函数调用之前，先扩展 rsp 空间用于临时存储 rbp 寄存>器的状态，在函数返回后通过栈恢复 rbp 的值并回收临时栈空间。通过对比 Go 语言代>码和对应的汇编代码，我们可以加深对 Go 汇编语言的理解。</p><p>从汇编语言角度深刻 Go 语言各种特性的工作机制对调试工作也是一个很大的帮助。如果>希望在汇编指令层面调试 Go 代码，Delve 还提供了一个 step-instruction 单步执>行汇编指令的命令。</p><p>现在我们依然用 break 命令在 asmSayHello 函数设置断点，并且输入 continue 命>令让调试器执行到断点位置停下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) break main.asmSayHello
</span></span><span class=line><span class=cl>Breakpoint 2 set at 0x10501bf for main.asmSayHello() ./main_amd64.&gt;s:10
</span></span><span class=line><span class=cl>(dlv) continue
</span></span><span class=line><span class=cl>&gt; main.asmSayHello() ./main_amd64.s:10 (hits goroutine(1):1 &gt;total:1) (PC: 0x10501bf)
</span></span><span class=line><span class=cl>    5: DATA  text&lt;&gt;+0(SB)/8,$&#34;Hello Wo&#34;
</span></span><span class=line><span class=cl>    6: DATA  text&lt;&gt;+8(SB)/8,$&#34;rld!\n&#34;
</span></span><span class=line><span class=cl>    7: GLOBL text&lt;&gt;(SB),NOPTR,$16
</span></span><span class=line><span class=cl>    8:
</span></span><span class=line><span class=cl>    9: // func asmSayHello()
</span></span><span class=line><span class=cl>=&gt;  10: TEXT ·asmSayHello(SB), $16-0
</span></span><span class=line><span class=cl>   11:         NO_LOCAL_POINTERS
</span></span><span class=line><span class=cl>   12:         MOVQ $text&lt;&gt;+0(SB), AX
</span></span><span class=line><span class=cl>   13:         MOVQ AX, (SP)
</span></span><span class=line><span class=cl>   14:         MOVQ $16, 8(SP)
</span></span><span class=line><span class=cl>   15:         CALL runtime·printstring(SB)
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>此时我们可以通过 regs 查看全部的寄存器状态：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) regs
</span></span><span class=line><span class=cl>      rax = 0x0000000001050110
</span></span><span class=line><span class=cl>      rbx = 0x0000000000000000
</span></span><span class=line><span class=cl>      rcx = 0x000000c420000300
</span></span><span class=line><span class=cl>      rdx = 0x0000000001070be0
</span></span><span class=line><span class=cl>      rdi = 0x000000c42007c020
</span></span><span class=line><span class=cl>      rsi = 0x0000000000000001
</span></span><span class=line><span class=cl>      rbp = 0x000000c420049f78
</span></span><span class=line><span class=cl>      rsp = 0x000000c420049f70
</span></span><span class=line><span class=cl>       r8 = 0x7fffffffffffffff
</span></span><span class=line><span class=cl>       r9 = 0xffffffffffffffff
</span></span><span class=line><span class=cl>      r10 = 0x0000000000000100
</span></span><span class=line><span class=cl>      r11 = 0x0000000000000286
</span></span><span class=line><span class=cl>      r12 = 0x000000c41fffff7c
</span></span><span class=line><span class=cl>      r13 = 0x0000000000000000
</span></span><span class=line><span class=cl>      r14 = 0x0000000000000178
</span></span><span class=line><span class=cl>      r15 = 0x0000000000000004
</span></span><span class=line><span class=cl>      rip = 0x00000000010501bf
</span></span><span class=line><span class=cl>   rflags = 0x0000000000000206
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>因为 AMD64 的各种寄存器非常多，项目的信息中刻意省略了非通用的寄存器。如果再单步>执行到 13 行时，可以发现 AX 寄存器值的变化。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) regs
</span></span><span class=line><span class=cl>      rax = 0x00000000010a4060
</span></span><span class=line><span class=cl>      rbx = 0x0000000000000000
</span></span><span class=line><span class=cl>      rcx = 0x000000c420000300
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>因此我们可以推断汇编程序内部定义的 <code>text&lt;></code> 数据的地址为 >0x00000000010a4060。我们可以用过 print 命令来查看该内存内的数据：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(dlv) print *(*[5]byte)(uintptr(0x00000000010a4060))
</span></span><span class=line><span class=cl>[5]uint8 [72,101,108,108,111]
</span></span><span class=line><span class=cl>(dlv)
</span></span></code></pre></td></tr></table></div></div><p>我们可以发现输出的 <code>[5]uint8 [72,101,108,108,111]</code> 刚好是对应 “Hello” 字>符串。通过类似的方法，我们可以通过查看 SP 对应的栈指针位置，然后查看栈中局部变>量的值。</p><p>至此我们就掌握了 Go 汇编程序的简单调试技术。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback></code></pre></td></tr></table></div></div></blockquote></li></ul><h2 id=ebpf与dlv>EBPF与DLV</h2><p>最近在学习epbf时发现Delve支持ebpf参数.</p><p>在<code>Ubuntu 20.04.5 LTS</code>系统下,使用root权限</p><p>命令如下:</p><p><code>/home/lsk/go/bin/dlv trace foo --ebpf</code></p><p>如果不加<code>ebpf</code>参数则默认使用ptrace参数,关于trace的具体使用方法见:https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_trace.md</p></section><footer class=article-footer><section class=article-tags><a href=/tags/go/>go</a>
<a href=/tags/dlv/>dlv</a>
<a href=/tags/debug/>debug</a>
<a href=/tags/ebpf/>ebpf</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/githubaction/><div class=article-details><h2 class=article-title>Github使用Action自动编译发布go项目</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=60ke/blogs issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 LookForAdmin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>