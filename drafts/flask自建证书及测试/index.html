<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="ç”Ÿæˆå¯†é’¥ã€è¯ä¹¦ ç¬¬ä¸€æ­¥,ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å‡†å¤‡å…¬é’¥ã€ç§é’¥
ç”ŸæˆæœåŠ¡å™¨ç«¯ç§é’¥ openssl genrsa -out server.key 1024
ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥ openssl rsa -in server.key -pubout -out server.pem
ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥ openssl genrsa -out client.key 1024
ç”Ÿæˆå®¢æˆ·ç«¯å…¬é’¥ openssl rsa -in client.key -pubout -out client.pem ç¬¬äºŒæ­¥,ç”Ÿæˆ CA è¯ä¹¦
ç”Ÿæˆ CA ç§é’¥ openssl genrsa -out ca.key 1024
X.509 Certificate Signing Request (CSR) Management. openssl req -new -key ca.key -out ca.csr
X.509 Certificate Data Management. openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt åœ¨æ‰§è¡Œç¬¬äºŒæ­¥æ—¶ä¼šå‡ºç°ï¼š
âœ keys openssl req -new -key ca."><title>flaskè‡ªå»ºè¯ä¹¦åŠæµ‹è¯•</title><link rel=canonical href=https://60ke.github.io/drafts/flask%E8%87%AA%E5%BB%BA%E8%AF%81%E4%B9%A6%E5%8F%8A%E6%B5%8B%E8%AF%95/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="flaskè‡ªå»ºè¯ä¹¦åŠæµ‹è¯•"><meta property="og:description" content="ç”Ÿæˆå¯†é’¥ã€è¯ä¹¦ ç¬¬ä¸€æ­¥,ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å‡†å¤‡å…¬é’¥ã€ç§é’¥
ç”ŸæˆæœåŠ¡å™¨ç«¯ç§é’¥ openssl genrsa -out server.key 1024
ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥ openssl rsa -in server.key -pubout -out server.pem
ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥ openssl genrsa -out client.key 1024
ç”Ÿæˆå®¢æˆ·ç«¯å…¬é’¥ openssl rsa -in client.key -pubout -out client.pem ç¬¬äºŒæ­¥,ç”Ÿæˆ CA è¯ä¹¦
ç”Ÿæˆ CA ç§é’¥ openssl genrsa -out ca.key 1024
X.509 Certificate Signing Request (CSR) Management. openssl req -new -key ca.key -out ca.csr
X.509 Certificate Data Management. openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt åœ¨æ‰§è¡Œç¬¬äºŒæ­¥æ—¶ä¼šå‡ºç°ï¼š
âœ keys openssl req -new -key ca."><meta property="og:url" content="https://60ke.github.io/drafts/flask%E8%87%AA%E5%BB%BA%E8%AF%81%E4%B9%A6%E5%8F%8A%E6%B5%8B%E8%AF%95/"><meta property="og:site_name" content="LookForAdmin"><meta property="og:type" content="article"><meta property="article:section" content="Drafts"><meta property="article:tag" content="others"><meta property="article:published_time" content="2019-12-19T12:08:35+00:00"><meta property="article:modified_time" content="2019-12-19T12:08:35+00:00"><meta name=twitter:title content="flaskè‡ªå»ºè¯ä¹¦åŠæµ‹è¯•"><meta name=twitter:description content="ç”Ÿæˆå¯†é’¥ã€è¯ä¹¦ ç¬¬ä¸€æ­¥,ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å‡†å¤‡å…¬é’¥ã€ç§é’¥
ç”ŸæˆæœåŠ¡å™¨ç«¯ç§é’¥ openssl genrsa -out server.key 1024
ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥ openssl rsa -in server.key -pubout -out server.pem
ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥ openssl genrsa -out client.key 1024
ç”Ÿæˆå®¢æˆ·ç«¯å…¬é’¥ openssl rsa -in client.key -pubout -out client.pem ç¬¬äºŒæ­¥,ç”Ÿæˆ CA è¯ä¹¦
ç”Ÿæˆ CA ç§é’¥ openssl genrsa -out ca.key 1024
X.509 Certificate Signing Request (CSR) Management. openssl req -new -key ca.key -out ca.csr
X.509 Certificate Data Management. openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt åœ¨æ‰§è¡Œç¬¬äºŒæ­¥æ—¶ä¼šå‡ºç°ï¼š
âœ keys openssl req -new -key ca."><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/Avatar.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LookForAdmin</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=social-menu><li><a href=https://github.com/60ke target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/posts target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/drafts><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>è‰ç¨¿ç®±</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>about</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#if-you-enter--the-field-will-be-left-blank>âœ keys openssl req -new -key ca.key -out ca.csr
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &lsquo;.&rsquo;, the field will be left blank.</a></li></ol><ol><li><a href=#ä½¿ç”¨caç­¾åè¿‡çš„è¯ä¹¦å’Œç§é’¥å¯¼å‡ºp12æ ¼å¼ä¸ªäººè¯ä¹¦>ä½¿ç”¨CAç­¾åè¿‡çš„è¯ä¹¦å’Œç§é’¥å¯¼å‡ºP12æ ¼å¼ä¸ªäººè¯ä¹¦</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/drafts/flask%E8%87%AA%E5%BB%BA%E8%AF%81%E4%B9%A6%E5%8F%8A%E6%B5%8B%E8%AF%95/>flaskè‡ªå»ºè¯ä¹¦åŠæµ‹è¯•</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Dec 19, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 4 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>ç”Ÿæˆå¯†é’¥ã€è¯ä¹¦
ç¬¬ä¸€æ­¥,ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å‡†å¤‡å…¬é’¥ã€ç§é’¥</p><h1 id=ç”ŸæˆæœåŠ¡å™¨ç«¯ç§é’¥>ç”ŸæˆæœåŠ¡å™¨ç«¯ç§é’¥</h1><p>openssl genrsa -out server.key 1024</p><h1 id=ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥>ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥</h1><p>openssl rsa -in server.key -pubout -out server.pem</p><h1 id=ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥>ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥</h1><p>openssl genrsa -out client.key 1024</p><h1 id=ç”Ÿæˆå®¢æˆ·ç«¯å…¬é’¥>ç”Ÿæˆå®¢æˆ·ç«¯å…¬é’¥</h1><p>openssl rsa -in client.key -pubout -out client.pem
ç¬¬äºŒæ­¥,ç”Ÿæˆ CA è¯ä¹¦</p><h1 id=ç”Ÿæˆ-ca-ç§é’¥>ç”Ÿæˆ CA ç§é’¥</h1><p>openssl genrsa -out ca.key 1024</p><h1 id=x509-certificate-signing-request-csr-management>X.509 Certificate Signing Request (CSR) Management.</h1><p>openssl req -new -key ca.key -out ca.csr</p><h1 id=x509-certificate-data-management>X.509 Certificate Data Management.</h1><p>openssl x509 -req -in ca.csr -signkey ca.key -out ca.crt
åœ¨æ‰§è¡Œç¬¬äºŒæ­¥æ—¶ä¼šå‡ºç°ï¼š</p><h2 id=if-you-enter--the-field-will-be-left-blank>âœ keys openssl req -new -key ca.key -out ca.csr
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &lsquo;.&rsquo;, the field will be left blank.</h2><p>Country Name (2 letter code) [AU]:CN
State or Province Name (full name) [Some-State]:Zhejiang
Locality Name (eg, city) []:Hangzhou
Organization Name (eg, company) [Internet Widgits Pty Ltd]:My CA
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:localhost
Email Address []:
æ³¨æ„,è¿™é‡Œçš„ Organization Name (eg, company) [Internet Widgits Pty Ltd]: åé¢ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯è¯ä¹¦çš„æ—¶å€™ä¹Ÿéœ€è¦å¡«å†™,ä¸è¦å†™æˆä¸€æ ·çš„ï¼ï¼ï¼å¯ä»¥éšæ„å†™å¦‚ï¼šMy CA, My Server, My Clientã€‚</p><p>ç„¶å Common Name (e.g. server FQDN or YOUR name) []: è¿™ä¸€é¡¹,æ˜¯æœ€åå¯ä»¥è®¿é—®çš„åŸŸå,æˆ‘è¿™é‡Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•,å†™æˆ localhost,å¦‚æœæ˜¯ä¸ºäº†ç»™æˆ‘çš„ç½‘ç«™ç”Ÿæˆè¯ä¹¦,éœ€è¦å†™æˆ barretlee.comã€‚</p><p>ç¬¬ä¸‰æ­¥,ç”ŸæˆæœåŠ¡å™¨ç«¯è¯ä¹¦å’Œå®¢æˆ·ç«¯è¯ä¹¦</p><h1 id=æœåŠ¡å™¨ç«¯éœ€è¦å‘-ca-æœºæ„ç”³è¯·ç­¾åè¯ä¹¦åœ¨ç”³è¯·ç­¾åè¯ä¹¦ä¹‹å‰ä¾ç„¶æ˜¯åˆ›å»ºè‡ªå·±çš„-csr-æ–‡ä»¶>æœåŠ¡å™¨ç«¯éœ€è¦å‘ CA æœºæ„ç”³è¯·ç­¾åè¯ä¹¦,åœ¨ç”³è¯·ç­¾åè¯ä¹¦ä¹‹å‰ä¾ç„¶æ˜¯åˆ›å»ºè‡ªå·±çš„ CSR æ–‡ä»¶</h1><p>openssl req -new -key server.key -out server.csr</p><h1 id=å‘è‡ªå·±çš„-ca-æœºæ„ç”³è¯·è¯ä¹¦ç­¾åè¿‡ç¨‹éœ€è¦-ca-çš„è¯ä¹¦å’Œç§é’¥å‚ä¸æœ€ç»ˆé¢å‘ä¸€ä¸ªå¸¦æœ‰-ca-ç­¾åçš„è¯ä¹¦>å‘è‡ªå·±çš„ CA æœºæ„ç”³è¯·è¯ä¹¦,ç­¾åè¿‡ç¨‹éœ€è¦ CA çš„è¯ä¹¦å’Œç§é’¥å‚ä¸,æœ€ç»ˆé¢å‘ä¸€ä¸ªå¸¦æœ‰ CA ç­¾åçš„è¯ä¹¦</h1><p>openssl x509 -req -CA ca.crt -CAkey ca.key -CAcreateserial -in server.csr -out server.crt</p><h1 id=client-ç«¯>client ç«¯</h1><p>openssl req -new -key client.key -out client.csr</p><h1 id=client-ç«¯åˆ°-ca-ç­¾å>client ç«¯åˆ° CA ç­¾å</h1><p>openssl x509 -req -CA ca.crt -CAkey ca.key -CAcreateserial -in client.csr -out client.crt
æ­¤æ—¶,æˆ‘ä»¬çš„ keys æ–‡ä»¶å¤¹ä¸‹å·²ç»æœ‰å¦‚ä¸‹å†…å®¹äº†ï¼š</p><p>.
â”œâ”€â”€ https-client.js
â”œâ”€â”€ https-server.js
â””â”€â”€ keys
â”œâ”€â”€ ca.crt
â”œâ”€â”€ ca.csr
â”œâ”€â”€ ca.key
â”œâ”€â”€ ca.pem
â”œâ”€â”€ ca.srl
â”œâ”€â”€ client.crt
â”œâ”€â”€ client.csr
â”œâ”€â”€ client.key
â”œâ”€â”€ client.pem
â”œâ”€â”€ server.crt
â”œâ”€â”€ server.csr
â”œâ”€â”€ server.key
â””â”€â”€ server.pem
çœ‹åˆ°ä¸Šé¢ä¸¤ä¸ª js æ–‡ä»¶äº†ä¹ˆ,æˆ‘ä»¬æ¥è·‘å‡ ä¸ªdemoã€‚</p><p>HTTPSæœ¬åœ°æµ‹è¯•
æœåŠ¡å™¨ä»£ç ï¼š</p><p>// file http-server.js
var https = require(&lsquo;https&rsquo;);
var fs = require(&lsquo;fs&rsquo;);</p><p>var options = {
key: fs.readFileSync(&rsquo;./keys/server.key&rsquo;),
cert: fs.readFileSync(&rsquo;./keys/server.crt&rsquo;)
};</p><p>https.createServer(options, function(req, res) {
res.writeHead(200);
res.end(&lsquo;hello world&rsquo;);
}).listen(8000);
çŸ­çŸ­å‡ è¡Œä»£ç å°±æ„å»ºäº†ä¸€ä¸ªç®€å•çš„ https æœåŠ¡å™¨,options å°†ç§é’¥å’Œè¯ä¹¦å¸¦ä¸Šã€‚ç„¶ååˆ©ç”¨ curl æµ‹è¯•ï¼š</p><p>âœ https curl //localhost:8000
curl: (60) SSL certificate problem: Invalid certificate chain
More details here: <a class=link href=http://curl.haxx.se/docs/sslcerts.html target=_blank rel=noopener>http://curl.haxx.se/docs/sslcerts.html</a></p><p>curl performs SSL certificate verification by default, using a &ldquo;bundle&rdquo;
of Certificate Authority (CA) public keys (CA certs). If the default
bundle file isn&rsquo;t adequate, you can specify an alternate file
using the &ndash;cacert option.
If this HTTPS server uses a certificate signed by a CA represented in
the bundle, the certificate verification probably failed due to a
problem with the certificate (it might be expired, or the name might
not match the domain name in the URL).
If you&rsquo;d like to turn off curl&rsquo;s verification of the certificate, use
the -k (or &ndash;insecure) option.
å½“æˆ‘ä»¬ç›´æ¥è®¿é—®æ—¶,curl //localhost:8000 ä¸€å †æç¤º,åŸå› æ˜¯æ²¡æœ‰ç»è¿‡ CA è®¤è¯,æ·»åŠ  -k å‚æ•°èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p><p>âœ https curl -k //localhost:8000
hello world%
è¿™æ ·çš„æ–¹å¼æ˜¯ä¸å®‰å…¨çš„,å­˜åœ¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ä¸­é—´äººæ”»å‡»é—®é¢˜ã€‚å¯ä»¥æä¸€ä¸ªå®¢æˆ·ç«¯å¸¦ä¸Š CA è¯ä¹¦è¯•è¯•ï¼š</p><p>// file http-client.js
var https = require(&lsquo;https&rsquo;);
var fs = require(&lsquo;fs&rsquo;);</p><p>var options = {
hostname: &ldquo;localhost&rdquo;,
port: 8000,
path: &lsquo;/&rsquo;,
methed: &lsquo;GET&rsquo;,
key: fs.readFileSync(&rsquo;./keys/client.key&rsquo;),
cert: fs.readFileSync(&rsquo;./keys/client.crt&rsquo;),
ca: [fs.readFileSync(&rsquo;./keys/ca.crt&rsquo;)]
};</p><p>options.agent = new https.Agent(options);</p><p>var req = https.request(options, function(res) {
res.setEncoding(&lsquo;utf-8&rsquo;);
res.on(&lsquo;data&rsquo;, function(d) {
console.log(d);
});
});
req.end();</p><p>req.on(&rsquo;error&rsquo;, function(e) {
console.log(e);
});
å…ˆæ‰“å¼€æœåŠ¡å™¨ node http-server.js,ç„¶åæ‰§è¡Œ</p><p>âœ https node https-client.js
hello world
å¦‚æœä½ çš„ä»£ç æ²¡æœ‰è¾“å‡º hello world,è¯´æ˜è¯ä¹¦ç”Ÿæˆçš„æ—¶å€™å­˜åœ¨é—®é¢˜ã€‚ä¹Ÿå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®ï¼š</p><p>httpsè¯ä¹¦é—®é¢˜</p><p>æç¤ºé”™è¯¯ï¼š</p><p>æ­¤æœåŠ¡å™¨æ— æ³•è¯æ˜å®ƒæ˜¯localhostï¼›æ‚¨è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿä¸ä¿¡ä»»å…¶å®‰å…¨è¯ä¹¦ã€‚å‡ºç°æ­¤é—®é¢˜çš„åŸå› å¯èƒ½æ˜¯é…ç½®æœ‰è¯¯æˆ–æ‚¨çš„è¿æ¥è¢«æ‹¦æˆªäº†ã€‚</p><p>åŸå› æ˜¯æµè§ˆå™¨æ²¡æœ‰ CA è¯ä¹¦,åªæœ‰ CA è¯ä¹¦,æœåŠ¡å™¨æ‰èƒ½å¤Ÿç¡®å®š,è¿™ä¸ªç”¨æˆ·å°±æ˜¯çœŸå®çš„æ¥è‡ª localhost çš„è®¿é—®è¯·æ±‚ï¼ˆæ¯”å¦‚ä¸æ˜¯ä»£ç†è¿‡æ¥çš„ï¼‰ã€‚</p><p>ä½ å¯ä»¥ç‚¹å‡» ç»§ç»­å‰å¾€localhostï¼ˆä¸å®‰å…¨ï¼‰ è¿™ä¸ªé“¾æ¥,ç›¸å½“äºæ‰§è¡Œ curl -k //localhost:8000ã€‚å¦‚æœæˆ‘ä»¬çš„è¯ä¹¦ä¸æ˜¯è‡ªå·±é¢å‘,è€Œæ˜¯å»é è°±çš„æœºæ„å»ç”³è¯·çš„,é‚£å°±ä¸ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜,å› ä¸ºé è°±æœºæ„çš„è¯ä¹¦ä¼šæ”¾åˆ°æµè§ˆå™¨ä¸­,æµè§ˆå™¨ä¼šå¸®æˆ‘ä»¬åšå¾ˆå¤šäº‹æƒ…ã€‚åˆæ¬¡å°è¯•çš„åŒå­¦å¯ä»¥å» startssl.com ç”³è¯·ä¸€ä¸ªå…è´¹çš„è¯ä¹¦ã€‚</p><p>Nginx éƒ¨ç½²
ssh åˆ°ä½ çš„æœåŠ¡å™¨,å¯¹ Nginx åšå¦‚ä¸‹é…ç½®ï¼š</p><p>server_names barretlee.com *.barretlee.com
ssl on;
ssl_certificate /etc/nginx/ssl/barretlee.com.crt;
ssl_certificate_key /etc/nginx/ssl/barretlee.com.key;
ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
ssl_ciphers &ldquo;EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4EECDH EDH+aRSA RC4 !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !MEDIUM&rdquo;;</p><h1 id=add-perfect-forward-secrecy>Add perfect forward secrecy</h1><p>ssl_prefer_server_ciphers on;
add_header Strict-Transport-Security &ldquo;max-age=31536000; includeSubdomains&rdquo;;
ä¼šå‘ç°,ç½‘é¡µ URL åœ°å€æ¡†å·¦è¾¹å·²ç»å¤šå‡ºäº†ä¸€ä¸ªå°ç»¿é”ã€‚å½“ç„¶,éƒ¨ç½²å¥½äº†ä¹‹åå¯ä»¥å»è¿™ä¸ªç½‘ç«™çœ‹çœ‹æµ‹è¯„åˆ†æ•°,å¦‚æœåˆ†æ•°æ˜¯ A+,è¯´æ˜ä½ çš„ HTTPS çš„å„é¡¹é…ç½®éƒ½è¿˜ä¸é”™,é€Ÿåº¦ä¹Ÿå¾ˆå¿«ã€‚</p><h2 id=ä½¿ç”¨caç­¾åè¿‡çš„è¯ä¹¦å’Œç§é’¥å¯¼å‡ºp12æ ¼å¼ä¸ªäººè¯ä¹¦>ä½¿ç”¨CAç­¾åè¿‡çš„è¯ä¹¦å’Œç§é’¥å¯¼å‡ºP12æ ¼å¼ä¸ªäººè¯ä¹¦</h2><p><code>openssl pkcs12 -export -inkey clientkey.pem -in client.crt -out client.p12</code></p><h1 id=å¯åŠ¨flask>å¯åŠ¨flask</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span><span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>,</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;hello world&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#app.run(host=&#39;0.0.0.0&#39;,ssl_context=&#39;adhoc&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>ssl_context</span><span class=o>=</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;server.crt&#34;</span><span class=p>,</span> <span class=s2>&#34;server.key&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=requestsæµ‹è¯•>requestsæµ‹è¯•</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=n>rep</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://127.0.0.1:5000/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                   <span class=n>cert</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;/Users/k/Desktop/scp/flask/client/client-cert.pem&#39;</span><span class=p>,</span> <span class=s1>&#39;/Users/k/Desktop/scp/flask/client/client-key.pem&#39;</span><span class=p>),</span> <span class=n>verify</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>rep</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># rep = requests.get(&#39;https://127.0.0.1:5000/&#39;,verify=False)</span>
</span></span><span class=line><span class=cl><span class=c1># print(rep.text)</span>
</span></span></code></pre></td></tr></table></div></div><p>æºè‡ªï¼š
<a class=link href=https://www.cnblogs.com/liyulong1982/p/6106129.html target=_blank rel=noopener>https://www.cnblogs.com/liyulong1982/p/6106129.html</a>
<a class=link href=https://blog.csdn.net/yannanxiu/article/details/70670225 target=_blank rel=noopener>https://blog.csdn.net/yannanxiu/article/details/70670225</a>
<a class=link href=https://www.jianshu.com/p/5ea147e03255 target=_blank rel=noopener>https://www.jianshu.com/p/5ea147e03255</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/others/>others</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><script src=https://utteranc.es/client.js repo=60ke/blogs issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 LookForAdmin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>