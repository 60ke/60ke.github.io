<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="PHP常用类库
"><title>PHP常用类库</title><link rel=canonical href=https://60ke.github.io/drafts/php%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="PHP常用类库"><meta property="og:description" content="PHP常用类库
"><meta property="og:url" content="https://60ke.github.io/drafts/php%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93/"><meta property="og:site_name" content="LookForAdmin"><meta property="og:type" content="article"><meta property="article:section" content="Drafts"><meta property="article:published_time" content="2016-03-06T05:50:00+00:00"><meta property="article:modified_time" content="2016-03-06T05:50:00+00:00"><meta name=twitter:title content="PHP常用类库"><meta name=twitter:description content="PHP常用类库
"><link rel="shortcut icon" href=/img/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/Avatar.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>LookForAdmin</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></div></header><ol class=social-menu><li><a href=https://github.com/60ke target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/posts target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/drafts><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>草稿箱</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>about</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/php/>php</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/drafts/php%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93/>PHP常用类库</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 06, 2016</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 6 分钟</time></div></footer></div></header><section class=article-content><p>PHP常用类库</p><p>数组类</p><p>class libArray
{
/**
* 多维数组合并
* @return array
*/
public static function merge ()
{
$args = func_get_args();
$array = [];
foreach ( $args as $arg ) {
if ( is_array($arg) ) {
foreach ( $arg as $k => $v ) {
if ( is_array($v) ) {
$array[$k] = isset($array[$k]) ? $array[$k] : [];
$array[$k] = self::merge($array[$k], $v);
} else {
$array[$k] = $v;
}
}
}
}
return $array;
}</p><pre><code>/**
 * 多维to一维
 * [1=&gt;['a'=&gt;'v1']] to ['1|a'=&gt;'v1']
 * @param array $array
 * @param string $delimiter
 * @param string $key
 * @return array
 */
public static function mTo1 (array $array, $delimiter = '|', $key = '')
{
    $data = [];
    if ( !is_array($array) ) {
        return $data;
    }
    foreach ( $array as $k =&gt; $v ) {
        $keyNew = trim($key.$delimiter.$k, $delimiter);
        if ( is_array($v) ) {
            $data = array_merge($data, self::mTo1($v, $delimiter, $keyNew));
        } else {
            $data[$keyNew] = $v;
        }
    }
    return $data;
}

/**
 * 数组排序
 * @param array $array
 * @param $column
 * @param bool $reverse
 * @return bool
 */
public static function sort (array &amp;$array, $column, $reverse = FALSE)
{
    $arrColumn = [];
    foreach ( $array as $key =&gt; $val ) {
        $arrColumn[$key] = $val[$column];
    }
    return array_multisort($arrColumn, $reverse ? SORT_DESC : SORT_ASC, $array);
}

/**
 * 添加索引
 * @param array $array
 * @param $key
 * @return array
 */
public static function index (array $array, $key)
{
    $ret = [];
    foreach ( $array as $val ) {
        $ret[$val[$key]] = $val;
    }
    return $ret;
}

/**
 * 添加前后缀
 * @param $array
 * @param null $pre
 * @param null $suf
 * @return array
 */
public static function addFix (array $array, $pre = NULL, $suf = NULL)
{
    $ret = [];
    foreach ( $array as $key =&gt; $val ) {
        $ret[$key] = $pre.$val.$suf;
    }
    return $ret;
}
</code></pre><p>}
数据检查类</p><p>class libCheck
{
/**
* 是否为IP（IPv4）
* @param $ip
* @return bool
*/
public static function isIP ($ip)
{
$isIP = filter_var($ip, FILTER_VALIDATE_IP) ? TRUE : FALSE;
return $isIP;
}</p><pre><code>/**
 * 是否为邮箱地址
 * @param $mail
 * @return bool
 */
public static function isMail ($mail)
{
    $isMail = filter_var($mail, FILTER_VALIDATE_EMAIL) ? TRUE : FALSE;
    return $isMail;
}

/**
 * 是否为URL
 * @param $url
 * @return bool
 */
public static function isURL ($url)
{
    $isMail = filter_var($url, FILTER_VALIDATE_URL) ? TRUE : FALSE;
    return $isMail;
}

/**
 * 是否为正整数
 * @param $num
 * @return bool
 */
public static function isPosiInt ($num)
{
    $isPosiInt = is_int($num) &amp;&amp; $num &gt; 0;
    return $isPosiInt;
}

/**
 * 是否在范围内
 * @param $num
 * @param int $min
 * @param null $max
 * @return bool
 */
public static function isBetween ($num, $min = 0, $max = NULL)
{
    $isBetween = $num &gt;= $min;
    if ( $max ) {
        $isBetween = $isBetween &amp;&amp; $num &lt;= $max;
    }
    return $isBetween;
}

/**
 * 是否为有效长度
 * @param $str
 * @param int $min
 * @param null $max
 * @return bool
 */
public static function isValidLen ($str, $min = 1, $max = NULL)
{
    $length = mb_strlen($str);
    $isValidLen = self::isBetween($length, $min, $max);
    return $isValidLen;
}
</code></pre><p>}
文件类</p><p>class libFile
{
/**
* 获取目录下所有文件
* @param $path
* @return array
*/
public static function getFiles ($path)
{
$path = self::formatePath($path);
if (!is_dir($path)) {
return [];
}
$dh = opendir($path);
$files = [];
while ( ($filename = readdir($dh)) !== FALSE ) {
if ( $filename != &lsquo;.&rsquo; && $filename != &lsquo;..&rsquo; ) {
$files[] = implode(&rsquo;/&rsquo;, [$path, $filename]);
}
}
closedir($dh);
return $files;
}</p><pre><code>/**
 * 按模式取目录下文件
 * @param $path
 * @param $pattern
 * @return array
 */
public static function getFilesByPattern ($path, $pattern)
{
    $path = self::formatePath($path);
    $filePattern = sprintf('%s/%s', $path, $pattern);
    return glob($filePattern);
}

/**
 * 递归删除文件夹
 * @param $dir
 * @return bool
 */
public static function rmDir($dir)
{
    $dir = self::formatePath($dir);
    $dh = opendir($dir);
    while ($filename = readdir($dh)) {
        if ($filename != '.' &amp;&amp; $filename != '..') {
            $path = sprintf('%s/%s', $dir, $filename);
            is_dir($path) ? self::rmDir($path) : unlink($path);
        }
    }
    closedir($dh);
    return rmdir($dir);
}

/**
 * 获取最后修改时间
 * @param $path
 * @return int
 */
public static function getModifiedTime ($path)
{
    return filemtime($path);
}

/**
 * 格式化路径
 * @param $path
 * @return string
 */
public static function formatePath ($path)
{
    return rtrim($path, '/');
}
</code></pre><p>}
HTTP类</p><p>class libHttp
{
/**
* GET方法
* @param $url
* @param array $options
* @return bool|mixed
*/
public static function get ($url, $options = [])
{
return self::send($url, NULL, NULL, $options);
}</p><pre><code>/**
 * POST方法
 * @param $url
 * @param array $params
 * @param array $options
 * @return bool|mixed
 */
public static function post ($url, $params = [], $options = [])
{
    return self::send($url, 'POST', $params, $options);
}

/**
 * @param $url
 * @param string $method
 * @param array $params
 * @param array $options
 * @return mixed|string
 */
public static function send ($url, $method = 'GET', $params = [], $options = [])
{
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
    if ($method == 'POST') {
        $options[CURLOPT_POST] = TRUE;
        $options[CURLOPT_POSTFIELDS] = $params;
    }
    curl_setopt_array($ch, $options);
    $result = curl_exec($ch);
    return curl_errno($ch) ? curl_error($ch) : $result;
}
</code></pre><p>}
字符串类</p><p>class libString
{
/**
* 随机字符串
* @param int $length
* @param bool $num
* @param bool $lower
* @param bool $upper
* @return string
*/
public static function rand ($length=5, $num=TRUE, $lower=TRUE, $upper=TRUE)
{
$str = &lsquo;&rsquo;;
$num && $str .= &lsquo;0123456789&rsquo;;
$lower && $str .= &lsquo;abcdefghijklmnopqrstuvwxyz&rsquo;;
$upper && $str .= &lsquo;ABCDEFGHIJKLMNOPQRSTUVWXYZ&rsquo;;
$rand = substr(str_shuffle($str), -$length);
return $rand;
}</p><pre><code>/**
 * 字符串截取（单次）
 * @param $ld
 * @param $rd
 * @param $str
 * @return string
 */
public static function sub ($ld, $rd, $str)
{
    $start = strpos($str, $ld) + strlen($ld);
    $end = strpos($str, $rd, $start);
    $data = substr($str, $start, $end - $start);
    return $data;
}

/**
 * 字符串截取（批量）
 * @param $ld
 * @param $rd
 * @param $str
 * @return array
 */
public static function subs ($ld, $rd, $str)
{
    $data = [];
    $lLen = strlen($ld);
    $rLen = strlen($rd);
    $offset = 0;
    while ( ($start = strpos($str, $ld, $offset)) !== FALSE ) {
        $start += $lLen;
        $end = strpos($str, $rd, $start);
        $data[] = substr($str, $start, $end - $start);
        $offset = $end + $rLen;
    }
    return $data;
}

/**
 * 生成唯一ID
 * @return string
 */
public static function uniqid ()
{
    return md5(uniqid(rand(), true));
}
</code></pre><p>}
其它工具类</p><p>class libTool
{
/**
* ip->int
* @param $ip
* @return string
*/
public static function ip2long ($ip)
{
$long = sprintf(&rsquo;%u&rsquo;, ip2long($ip));
return $long;
}</p><pre><code>/**
 * 系统负载
 * @return mixed
 */
public static function loadAvg ()
{
    $load = sys_getloadavg()[0];
    return $load;
}

/**
 * 写日志文件
 * @param $file
 * @param $msg
 * @param bool $newLine
 */
public static function log ($file, $msg, $newLine = TRUE)
{
    $newLine &amp;&amp; $msg .= &quot;\n&quot;;
    file_put_contents($file, $msg, FILE_APPEND);
}

/**
 * 内存使用峰值(M)
 * @return float
 */
public static function memoryUsage ()
{
    $memory = memory_get_peak_usage(TRUE) / pow(1024, 2);
    $memory = round($memory, 2);
    return $memery;
}

/**
 * 浏览器变量输出
 * @param $var
 * @param bool|FALSE $return
 * @param bool|TRUE $strict
 * @return bool|mixed|string
 */
public static function dump ($var, $return = FALSE, $strict = TRUE)
{
    if (!$strict) {
        if (ini_get('html_errors')) {
            $output = print_r($var, TRUE);
            $output = sprintf('&lt;pre&gt;%s&lt;/pre&gt;', htmlspecialchars($output, ENT_QUOTES));
        } else {
            $output = print_r($var, TRUE);
        }
    } else {
        ob_start();
        var_dump($var);
        $output = ob_get_clean();
        if (!extension_loaded('xdebug')) {
            $output = preg_replace('/\]\=\&gt;\n(\s+)/m', '] =&gt; ', $output);
            $output = sprintf('&lt;pre&gt;%s&lt;/pre&gt;', htmlspecialchars($output, ENT_QUOTES));
        }
    }

    if ($return) {
        return $output;
    } else {
        echo $output;
        return TRUE;
    }
}
</code></pre><p>}</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/drafts/%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1%E7%BD%91%E7%AB%99%E5%BC%80%E5%8F%91-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/><div class=article-details><h2 class=article-title>电子商务网站开发-1-需求分析</h2></div></a></article><article><a href=/drafts/laravel%E5%AD%A6%E4%B9%A0-1/><div class=article-details><h2 class=article-title>laravel学习-1</h2></div></a></article><article><a href=/drafts/php%E9%9D%A2%E8%AF%95%E9%A2%98-1/><div class=article-details><h2 class=article-title>php面试题-1</h2></div></a></article><article><a href=/drafts/%E5%BE%AE%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86/><div class=article-details><h2 class=article-title>微信二维码技术原理</h2></div></a></article><article><a href=/drafts/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E5%BC%80%E5%8F%91-1/><div class=article-details><h2 class=article-title>微信公众号开发-1</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=60ke/blogs issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 LookForAdmin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>